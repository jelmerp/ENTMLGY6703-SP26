[
  {
    "objectID": "pages/data.html#introduction",
    "href": "pages/data.html#introduction",
    "title": "Working with genome and HTS data",
    "section": "1 Introduction",
    "text": "1 Introduction\n\n1.1 Goals for this part of the lab\nIn this second part of the lab, you will learn how to:\n\nLook at files in the Unix shell\nFind a reference genome and the associated files\nExplore and understand reference genome files\nExplore and understand HTS files\nPerform quality-control on HTS reads with a command-line tool, FastQC\n\n\n\n1.2 The dataset\nAs discussed in the lecture, you‚Äôll work with RNA-Seq data from Garrig√≥s et al. (2025) in today‚Äôs and next week‚Äôs labs:\n\n\n\n\n\nThis paper used RNA-Seq data to study gene expression in Culex pipiens mosquitos infected with malaria-causing Plasmodium protozoans. Next week, you will learn about RNA-Seq methodology and experimental design, and we‚Äôll discuss the paper‚Äôs experimental design in more detail. Here, we‚Äôll explore the paper‚Äôs HTS data files."
  },
  {
    "objectID": "pages/data.html#the-files-youll-work-with",
    "href": "pages/data.html#the-files-youll-work-with",
    "title": "Working with genome and HTS data",
    "section": "2 The files you‚Äôll work with",
    "text": "2 The files you‚Äôll work with\nThe main data files in a reference-based HTS project1 are sequence reads (usually produced for the focal project) and reference genome files (usually already available).\nFor this project ‚Äìour re-analysis of the Garrig√≥s et al. (2025) data‚Äì I have downloaded those files for you and placed them in /fs/scratch/PAS2880/ENT6703/data on OSC. You‚Äôve seen some of these files in the first part of this lab, but we didn‚Äôt pay much attention to what they represent.\nFirst, we‚Äôll actually move one level up to the ENT6703 dir:\ncd /fs/scratch/PAS2880/ENT6703\nLet‚Äôs get an overview of the full set of files using the tree command (with the option -C to show colors):\n# Unlike ls, tree will show the full directory structure\ntree -C data\n# (The colors you should see in the terminal aren't shown here)\ndata\n‚îú‚îÄ‚îÄ fastq\n‚îÇ   ‚îú‚îÄ‚îÄ ERR10802863_R1.fastq.gz\n‚îÇ   ‚îú‚îÄ‚îÄ ERR10802863_R2.fastq.gz\n‚îÇ   ‚îú‚îÄ‚îÄ ERR10802864_R1.fastq.gz\n‚îÇ   ‚îú‚îÄ‚îÄ ERR10802864_R2.fastq.gz\n‚îÇ   ‚îú‚îÄ‚îÄ ERR10802865_R1.fastq.gz\n‚îÇ   ‚îú‚îÄ‚îÄ ERR10802865_R2.fastq.gz\n‚îÇ   ‚îú‚îÄ‚îÄ ERR10802866_R1.fastq.gz\n‚îÇ   ‚îú‚îÄ‚îÄ ERR10802866_R2.fastq.gz\n‚îÇ   ‚îú‚îÄ‚îÄ ERR10802867_R1.fastq.gz\n‚îÇ   ‚îú‚îÄ‚îÄ ERR10802867_R2.fastq.gz\n|   ‚îú‚îÄ‚îÄ [...truncated - more FASTQ files...]\n‚îú‚îÄ‚îÄ meta\n‚îÇ   ‚îî‚îÄ‚îÄ metadata.tsv\n‚îú‚îÄ‚îÄ README.md\n‚îî‚îÄ‚îÄ ref\n    ‚îú‚îÄ‚îÄ GCF_016801865.2.fna\n    ‚îî‚îÄ‚îÄ GCF_016801865.2.gtf\n3 directories, 48 files\nSo, we have:\n\nA whole bunch of FASTQ files (.fastq.gz extension) which contain the HTS reads\nTwo reference genomes files representing the assembly/sequence (.fna) and the annotation table (.gtf)\nA sample metadata file with treatment information for each sample\n\nAll these files are plain-text files, which is one reason why the Unix shell excells at working with them. You‚Äôll take a closer look at each below.\n\n\n Looking at the tree output, what is the (full) path to the file metadata.tsv? (Click to expand)\n\nThe path is /fs/scratch/PAS2880/ENT6703/data/meta/metadata.tsv.\n\n\n\n\n\n\n\nSide note: How you could retrieve this data yourself (Click to expand)\n\n\n\n\n\nAt the end of the Garrig√≥s et al. (2025) paper, there is a section called ‚ÄúOpen Research‚Äù with a ‚ÄúData Availability Statement‚Äù, which reads:\n\nRaw sequences generated in this study have been submitted to the European Nucleotide Archive ENA database (https://www.ebi.ac.uk/ena/browser/home) under project accession number PRJEB41609, Study ERP125411. Sample metadata are available at https://doi.org/10.20350/digitalCSIC/15708.\n\nThe project accession number PRJEB41609 can be used to download the reads in various ways. Because of the large amount of data involved, it‚Äôs convenient to download them directly to OSC rather than first to your own computer. One way to do this is to use the SRA Explorer website, where you can enter the project accession number and get download links so you can download the files with simple commands.\nThe second link can be used to download the sample metadata.\n\n\n\n\n2.1 The sample metadata\nLet‚Äôs start by taking a quick look at a table with information about the samples analyzed in this paper, which we‚Äôll call the sample metadata. This file, metadata.tsv, is a small tabular plain-text file, with columns separated by Tabs (TSV/.tsv is short for ‚ÄúTab-Separated Values‚Äù):\nls -lh data/meta\n-rw-r--r-- 1 jelmer PAS0471 644 Jan 21 09:15 metadata.tsv\nUse the cat command (short for catenate/concatenate) to show the file contents in the shell:\ncat meta/metadata.tsv\nsample_id       dpi     treatment\nERR10802864     1       cathemerium\nERR10802867     1       cathemerium\nERR10802870     1       cathemerium\nERR10802866     1       control\nERR10802869     1       control\nERR10802863     1       control\nERR10802871     1       relictum\nERR10802874     1       relictum\nERR10802865     1       relictum\nERR10802868     1       relictum\nERR10802882     10      cathemerium\nERR10802875     10      cathemerium\nERR10802879     10      cathemerium\nERR10802883     10      cathemerium\nERR10802878     10      control\nERR10802884     10      control\nERR10802877     10      control\nERR10802881     10      control\nERR10802876     10      relictum\nERR10802880     10      relictum\nERR10802885     10      relictum\nERR10802886     10      relictum\nThere are 22 samples in total, with two variables of interest:\n\ndpi ‚Äî time of sampling in Days Post-Infection\ntreatment ‚Äî treatment group: infection status\n\nEach treatment-dpi combination has replicates to allow for statistical comparisons. As mentioned, we‚Äôll discuss these aspects of the experimental design in more detail next week."
  },
  {
    "objectID": "pages/data.html#reference-genome-files",
    "href": "pages/data.html#reference-genome-files",
    "title": "Working with genome and HTS data",
    "section": "3 Reference genome files",
    "text": "3 Reference genome files\nThere are two main types of reference genome files needed for a HTS project like reference-based RNA-Seq:\n\nThe genome assembly, i.e.¬†the nucleotide sequence of each chromosome/scaffold. These are stored in the simple FASTA format.\nThe genome annotation, i.e.¬†a table with the positions of genes and other so-called genomic features on each chromosome/scaffold. These are commonly stored in GTF or similar formats.\n\nBelow, after seeing how you can obtain such files, we‚Äôll focus on exploring the genome assembly FASTA file.\n\n3.1 Finding a reference genome\nImagine you are one of the researchers involved in the Culex study. You‚Äôd want to find out if a Culex pipiens reference genome is available, and if so, download the relevant files. The authors state the following in the paper:\n\nBecause the reference genome and annotations of Cx. pipiens are not published yet, we used the reference genome and annotations of phylogenetically closest species that were available in Ensembl, Cx. quinquefasciatus.\n\nAs discussed in the lecture, reference genomes of closely related species can generally be used if no genome is available for the focal species, but it‚Äôs always best to use a genome of the exact species if possible. We also saw that new reference genomes are rapidly being published. So perhaps a reference genome of Culex pipiens has become available in the meantime?\nGenerally, the first place to look for reference genome data is at NCBI, https://ncbi.nlm.nih.gov, where you can start by simply typing the name of your organism in the search box at the home page. By means of example, let‚Äôs first search for the hoverfly Episyrphus balteatus:\n\n\n\n\n\nYou should get the following box at the top of the results:\n\n\n\n\n\nIf you then click on ‚ÄúGenomes‚Äù, you should see the following table2:\n\n\n\n\n\nSo, NCBI has 5 genomes assemblies for Episyrphus balteatus. The top one:\n\nHas a green check mark next to it, which means that this genome has been designated the primary reference genome for the focal organism.\nIs the only one with an entry in the RefSeq column, which means it has an (NCBI) annotation available.\n\nThat top assembly, idEpiBalt1.1, would therefore be the one to choose, unless you have project-specific reasons to use one of the other assemblies (e.g., a genome from a specific population/lineage).\n\n Exercise: A Culex pipiens reference genome\n\nNow search for Culex pipiens. How many Culex pipiens genomes are on NCBI, and if so, which would you pick?\n\n\nClick for the solution\n\nGo through the same process as shown above for the fruitfly, now entering Culex pipiens in the search box.\nYou should find that there are 5 Culex pipiens assemblies. Very much like for the fruitfly, as it happens, the first one (TS_CPP_V2) is the only with a reference checkmark next to it and an entry in the RefSeq column:\n\n\n\n\n\nSo, there is currently a reference genome for Cx. pipiens available, and we‚Äôll be using that one: the files you‚Äôve seen in the ref dir are for that genome.\n\nYou can click on each assembly to get more information, including statistics like the number of scaffolds. Take a closer look at our focal genome on the NCBI website. What is the size of the genome assembly? How many chromosomes and scaffolds does it contain? And how many protein-coding genes?\n\n\nClick for the solution\n\nOn the genome‚Äôs page at NCBI, it says that the genome assembly has:\n\nA size of 566.3 Mb (Megabases)\n3 chromosomes and 289 unplaced scaffolds\n16,297 protein-coding genes annotated\n\nSee these screenshots:\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nSide note: How you can download reference genome files (Click to expand)\n\n\n\n\n\nIf you wanted to download the reference genome files from the NCBI website, you could either select an assembly in the overview table and click the Download button, or click the Download button at the top of the page for a specific assembly. That should get you the following pop-up window:\n\n\n\n\n\nYou‚Äôll want to select at least the ‚ÄúGenome sequences (FASTA)‚Äù and one or both of the ‚ÄúAnnotation features‚Äù files (GTF is often preferred with RNA-Seq).\nThis allows you to download the data to your computer, and you could then upload it OSC. Though a faster and more reproducible solution would be to use a command in your OSC shell to directly download these ‚Äî the datasets and curl buttons next to the Download one a genome‚Äôs page help with that.\n\n\n\n\n\n\n\n\n\nSide note: Reference genome complications (Click to expand)\n\n\n\n\n\nOther useful database for reference genomes are Ensembl and specialized databases that exist for certain organisms, like FlyBase for Drosophila, VectorBase mostly for mosquitos, and JGI Phytozome for plants.\nIn many cases, these databases don‚Äôt contain the exact same reference genome files than NCBI. Often, at least the annotation is different, but even the assembly may have small differences including in chromosome/scaffold names, which can make these files completely incompatible. And to make matters even more complicated, it is not always clear which database is the best source for your genome.\n\n\n\n\n\n3.2 The genome assembly FASTA file\n\nThe FASTA format\nFASTA files contain one or more DNA or amino acid sequences, with no limits on the number of sequences or the sequence lengths. FASTA is a ubiquitous format in genetics and genomics ‚Äì it is the standard format for, e.g.:\n\nGenome assembly sequences\nTranscriptomes and proteomes (all of an organism‚Äôs transcripts & amino acid sequences, respectively)\nSequence downloads from NCBI such as a single gene/protein or other GenBank entry\n\nThe following example FASTA file contains two entries:\n&gt;unique_sequence_ID Optional description\nATTCATTAAAGCAGTTTATTGGCTTAATGTACATCAGTGAAATCATAAATGCTAAAAA\n&gt;unique_sequence_ID2\nATTCATTAAAGCAGTTTATTGGCTTAATGTACATCAGTGAAATCATAAATGCTAAATG\nEach FASTA entry consists of:\n\nA header line that starts with a &gt; (greater-than sign) and provides an identifier and optionally additional information about the sequence3\nA nucleotide or amino acid sequence (which can span 1 or several/many lines)\n\n\n\nThe Culex genome assembly FASTA file\nThe Culex pipiens reference genome files are in the ref directory:\nls -lh data/ref\n-rw------- 1 jelmer PAS0471 547M Jan 22 12:34 GCF_016801865.2.fna\n-rw------- 1 jelmer PAS0471 123M Jan 22 12:34 GCF_016801865.2.gtf\nThe FASTA file is GCF_016801865.2.fna and is quite large (547 Mb). cat isn‚Äôt a great command to take a peek at such a large file, because it will print all of it to screen üò≥.\nYet the Unix shell more broadly is actually excellent for exploring such files, because visual text editors (say, Notepad or TextEdit) would have lots of trouble opening these large files4.\nA great command to easily view text files of any size is less, which opens them up in a ‚Äúpager‚Äù within your shell ‚Äì you‚Äôll see what that means if you try it with one of the assembly FASTA file:\nless data/ref/GCF_016801865.2.fna\n&gt;NC_068937.1 Culex pipiens pallens isolate TS chromosome 1, TS_CPP_V2, whole genome shotgun sequence\naagcccttttatggtcaaaaatatcgtttaacttgaatatttttccttaaaaaataaataaatttaagcaaacagctgag\ntagatgtcatctactcaaatctacccataagcacacccctgttcaatttttttttcagccataagggcgcctccagtcaa\nattttcatattgagaatttcaatacaattttttaagtcgtaggggcgcctccagtcaaattttcatattgagaatttcaa\ntacatttttttatgtcgtaggggcgcctccagtcaaattttcatattgagaatttcaatacattttttttaagtcgtagg\nggcgcctccagtcaaattttcatattgagaatttcaatacatttttttaagtcttaggggcgcctccagtcaaattttca\ntattgagaatttcaatacatttttttaagtcgtaggggcgcctccagtcaaattttcatattgagaattttaatacaatt\nttttaaatcctaggggcgccttcagacaaacttaatttaaaaaatatcgctcctcgacttggcgactttgcgactgactg\ncgacagcactaccttggaacactgaaatgtttggttgactttccagaaagagtgcatatgacttgaaaaaaaaagagcgc\nttcaaaattgagtcaagaaattggtgaaacttggtgcaagcccttttatggttaaaaatatcgtttaacttgaatatttt\ntccttaaaaaataaataaatttaagcaaacagctgagtagatgtcatctactcaaatctacccataagcacacccctgga\nCCTAATTCATGGAGGTGAATAGAGCATACGTAAATACAAAACTCATGACATTAGCCTGTAAGGATTGTGTaattaatgca\naaaatattgaTAGAATGAAAGATGCAAGTCccaaaaattttaagtaaatgaATAGTAATCATAAAGATAActgatgatga\n\n\n Exercise: Explore the file with less\nAfter running the above command, the file should have ‚Äúopened‚Äù inside the less pager.\nMove around in the file and explore it a bit, which you can do in several ways: by scrolling with your mouse, with up and down arrows, or, if you have them, PgUp and PgDn keys (also, u will move up half a page and d will move down half a page).\nHow many FASTA entries are you seeing in the part of the file you explored?\n\n\n\n\n\n\nNotice that you are ‚Äúinside‚Äù this pager and won‚Äôt have your shell prompt back until you press q to quit less.\n\n\n\n\n\n\n\n\n\n\nSide note: Lowercase vs.¬†uppercase nucleotide letters (Click to expand)\n\n\n\n\n\nAs you have probably noticed, nucleotide bases are typically typed in uppercase (A, C, G, T). What does the mixture of lowercase and uppercase bases in the Cx. pipiens assembly FASTA mean, then?\nLowercase bases are ‚Äúsoft-masked‚Äù: they are repetitive sequences, and bioinformatics programs can treat them differently than non-repetitive sequences, which are in uppercase.\n\n\n\n\n\n\n\n\n\nSide note: Several file extensions are used for FASTA files (Click to expand)\n\n\n\n\n\n\nYou may see files with any of the following file extensions: .fa, .fasta, .fna, .faa\nOf these, ‚Äúgeneric‚Äù extensions are .fasta and .fa (e.g: culex_assembly.fasta)\nThe other extensions explicitly indicate whether sequences are nucleotides (.fna) or amino acids (.faa)\n\nThese extensions are mainly used to help users quickly identify the sequence type: the underlying format is the same in all cases.\n\n\n\n\n\n3.3 Annotation files\nAs you‚Äôve seen, the genome assembly FASTA file merely contains the sequences of the chromosomes/scaffolds. How do you know where on these sequences genes are located? That‚Äôs where the annotation comes in, which in this case is stored in a GTF file (GCF_016801865.2.gtf).\nWe won‚Äôt explore the GTF annotation file (but check the Appendix in your own time if you‚Äôre interested), but it is basically a large table with information about the positions of genes and other genomic features. While the actual format isn‚Äôt quite as simple as this, the basic idea is as follows:\nchromosome      feature  start  end   strand\n--------------------------------------------\nchromosome1     gene1    17     1356   +\nchromosome1     gene2    4902   5041   +\nAmong other things, this information allows you (and tools that can do it for you) to extract gene sequences from the genome assembly FASTA file."
  },
  {
    "objectID": "pages/data.html#fastq-files",
    "href": "pages/data.html#fastq-files",
    "title": "Working with genome and HTS data",
    "section": "4 FASTQ files",
    "text": "4 FASTQ files\n\n4.1 The FASTQ format\nFASTQ is the standard HTS read data file format. Just like the FASTA format, it contains sequences, but in FASTQ, these are accompanied by quality scores (hence FASTQ as in ‚ÄúQ‚Äù for ‚Äúquality‚Äù).\nEach read is represented by four lines:\n\nA header that starts with @ and e.g.¬†uniquely identifies the read\nThe sequence itself\nA plus sign, +\nOne-character ASCII quality scores for each base\n\n\n\n\n\n\n\n\nThe FASTQ format.\n\n\nEach ASCII character in the quality line corresponds to a numeric ‚ÄúPhred‚Äù quality score (\\(Q\\)) that is a function of the estimated error probability for a base call (\\(P\\)):\n\\[\nQ = -10 * log_{10}(P)\n\\]\nSome specific probabilities and their rough qualitative interpretation for Illumina data:\n\n\n\n\n\n\n\n\n\nPhred quality score\nError probability\nRough interpretation\nASCII in FASTQ\n\n\n\n\n10\n1 in 10\nterrible\n+\n\n\n20\n1 in 100\nbad\n5\n\n\n30\n1 in 1,000\ngood\n?\n\n\n40\n1 in 10,000\nexcellent\nI\n\n\n\n\n\n\n But why use those ASCII characters and not just numbers in the quality line? (Click to see the solution)\n\nFirst, to be clear, the question that arises is this: the numeric Phred quality score is represented in FASTQ files by a ‚ÄúASCII character‚Äù corresponding to the number rather than the number itself. That seems roundabout and harder to understand. So why is this done?\nThis is done because it allows for a single-character representation of each possible score ‚Äî such that each quality score character can correspond to (& line up with) a base character in the read.\nFor your reference, here is a complete lookup table to convert the ASCII characters to Phred quality scores (look at the top table, BASE=33).\n\n\n\n\n4.2 FASTQ file sizes and organization\nLet‚Äôs take another look at the list of FASTQ files:\nls -lh data/fastq\n-rw-r--r-- 1 jelmer PAS0471 21M Jan 21 13:36 ERR10802863_R1.fastq.gz\n-rw-r--r-- 1 jelmer PAS0471 22M Jan 21 13:36 ERR10802863_R2.fastq.gz\n-rw-r--r-- 1 jelmer PAS0471 21M Jan 21 13:36 ERR10802864_R1.fastq.gz\n-rw-r--r-- 1 jelmer PAS0471 22M Jan 21 13:36 ERR10802864_R2.fastq.gz\n-rw-r--r-- 1 jelmer PAS0471 22M Jan 21 13:36 ERR10802865_R1.fastq.gz\n-rw-r--r-- 1 jelmer PAS0471 22M Jan 21 13:36 ERR10802865_R2.fastq.gz\n[...truncated...]\nIn the file listing above:\n\nFirst, take note of the file sizes. They are merely about 22 Mb in size, and all have a very similar size. This is because I ‚Äúsubsampled‚Äù the FASTQ files, only retaining 500,000 reads per file. The original files were on average over 1 Gb in size with about 30 million reads.\nSecond, if you look closely at the file names, it looks like there are two FASTQ files per sample: one with _R1 at the end of the file name, and one with _R2.\n\n\n\n What might each of these two files per sample represent/contain? (Click for the solution)\n\nThese contain the forward reads (_R1.fastq.gz) vs.¬†the reverse reads (_R2.fastq.gz).\n\n\n\n Do you have any idea why the file extension ends in .gz? (Click for the solution)\n\nThis means the file is compressed, specifically with a program called ‚Äúgzip‚Äù. This saves a lot of space: compressed files can be up to 10 times smaller than uncompressed files. Most bioinformatics tools, including the FastQC program we‚Äôll run in a bit, can work with gzipped files directly, so there is no need to decompress them.\n\n\n\n4.3 Viewing FASTQ files\nDespite the file compression, you can simply use the less command as before to view the FASTQ files:\nless data/fastq/ERR10802863_R1.fastq.gz\n@ERR10802863.8435456 8435456 length=74\nCAACGAATACATCATGTTTGCGAAACTACTCCTCCTCGCCTTGGTGGGGATCAGTACTGCGTACCAGTATGAGT\n+\nAAAAAEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEE\n@ERR10802863.27637245 27637245 length=74\nGCCACACTTTTGAAGAACAGCGTCATTGTTCTTAATTTTGTCGGCAACGCCTGCACGAGCCTTCCACGTAAGTT\n+\nAAAAAEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEAEE&lt;EEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEE\n\n Exercise: Spotting problematic reads\nExplore the FASTQ file a bit inside less. Can you spot any unusual-looking reads? How do you interpret this?\n\n\nClick for the solution\n\nThe 5th read looks as follows ‚Äî and if you scroll down you should quickly see several more reads just like this:\n@ERR10802863.11918285 11918285 length=35\nNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNN\n+\n###################################\nThese only consist of N bases (and they are also shorter than the other reads), and are therefore completely useless!\n(Note that it is generally not common to run into these kinds of failed reads as easily!)\n\n\n\nWhile the above problematic reads were easy to spot, you wouldn‚Äôt typically perform quality control by manually inspecting FASTQ files. There are simply too many reads to make sense of! Instead, you can use specialized tools like FastQC to summarize FASTQ files ‚Äì that‚Äôs what we‚Äôll do now."
  },
  {
    "objectID": "pages/data.html#fastqc-for-quality-control-of-hts-reads",
    "href": "pages/data.html#fastqc-for-quality-control-of-hts-reads",
    "title": "Working with genome and HTS data",
    "section": "5 FastQC for quality control of HTS reads",
    "text": "5 FastQC for quality control of HTS reads\nFastQC is a very useful and widely used tool to perform quality control of HTS reads. For the budding computational biologist, it is also a good first example of a bioinformatics/HTS analysis tool with a command-line interface.\n\n5.1 Running FastQC\nCommand-line programs like FastQC are operated quite similarly to the Unix shell commands you‚Äôve seen. To run FastQC, you use the command fastqc.\nTo analyze a FASTQ files with default FastQC settings, a complete FastQC command would simply be fastqc, followed by the name of the file as the argument:\nfastqc data/fastq/ERR10802863_R1.fastq.gz\nbash: fastqc: command not found...\n\nLoading the FastQC ‚Äúmodule‚Äù\nBut of course, it can‚Äôt be quite that simple ‚Äì we get an error! While FastQC is installed at OSC5, we have to ‚Äúload it‚Äù before use. The finer details of using software at OSC are outside of the scope of this lab, so here, please accept that we can load FastQC as follows:\nmodule load fastqc/0.12.1\n\n\nChanging the output dir\nBefore trying again, you‚Äôll also make a chance to the command. An ill-advised default behavior of FastQC is that it writes output files in the dir where the input files are ‚Äì it‚Äôs not good practice to directly mix data and results like that!\nTo figure out how we can change that behavior, note that many commands and programs have an option -h and/or --help to print usage information to the screen.\n\n\n Exercise: Finding the output directory option\nPrint FastQC‚Äôs help info, and figure out which option you can use to specify an output dir of your choice.\n\n\nClick for the solution\n\nBoth fastqc -h and fastqc --help will show the help info. You‚Äôll get quite a bit of output printed to screen, including this snippet about output directories:\nfastqc -h\n  -o --outdir  Create all output files in the specified output directory.\n               Please note that this directory must exist as the program\n               will not create it.  If this option is not set then the \n               output file for each sequence file is created in the same\n               directory as the sequence file which was processed.\nThis means that you can use -o or equivalently, --outdir to specify an output dir. (Commands often have both short- and long-form options just for convenience.)\n\n\n\nYou‚Äôll want to have FastQC write output to a deicated dir within the dir you created in the first part of the lab. For me, for example, a good choice would be jelmer/fastqc:\n# Replace 'jelmer' with your own dir name \nfastqc --outdir jelmer/fastqc data/fastq/ERR10802863_R1.fastq.gz\nSpecified output directory 'jelmer/fastqc' does not exist\nBut we get an error! üò°\n\n Exercise: Fixing the output directory problem\nWhat is going on this time? Can you try to fix the problem?\n\n\nIf you know what the problem is, click here for a hint on how to fix it\n\nYou can create a new directory in the OnDemand file explorer, or use a command to create dirs.\nFor the latter option: the command mkdir can be used to create new dirs, where you give the name/path of the dir you want to create as the argument:\n# Replace 'DESIRED-OUTPUT-DIR' with the actual name we want to give the new dir\nmkdir DESIRED-OUTPUT-DIR\n\n\n\nClick here for the solution\n\n\nThe problem, as the error message indicates, is that the output directory that we specified with --outdir does not exist. We might have expected FastQC to be smart/flexible enough to create this dir for us, but alas. To be fair, it did warn us about this in the Help info!\nYou can create this dir in the OnDemand file explorer, but here I will show how to do it with a command: mkdir can be used to create new dirs.\nmkdir jelmer/fastqc\n\n\n\nNow that you‚Äôve created the output directory, let‚Äôs give it a final try before throwing our laptops out the window:\nfastqc --outdir jelmer/fastqc data/fastq/ERR10802863_R1.fastq.gz\napplication/gzip\nStarted analysis of ERR10802863_R1.fastq.gz\nApprox 5% complete for ERR10802863_R1.fastq.gz\nApprox 10% complete for ERR10802863_R1.fastq.gz\nApprox 15% complete for ERR10802863_R1.fastq.gz\nApprox 20% complete for ERR10802863_R1.fastq.gz\nApprox 25% complete for ERR10802863_R1.fastq.gz\n[...truncated...]\nApprox 100% complete for ERR10802863_R1.fastq.gz\nAnalysis complete for ERR10802863_R1.fastq.gz\nSuccess!! ü•≥\n\n\n5.2 FastQC output files\nLet‚Äôs take a look at the files in the output dir you specified:\n# [Replace 'jelmer' with your own dir name]\nls -lh jelmer/fastqc\ntotal 1.1M\n-rw-r--r-- 1 jelmer PAS0471 718K Jan 27 13:12 ERR10802863_R1_fastqc.html\n-rw-r--r-- 1 jelmer PAS0471 364K Jan 27 13:12 ERR10802863_R1_fastqc.zip\n\nThere is a .zip file ‚Äî this contains tables with FastQC‚Äôs data summaries\nThere is an .html (HTML) file ‚Äì this contains QC plots and is what we‚Äôll look at next\n\n\n Exercise: Run FastQC for the R2 file\nRun FastQC for the corresponding R2 FASTQ file. Would you use the same output dir?\n\n\nClick here for the solution\n\nYes, it makes sense to use the same output dir, since as you could see above, the output file names have the input file identifiers in them. As such, you don‚Äôt need to worry about overwriting files, and it will be easier to have all the results in a single dir.\nTo run FastQC for the R2 (=reverse-read) FASTQ file:\nfastqc --outdir jelmer/fastqc data/fastq/ERR10802863_R2.fastq.gz\nStarted analysis of ERR10802863_R2.fastq.gz\nApprox 5% complete for ERR10802863_R2.fastq.gz\nApprox 10% complete for ERR10802863_R2.fastq.gz\nApprox 15% complete for ERR10802863_R2.fastq.gz\n[...truncated...]\nAnalysis complete for ERR10802863_2.fastq.gz\nls -lh jelmer/fastqc\n-rw-r--r-- 1 jelmer PAS0471 241K Jan 21 21:50 ERR10802863_R1_fastqc.html\n-rw-r--r-- 1 jelmer PAS0471 256K Jan 21 21:50 ERR10802863_R1_fastqc.zip\n-rw-r--r-- 1 jelmer PAS0471 234K Jan 21 21:53 ERR10802863_R2_fastqc.html\n-rw-r--r-- 1 jelmer PAS0471 244K Jan 21 21:53 ERR10802863_R2_fastqc.zip\nNow, you have four FastQC output files: two for each of your preceding successful FastQC runs."
  },
  {
    "objectID": "pages/data.html#interpreting-fastqcs-output",
    "href": "pages/data.html#interpreting-fastqcs-output",
    "title": "Working with genome and HTS data",
    "section": "6 Interpreting FastQC‚Äôs output",
    "text": "6 Interpreting FastQC‚Äôs output\nFirst, you‚Äôll have to download FastQC‚Äôs output HTML files, because you can‚Äôt view them in the Unix shell6.\n\nFind the FastQC HTML files in the OnDemand Files menu file explorer.\nSelect the two files by clicking the check-box at the right, and click the Download bottom towards the top.\nDownload the file to somewhere on your computer (doesn‚Äôt matter where), and your browser should give you a pop-up with the file you can click on to open it.\nSince the file is in HTML format, it should open in your web browser.\n\n\n\n\n\n\n\n\nWith the two HTML files selected, you can click the Download button at the top\n\n\nWe‚Äôll now go through a couple of the FastQC plots/modules, with first some example plots7 with good/bad results for reference.\n\n6.1 Overview of module results\nFastQC has ‚Äúpass‚Äù (checkmark in green), ‚Äúwarning‚Äù (exclamation mark in orange), and ‚Äúfail‚Äù (cross in red) assessments for each module, as you can see below.\n\n\n\n\n\n\n\n\n\n\n\nMore about the FastQC module assessments (Click to expand)\n\n\n\n\n\nThese pass/warning/fail assessments are handy and typically at least somewhat meaningful, but you should realize that a ‚Äúwarning‚Äù or a ‚Äúfail‚Äù is not necessarily the bad news that it may appear to be. That‚Äôs because, for example:\n\nSome of these modules are rather strict, perhaps overly strict.\nSome warnings and fails are easily remedied or simply not a very big deal.\nFastQC assumes that your data is derived from whole-genome shotgun sequencing ‚Äî some other types of data like RNA-Seq data will always trigger a couple of warnings and files based on expected differences.\n\n\n\n\n\n\n6.2 Basic statistics module\nThis section shows, for example, the number of sequences (reads) and the read length range for your file:\n\n\n\n\n\n\n\n6.3 Per base quality graph\nThis figure visualize the mean per-base Phred quality score (as discussed above; y-axis) along the length of the reads (x-axis). Note that:\n\nA decrease in sequence quality along the reads is normal\nR2 (reverse) reads are usually worse than R1 (forward) reads\n\n\n\nGood / acceptable:\n\n\n\n\n\n\nBad:\n\n\n\n\n\n\n\n\n\n6.4 Adapter content graph\nChecks for known adapter sequences. As you‚Äôve learned, when an insert size is shorter than the read length, adapters will end up in the sequence ‚Äì these should be removed!\n\n\nGood:\n\n\n\n\n\n\nBad:\n\n\n\n\n\n\n\n\n Exercise: Interpreting the FastQC output\nOpen the HTML file for the R1 FASTQ file and go through the modules we discussed above. Can you make sense of it? Does the data look good to you, overall?\nNow open the HTML file for the R2 FASTQ file and take a look just at the quality score graph. Does it look any worse than the R1?"
  },
  {
    "objectID": "pages/data.html#prep-for-next-weeks-lab",
    "href": "pages/data.html#prep-for-next-weeks-lab",
    "title": "Working with genome and HTS data",
    "section": "7 Prep for next week‚Äôs lab",
    "text": "7 Prep for next week‚Äôs lab\nIn next week‚Äôs lab, you will be working in R, using RStudio, to analyze the gene expression counts resulting from this RNA-Seq data. You will have homework to prepare for that lab. To make that a bit easier for you, I‚Äôll now demonstrate how to start an RStudio session at OSC:\n\n\n\n\n\n\nIt‚Äôs necessary to fill out this form (instead of just opening RStudio) because RStudio runs on a compute node rather than a login node. Whenever you want to access a compute node, you need to request resources for it, like this form does.\n\n\n\n\nGo to the OnDemand homepage as before\nClick on Interactive Apps (top bar) and then RStudio Server (all the way at the bottom)\nFill out the form as follows:\n\nCluster: cardinal\nR version: 4.4.0\nProject: PAS2880\nNumber of hours: 4\nNode type: any\nNumber of cores: 2\n\nClick the big blue Launch button at the bottom\nNow, you should be sent to a new page with a box at the top for your RStudio Server ‚Äújob‚Äù, which should initially be ‚ÄúQueued‚Äù (waiting to start).\nYour job should start running very soon, with the top bar of the box turning green and saying ‚ÄúRunning‚Äù.\n\n\nClick to see a screenshot\n\n\n\n\n\n\n\nClick Connect to RStudio Server at the bottom of the box, and an RStudio Server instance will open in a new browser tab. You‚Äôre ready to go!"
  },
  {
    "objectID": "pages/data.html#in-closing",
    "href": "pages/data.html#in-closing",
    "title": "Working with genome and HTS data",
    "section": "8 In closing",
    "text": "8 In closing\nIn today‚Äôs lab, you were introduced to:\n\nWorking at the Ohio Supercomputer Center\nUsing the Unix shell\nReference genome files & where to find these\nHTS read FASTQ files and how to quality-control these\nHow to run a command-line bioinformatics tool\n\nTaking a step back, I‚Äôve shown you the main pieces of the computational infrastructure for what we may call ‚Äúcommand-line genomics‚Äù: genomics analysis using command-line tools. And you‚Äôve seen a basic example of loading and running a command-line tool at OSC.\n\n\n\n\n\n\nSide note: scaling the analysis & next steps for real projects (Click to expand)\n\n\n\n\n\nFor this brief intro to HTS data analysis, we‚Äôve kept things simple. In a typical HTS data analysis project, however, there are some more pieces to the puzzle that we didn‚Äôt cover today:\n\nUsing a text editor with an integrated terminal (e.g., VS Code) to be able to write and edit scripts more easily\nPutting commands to run programs FastQC in a ‚Äúshell script‚Äù.\nSubmitting the script as a ‚Äúbatch job‚Äù.\nTo make speed things, using the OSC‚Äôs capabilities, we can submit multiple jobs in parallel using a loop.\n\nIf it seems that speed and computing power may not be an issue, given how fast FastQC ran, keep in mind that:\n\nWe here worked with subsampled (much smaller than usual) FASTQ files\nWe only ran FastQC for one of our 23 samples, and your experiment may have 50+ samples\nWe need to run a bunch more tools, and some of those take much longer to run or need lots of computer resources.\n\nAll that said, those missing pieces mentioned above are outside the scope of this short introduction ‚Äî but if you managed today, it should not be hard to learn those skills either."
  },
  {
    "objectID": "pages/data.html#appendix-gtf-files",
    "href": "pages/data.html#appendix-gtf-files",
    "title": "Working with genome and HTS data",
    "section": "9 Appendix: GTF files",
    "text": "9 Appendix: GTF files\n\n9.1 The GTF format\nThe GTF format is a tab-delimited tabular file format that contains genome annotations, with:\n\nOne row for each annotated ‚Äúgenomic feature‚Äù (gene, exon, etc.)\nOne column for each piece of information about a feature, like its genomic coordinates\n\nSee the sample below, with an added header line (not normally present) with column names:\nseqname     source  feature start   end     score  strand  frame    attributes\nNC_000001   RefSeq  gene    11874   14409   .       +       .       gene_id \"DDX11L1\"; transcript_id \"\"; db_xref \"GeneID:100287102\"; db_xref \"HGNC:HGNC:37102\"; description \"DEAD/H-box helicase 11 like 1 (pseudogene)\"; gbkey \"Gene\"; gene \"DDX11L1\"; gene_biotype \"transcribed_pseudogene\"; pseudo \"true\"; \nNC_000001   RefSeq  exon    11874   12227   .       +       .       gene_id \"DDX11L1\"; transcript_id \"NR_046018.2\"; db_xref \"GeneID:100287102\"; gene \"DDX11L1\"; product \"DEAD/H-box helicase 11 like 1 (pseudogene)\"; pseudo \"true\"; \nSome details on the more important/interesting columns:\n\nseqname ‚Äî Name of the chromosome, scaffold, or contig\nfeature ‚Äî Name of the feature type, e.g.¬†‚Äúgene‚Äù, ‚Äúexon‚Äù, ‚Äúintron‚Äù, ‚ÄúCDS‚Äù\nstart & end ‚Äî Start & end position of the feature\nstrand ‚Äî Whether the feature is on the + (forward) or - (reverse) strand\nattribute ‚Äî A semicolon-separated list of tag-value pairs with additional information\n\n\n\n9.2 The Culex pipiens GTF file\nTake a look at the GTF file for the Culex pipiens reference genome ‚Äì like before, use less, but now with the -S option:\nless -S data/ref/GCF_016801865.2.gtf\n#gtf-version 2.2\n#!genome-build TS_CPP_V2\n#!genome-build-accession NCBI_Assembly:GCF_016801865.2\n#!annotation-source NCBI RefSeq GCF_016801865.2-RS_2022_12\nNC_068937.1     Gnomon  gene    2046    110808  .       +       .       gene_id \"LOC120427725\"; transcript_id \"\"; db_xref \"GeneID:120427725\"; description \"homeotic protein deformed\"; gbkey \"Gene\"; gene \"LOC120427725\"; gene_biotype \"protein_coding\"; \nNC_068937.1     Gnomon  transcript      2046    110808  .       +       .       gene_id \"LOC120427725\"; transcript_id \"XM_052707445.1\"; db_xref \"GeneID:120427725\"; gbkey \"mRNA\"; gene \"LOC120427725\"; model_evidence \"Supporting evidence includes similarity to: 25 Proteins\"; product \"homeotic protein deformed, transcript variant X3\"; transcript_biotype \"mRNA\"; \nNC_068937.1     Gnomon  exon    2046    2531    .       +       .       gene_id \"LOC120427725\"; transcript_id \"XM_052707445.1\"; db_xref \"GeneID:120427725\"; gene \"LOC120427725\"; model_evidence \"Supporting evidence includes similarity to: 25 Proteins\"; product \"homeotic protein deformed, transcript variant X3\"; transcript_biotype \"mRNA\"; exon_number \"1\"; \nNC_068937.1     Gnomon  exon    52113   52136   .       +       .       gene_id \"LOC120427725\"; transcript_id \"XM_052707445.1\"; db_xref \"GeneID:120427725\"; gene \"LOC120427725\"; model_evidence \"Supporting evidence includes similarity to: 25 Proteins\"; product \"homeotic protein deformed, transcript variant X3\"; transcript_biotype \"mRNA\"; exon_number \"2\"; \nNC_068937.1     Gnomon  exon    70113   70962   .       +       .       gene_id \"LOC120427725\"; transcript_id \"XM_052707445.1\"; db_xref \"GeneID:120427725\"; gene \"LOC120427725\"; model_evidence \"Supporting evidence includes similarity to: 25 Proteins\"; product \"homeotic protein deformed, transcript variant X3\"; transcript_biotype \"mRNA\"; exon_number \"3\"; \nNC_068937.1     Gnomon  exon    105987  106087  .       +       .       gene_id \"LOC120427725\"; transcript_id \"XM_052707445.1\"; db_xref \"GeneID:120427725\"; gene \"LOC120427725\"; model_evidence \"Supporting evidence includes similarity to: 25 Proteins\"; product \"homeotic protein deformed, transcript variant X3\"; transcript_biotype \"mRNA\"; exon_number \"4\"; \nNC_068937.1     Gnomon  exon    106551  106734  .       +       .       gene_id \"LOC120427725\"; transcript_id \"XM_052707445.1\"; db_xref \"GeneID:120427725\"; gene \"LOC120427725\"; model_evidence \"Supporting evidence includes similarity to: 25 Proteins\"; product \"homeotic protein deformed, transcript variant X3\"; transcript_biotype \"mRNA\"; exon_number \"5\"; \n\n\n\n\n\n\nAvoid line-wrapping with less -S\n\n\n\nLines in a file may contain too many characters to fit on your screen, as will be the case for this GTF file. less will by default ‚Äúwrap‚Äù such lines onto the next line on your screen, but this is often confusing for files like FASTQ and tabular files like GTF. Therefore, we turned off line-wrapping above by using the -S option to less.\n\n\n\n Exercise: Understanding GTF entries\nThe GTF file is sorted: all entries from the first line of the table, until the next time you a ‚Äúgene‚Äù entry in the third column, list features are part of the first gene.\nCan you make sense of all the entries for the first gene in the GTF, given what you know of gene structures? How many transcripts does the gene have?\n\n\nClick to see some pointers\n\n\nThe first gene (LOC120427725) has 3 transcripts.\nEach transcript has 6-7 exons, 5 CDSs, and a start and stop codon.\n\nBelow, I‚Äôve printed all lines belonging to the first gene:\nNC_068937.1 Gnomon  gene    2046    110808  .   +   .   gene_id \"LOC120427725\"; transcript_id \"\"; db_xref \"GeneID:120427725\"; description \"homeotic protein deformed\"; gbkey \"Gene\"; gene \"LOC120427725\"; gene_biotype \"protein_coding\"; \nNC_068937.1 Gnomon  transcript  2046    110808  .   +   .   gene_id \"LOC120427725\"; transcript_id \"XM_052707445.1\"; db_xref \"GeneID:120427725\"; gbkey \"mRNA\"; gene \"LOC120427725\"; model_evidence \"Supporting evidence includes similarity to: 25 Proteins\"; product \"homeotic protein deformed, transcript variant X3\"; transcript_biotype \"mRNA\"; \nNC_068937.1 Gnomon  exon    2046    2531    .   +   .   gene_id \"LOC120427725\"; transcript_id \"XM_052707445.1\"; db_xref \"GeneID:120427725\"; gene \"LOC120427725\"; model_evidence \"Supporting evidence includes similarity to: 25 Proteins\"; product \"homeotic protein deformed, transcript variant X3\"; transcript_biotype \"mRNA\"; exon_number \"1\"; \nNC_068937.1 Gnomon  exon    52113   52136   .   +   .   gene_id \"LOC120427725\"; transcript_id \"XM_052707445.1\"; db_xref \"GeneID:120427725\"; gene \"LOC120427725\"; model_evidence \"Supporting evidence includes similarity to: 25 Proteins\"; product \"homeotic protein deformed, transcript variant X3\"; transcript_biotype \"mRNA\"; exon_number \"2\"; \nNC_068937.1 Gnomon  exon    70113   70962   .   +   .   gene_id \"LOC120427725\"; transcript_id \"XM_052707445.1\"; db_xref \"GeneID:120427725\"; gene \"LOC120427725\"; model_evidence \"Supporting evidence includes similarity to: 25 Proteins\"; product \"homeotic protein deformed, transcript variant X3\"; transcript_biotype \"mRNA\"; exon_number \"3\"; \nNC_068937.1 Gnomon  exon    105987  106087  .   +   .   gene_id \"LOC120427725\"; transcript_id \"XM_052707445.1\"; db_xref \"GeneID:120427725\"; gene \"LOC120427725\"; model_evidence \"Supporting evidence includes similarity to: 25 Proteins\"; product \"homeotic protein deformed, transcript variant X3\"; transcript_biotype \"mRNA\"; exon_number \"4\"; \nNC_068937.1 Gnomon  exon    106551  106734  .   +   .   gene_id \"LOC120427725\"; transcript_id \"XM_052707445.1\"; db_xref \"GeneID:120427725\"; gene \"LOC120427725\"; model_evidence \"Supporting evidence includes similarity to: 25 Proteins\"; product \"homeotic protein deformed, transcript variant X3\"; transcript_biotype \"mRNA\"; exon_number \"5\"; \nNC_068937.1 Gnomon  exon    109296  109660  .   +   .   gene_id \"LOC120427725\"; transcript_id \"XM_052707445.1\"; db_xref \"GeneID:120427725\"; gene \"LOC120427725\"; model_evidence \"Supporting evidence includes similarity to: 25 Proteins\"; product \"homeotic protein deformed, transcript variant X3\"; transcript_biotype \"mRNA\"; exon_number \"6\"; \nNC_068937.1 Gnomon  exon    109726  110808  .   +   .   gene_id \"LOC120427725\"; transcript_id \"XM_052707445.1\"; db_xref \"GeneID:120427725\"; gene \"LOC120427725\"; model_evidence \"Supporting evidence includes similarity to: 25 Proteins\"; product \"homeotic protein deformed, transcript variant X3\"; transcript_biotype \"mRNA\"; exon_number \"7\"; \nNC_068937.1 Gnomon  CDS 70143   70962   .   +   0   gene_id \"LOC120427725\"; transcript_id \"XM_052707445.1\"; db_xref \"GeneID:120427725\"; gbkey \"CDS\"; gene \"LOC120427725\"; product \"homeotic protein deformed\"; protein_id \"XP_052563405.1\"; exon_number \"3\"; \nNC_068937.1 Gnomon  CDS 105987  106087  .   +   2   gene_id \"LOC120427725\"; transcript_id \"XM_052707445.1\"; db_xref \"GeneID:120427725\"; gbkey \"CDS\"; gene \"LOC120427725\"; product \"homeotic protein deformed\"; protein_id \"XP_052563405.1\"; exon_number \"4\"; \nNC_068937.1 Gnomon  CDS 106551  106734  .   +   0   gene_id \"LOC120427725\"; transcript_id \"XM_052707445.1\"; db_xref \"GeneID:120427725\"; gbkey \"CDS\"; gene \"LOC120427725\"; product \"homeotic protein deformed\"; protein_id \"XP_052563405.1\"; exon_number \"5\"; \nNC_068937.1 Gnomon  CDS 109296  109660  .   +   2   gene_id \"LOC120427725\"; transcript_id \"XM_052707445.1\"; db_xref \"GeneID:120427725\"; gbkey \"CDS\"; gene \"LOC120427725\"; product \"homeotic protein deformed\"; protein_id \"XP_052563405.1\"; exon_number \"6\"; \nNC_068937.1 Gnomon  CDS 109726  110025  .   +   0   gene_id \"LOC120427725\"; transcript_id \"XM_052707445.1\"; db_xref \"GeneID:120427725\"; gbkey \"CDS\"; gene \"LOC120427725\"; product \"homeotic protein deformed\"; protein_id \"XP_052563405.1\"; exon_number \"7\"; \nNC_068937.1 Gnomon  start_codon 70143   70145   .   +   0   gene_id \"LOC120427725\"; transcript_id \"XM_052707445.1\"; db_xref \"GeneID:120427725\"; gbkey \"CDS\"; gene \"LOC120427725\"; product \"homeotic protein deformed\"; protein_id \"XP_052563405.1\"; exon_number \"3\"; \nNC_068937.1 Gnomon  stop_codon  110026  110028  .   +   0   gene_id \"LOC120427725\"; transcript_id \"XM_052707445.1\"; db_xref \"GeneID:120427725\"; gbkey \"CDS\"; gene \"LOC120427725\"; product \"homeotic protein deformed\"; protein_id \"XP_052563405.1\"; exon_number \"7\"; \nNC_068937.1 Gnomon  transcript  5979    110808  .   +   .   gene_id \"LOC120427725\"; transcript_id \"XM_039592629.2\"; db_xref \"GeneID:120427725\"; gbkey \"mRNA\"; gene \"LOC120427725\"; model_evidence \"Supporting evidence includes similarity to: 24 Proteins\"; product \"homeotic protein deformed, transcript variant X2\"; transcript_biotype \"mRNA\"; \nNC_068937.1 Gnomon  exon    5979    6083    .   +   .   gene_id \"LOC120427725\"; transcript_id \"XM_039592629.2\"; db_xref \"GeneID:120427725\"; gene \"LOC120427725\"; model_evidence \"Supporting evidence includes similarity to: 24 Proteins\"; product \"homeotic protein deformed, transcript variant X2\"; transcript_biotype \"mRNA\"; exon_number \"1\"; \nNC_068937.1 Gnomon  exon    52113   52136   .   +   .   gene_id \"LOC120427725\"; transcript_id \"XM_039592629.2\"; db_xref \"GeneID:120427725\"; gene \"LOC120427725\"; model_evidence \"Supporting evidence includes similarity to: 24 Proteins\"; product \"homeotic protein deformed, transcript variant X2\"; transcript_biotype \"mRNA\"; exon_number \"2\"; \nNC_068937.1 Gnomon  exon    70113   70962   .   +   .   gene_id \"LOC120427725\"; transcript_id \"XM_039592629.2\"; db_xref \"GeneID:120427725\"; gene \"LOC120427725\"; model_evidence \"Supporting evidence includes similarity to: 24 Proteins\"; product \"homeotic protein deformed, transcript variant X2\"; transcript_biotype \"mRNA\"; exon_number \"3\"; \nNC_068937.1 Gnomon  exon    105987  106087  .   +   .   gene_id \"LOC120427725\"; transcript_id \"XM_039592629.2\"; db_xref \"GeneID:120427725\"; gene \"LOC120427725\"; model_evidence \"Supporting evidence includes similarity to: 24 Proteins\"; product \"homeotic protein deformed, transcript variant X2\"; transcript_biotype \"mRNA\"; exon_number \"4\"; \nNC_068937.1 Gnomon  exon    106551  106734  .   +   .   gene_id \"LOC120427725\"; transcript_id \"XM_039592629.2\"; db_xref \"GeneID:120427725\"; gene \"LOC120427725\"; model_evidence \"Supporting evidence includes similarity to: 24 Proteins\"; product \"homeotic protein deformed, transcript variant X2\"; transcript_biotype \"mRNA\"; exon_number \"5\"; \nNC_068937.1 Gnomon  exon    109296  109660  .   +   .   gene_id \"LOC120427725\"; transcript_id \"XM_039592629.2\"; db_xref \"GeneID:120427725\"; gene \"LOC120427725\"; model_evidence \"Supporting evidence includes similarity to: 24 Proteins\"; product \"homeotic protein deformed, transcript variant X2\"; transcript_biotype \"mRNA\"; exon_number \"6\"; \nNC_068937.1 Gnomon  exon    109726  110808  .   +   .   gene_id \"LOC120427725\"; transcript_id \"XM_039592629.2\"; db_xref \"GeneID:120427725\"; gene \"LOC120427725\"; model_evidence \"Supporting evidence includes similarity to: 24 Proteins\"; product \"homeotic protein deformed, transcript variant X2\"; transcript_biotype \"mRNA\"; exon_number \"7\"; \nNC_068937.1 Gnomon  CDS 70143   70962   .   +   0   gene_id \"LOC120427725\"; transcript_id \"XM_039592629.2\"; db_xref \"GeneID:120427725\"; gbkey \"CDS\"; gene \"LOC120427725\"; product \"homeotic protein deformed\"; protein_id \"XP_039448563.1\"; exon_number \"3\"; \nNC_068937.1 Gnomon  CDS 105987  106087  .   +   2   gene_id \"LOC120427725\"; transcript_id \"XM_039592629.2\"; db_xref \"GeneID:120427725\"; gbkey \"CDS\"; gene \"LOC120427725\"; product \"homeotic protein deformed\"; protein_id \"XP_039448563.1\"; exon_number \"4\"; \nNC_068937.1 Gnomon  CDS 106551  106734  .   +   0   gene_id \"LOC120427725\"; transcript_id \"XM_039592629.2\"; db_xref \"GeneID:120427725\"; gbkey \"CDS\"; gene \"LOC120427725\"; product \"homeotic protein deformed\"; protein_id \"XP_039448563.1\"; exon_number \"5\"; \nNC_068937.1 Gnomon  CDS 109296  109660  .   +   2   gene_id \"LOC120427725\"; transcript_id \"XM_039592629.2\"; db_xref \"GeneID:120427725\"; gbkey \"CDS\"; gene \"LOC120427725\"; product \"homeotic protein deformed\"; protein_id \"XP_039448563.1\"; exon_number \"6\"; \nNC_068937.1 Gnomon  CDS 109726  110025  .   +   0   gene_id \"LOC120427725\"; transcript_id \"XM_039592629.2\"; db_xref \"GeneID:120427725\"; gbkey \"CDS\"; gene \"LOC120427725\"; product \"homeotic protein deformed\"; protein_id \"XP_039448563.1\"; exon_number \"7\"; \nNC_068937.1 Gnomon  start_codon 70143   70145   .   +   0   gene_id \"LOC120427725\"; transcript_id \"XM_039592629.2\"; db_xref \"GeneID:120427725\"; gbkey \"CDS\"; gene \"LOC120427725\"; product \"homeotic protein deformed\"; protein_id \"XP_039448563.1\"; exon_number \"3\"; \nNC_068937.1 Gnomon  stop_codon  110026  110028  .   +   0   gene_id \"LOC120427725\"; transcript_id \"XM_039592629.2\"; db_xref \"GeneID:120427725\"; gbkey \"CDS\"; gene \"LOC120427725\"; product \"homeotic protein deformed\"; protein_id \"XP_039448563.1\"; exon_number \"7\"; \nNC_068937.1 Gnomon  transcript  60854   110807  .   +   .   gene_id \"LOC120427725\"; transcript_id \"XM_039592628.2\"; db_xref \"GeneID:120427725\"; gbkey \"mRNA\"; gene \"LOC120427725\"; model_evidence \"Supporting evidence includes similarity to: 24 Proteins\"; product \"homeotic protein deformed, transcript variant X1\"; transcript_biotype \"mRNA\"; \nNC_068937.1 Gnomon  exon    60854   61525   .   +   .   gene_id \"LOC120427725\"; transcript_id \"XM_039592628.2\"; db_xref \"GeneID:120427725\"; gene \"LOC120427725\"; model_evidence \"Supporting evidence includes similarity to: 24 Proteins\"; product \"homeotic protein deformed, transcript variant X1\"; transcript_biotype \"mRNA\"; exon_number \"1\"; \nNC_068937.1 Gnomon  exon    70113   70962   .   +   .   gene_id \"LOC120427725\"; transcript_id \"XM_039592628.2\"; db_xref \"GeneID:120427725\"; gene \"LOC120427725\"; model_evidence \"Supporting evidence includes similarity to: 24 Proteins\"; product \"homeotic protein deformed, transcript variant X1\"; transcript_biotype \"mRNA\"; exon_number \"2\"; \nNC_068937.1 Gnomon  exon    105987  106087  .   +   .   gene_id \"LOC120427725\"; transcript_id \"XM_039592628.2\"; db_xref \"GeneID:120427725\"; gene \"LOC120427725\"; model_evidence \"Supporting evidence includes similarity to: 24 Proteins\"; product \"homeotic protein deformed, transcript variant X1\"; transcript_biotype \"mRNA\"; exon_number \"3\"; \nNC_068937.1 Gnomon  exon    106551  106734  .   +   .   gene_id \"LOC120427725\"; transcript_id \"XM_039592628.2\"; db_xref \"GeneID:120427725\"; gene \"LOC120427725\"; model_evidence \"Supporting evidence includes similarity to: 24 Proteins\"; product \"homeotic protein deformed, transcript variant X1\"; transcript_biotype \"mRNA\"; exon_number \"4\"; \nNC_068937.1 Gnomon  exon    109296  109660  .   +   .   gene_id \"LOC120427725\"; transcript_id \"XM_039592628.2\"; db_xref \"GeneID:120427725\"; gene \"LOC120427725\"; model_evidence \"Supporting evidence includes similarity to: 24 Proteins\"; product \"homeotic protein deformed, transcript variant X1\"; transcript_biotype \"mRNA\"; exon_number \"5\"; \nNC_068937.1 Gnomon  exon    109726  110807  .   +   .   gene_id \"LOC120427725\"; transcript_id \"XM_039592628.2\"; db_xref \"GeneID:120427725\"; gene \"LOC120427725\"; model_evidence \"Supporting evidence includes similarity to: 24 Proteins\"; product \"homeotic protein deformed, transcript variant X1\"; transcript_biotype \"mRNA\"; exon_number \"6\"; \nNC_068937.1 Gnomon  CDS 70143   70962   .   +   0   gene_id \"LOC120427725\"; transcript_id \"XM_039592628.2\"; db_xref \"GeneID:120427725\"; gbkey \"CDS\"; gene \"LOC120427725\"; product \"homeotic protein deformed\"; protein_id \"XP_039448562.1\"; exon_number \"2\"; \nNC_068937.1 Gnomon  CDS 105987  106087  .   +   2   gene_id \"LOC120427725\"; transcript_id \"XM_039592628.2\"; db_xref \"GeneID:120427725\"; gbkey \"CDS\"; gene \"LOC120427725\"; product \"homeotic protein deformed\"; protein_id \"XP_039448562.1\"; exon_number \"3\"; \nNC_068937.1 Gnomon  CDS 106551  106734  .   +   0   gene_id \"LOC120427725\"; transcript_id \"XM_039592628.2\"; db_xref \"GeneID:120427725\"; gbkey \"CDS\"; gene \"LOC120427725\"; product \"homeotic protein deformed\"; protein_id \"XP_039448562.1\"; exon_number \"4\"; \nNC_068937.1 Gnomon  CDS 109296  109660  .   +   2   gene_id \"LOC120427725\"; transcript_id \"XM_039592628.2\"; db_xref \"GeneID:120427725\"; gbkey \"CDS\"; gene \"LOC120427725\"; product \"homeotic protein deformed\"; protein_id \"XP_039448562.1\"; exon_number \"5\"; \nNC_068937.1 Gnomon  CDS 109726  110025  .   +   0   gene_id \"LOC120427725\"; transcript_id \"XM_039592628.2\"; db_xref \"GeneID:120427725\"; gbkey \"CDS\"; gene \"LOC120427725\"; product \"homeotic protein deformed\"; protein_id \"XP_039448562.1\"; exon_number \"6\"; \nNC_068937.1 Gnomon  start_codon 70143   70145   .   +   0   gene_id \"LOC120427725\"; transcript_id \"XM_039592628.2\"; db_xref \"GeneID:120427725\"; gbkey \"CDS\"; gene \"LOC120427725\"; product \"homeotic protein deformed\"; protein_id \"XP_039448562.1\"; exon_number \"2\"; \nNC_068937.1 Gnomon  stop_codon  110026  110028  .   +   0   gene_id \"LOC120427725\"; transcript_id \"XM_039592628.2\"; db_xref \"GeneID:120427725\"; gbkey \"CDS\"; gene \"LOC120427725\"; product \"homeotic protein deformed\"; protein_id \"XP_039448562.1\"; exon_number \"6\";"
  },
  {
    "objectID": "pages/data.html#footnotes",
    "href": "pages/data.html#footnotes",
    "title": "Working with genome and HTS data",
    "section": "Footnotes",
    "text": "Footnotes\n\n\n That is, an HTS project where reads can be mapped to a reference genome.‚Ü©Ô∏é\nAs of January, 2026.‚Ü©Ô∏é\n There are no universal standards for the header line format, but individual programs and databases may expect specific formats.‚Ü©Ô∏é\nThe reason is that they try to load them into RAM memory entirely, even if you just want to see the first few lines.‚Ü©Ô∏é\nFor a full list of installed software at OSC: https://www.osc.edu/resources/available_software/software_list‚Ü©Ô∏é\n The Unix shell is great for plain-text file, but not for other types of files.‚Ü©Ô∏é\n Some of the FastQC example plots were taken from here.‚Ü©Ô∏é"
  },
  {
    "objectID": "pages/resources.html",
    "href": "pages/resources.html",
    "title": "Resources for further learning",
    "section": "",
    "text": "OSC\n\nhttps://mcic-osu.github.io/rnaseq-intro/modules/A01_osc.html\nOSC‚Äôs online asynchronous courses\nOSC‚Äôs new User Resource Guide\n\nVS Code\n\nhttps://mcic-osu.github.io/rnaseq-intro/modules/A02_vscode.html\n\nUnix shell\n\nOSC‚Äôs UNIX Basics\nhttps://mcic-osu.github.io/rnaseq-intro/modules/A03_shell1.html\nhttps://mcic-osu.github.io/rnaseq-intro/modules/A04_shell2.html\nhttps://www.learnenough.com/command-line-tutorial\nhttps://cvw.cac.cornell.edu/Linux/\n\nOSU courses\n\nGenome Analytics course (HCS 7004)\nMicrobiome Informatics course (MICRBIO 8161)\nComputing Skills for Omics Data (PLNTPTH 5006, taught as IS in SP24 2nd session as PLNTPTH 6193)\n\nOnline workshop/course material\n\nWorkshop ‚ÄúCommand line basics for genomic analysis at OSC‚Äù (Mike Sovic & Jelmer Poelstra, 2022)\nCourse ‚ÄúPractical Computing Skills for Biologists‚Äù (Jelmer Poelstra, 2021)\n\nBooks\n\nA Primer for Computational Biology (Shawn T. O‚Äô Neil, 2019) (available online!)\nComputing Skills for Biologists: A Toolbox (Wilmes & Allesino, 2019)\nBioinformatics Data Skills (Vince Buffalo, 2015)\nThe Linux Command Line (William Shotts, 2019)\n\n\n\n\n\n Back to top"
  },
  {
    "objectID": "pages/r_homework.html#introduction",
    "href": "pages/r_homework.html#introduction",
    "title": "Homework for the week 4 lab: R basics",
    "section": "1 Introduction",
    "text": "1 Introduction\nThis homework is intended to get you introduce you to the basics of R & RStudio, because the week 4 lab will involve using R for RNA-Seq data analysis. As such, this is mostly intended for those with little to no experience with R, but:\n\nEven if you‚Äôve worked with R before, at least glance over all material to make sure you‚Äôre familiar with all of it\nEveryone should install several R packages in RStudio at the Ohio Supercomputer Center (OSC) ‚Äì section 8\n\n\n\n\n\n\n\nIf you run out of steam or time while trying to do this homework, you can stop after section 10 (R objects). But we will see examples of the topics covered in section 11-13 in the week 4 lab.\n\n\n\nIf you run into any issues when going through this material, or have questions, don‚Äôt hesitate to email Jelmer.\n\n1.1 Learning objectives\nIn this session, you will learn:\n\nThe RStudio layout and the functions of the different panes and tabs\nThe basics of interacting with R by using R as a calculator\nCreating objects in R, and assigning values/data to them\nCalling functions\nGetting help\nInstalling and loading packages\nData structures like vectors and data frames\nThe basics of the tidyverse packages, including piping with |&gt;"
  },
  {
    "objectID": "pages/r_homework.html#r-and-rstudio",
    "href": "pages/r_homework.html#r-and-rstudio",
    "title": "Homework for the week 4 lab: R basics",
    "section": "2 R and RStudio",
    "text": "2 R and RStudio\n\n2.1 Why use R?\nAfter initial processing high-throughput sequencing (HTS) data such as with command-line tools in the Unix shell, you‚Äôll often want to perform statistical analysis and visualization of the results. The R language is probably the best environment for this.\nOn top of that, R is a great all-round tool to perform the analysis and visualization of any kind of data ‚Äî together with Python, it is the leading data science language. Because it is free, open-source, cross-platform, and works with code rather than a graphical user interface (GUI), using R also helps with reproducibility of your research.\n\n\n2.2 R vs.¬†RStudio\nTo run R, all you need is the R program with its ‚Äúconsole‚Äù where you type commands. However, we will be running R inside a fancy editor called RStudio, which makes working with R much more pleasant!"
  },
  {
    "objectID": "pages/r_homework.html#start-an-rstudio-session-at-osc",
    "href": "pages/r_homework.html#start-an-rstudio-session-at-osc",
    "title": "Homework for the week 4 lab: R basics",
    "section": "3 Start an RStudio session at OSC",
    "text": "3 Start an RStudio session at OSC\nWhile you can install and use R and RStudio on your own computer, for this course, you will use RStudio at OSC: you can run a version of RStudio at OSC within your browser by starting an Interactive App through OnDemand.\n\nLog in to OSC‚Äôs OnDemand portal at https://ondemand.osc.edu\nIn the blue top bar, select Interactive Apps and at the bottom, click RStudio Server\nFill out the form as follows:\n\nCluster: cardinal\nR version: 4.4.0\nProject: PAS2880\nNumber of hours: 3\nNode type: any\nNumber of cores: 1\n\nClick Launch\nClick the Connect to RStudio Server button once it appears\n\n\n\n\n\n\n\nIf you run out of time for this session, or want to spread this homework across multiple short sessions: you can always start a new session for as many sessions as you want, and you can modify the number of hours in the form as you see fit."
  },
  {
    "objectID": "pages/r_homework.html#orienting-to-rstudio",
    "href": "pages/r_homework.html#orienting-to-rstudio",
    "title": "Homework for the week 4 lab: R basics",
    "section": "4 Orienting to RStudio",
    "text": "4 Orienting to RStudio\nRStudio is divided into four panes, each of which have multiple tabs ‚Äì we will highlight the most important ones here:\n\nTop left: Source (or Editor)\nHere, you can open and edit text documents like scripts (May be missing if you don‚Äôt have any documents open ‚Äì if so, we‚Äôll make it appear later)\nBottom left: Console\nHere, you can type and execute R code\nTop right: Workspace\nThe default Environment tab shows you what you have loaded in your R environment\nBottom right: View\nThe default tab in this pane is ‚ÄúFiles‚Äù, a file explorer. Also commonly used are e.g.¬†Plots, where plots appear, and Help, for help info.\n\n\n\n\nA screenshot showing the four main RStudio panes"
  },
  {
    "objectID": "pages/r_homework.html#r-basics",
    "href": "pages/r_homework.html#r-basics",
    "title": "Homework for the week 4 lab: R basics",
    "section": "5 R basics",
    "text": "5 R basics\n\n5.1 R as calculator\nTo get some familiarity with working in R, you will start by simply using R as calculator. Type 5 + 5 in the console and press Enter:\n\n5 + 5\n\n[1] 10\n\n\nR will print the result of the calculation, 10. The result is prefaced by [1], which is simply an index/count of output items ‚Äì this can be helpful when many items are printed.\nA couple more examples:\n\n# Multiplication\n6 * 8\n\n[1] 48\n\n# Division\n40 / 5\n\n[1] 8\n\n\n\n\n\n\n\n\nThis code will work with (like shown above) or without spaces between numbers and around operators like +. However, it is good practice to leave space between the number to improve the readability of your code.\n\n\n\n\n\n5.2 The R prompt\nThe &gt; sign in your console is the R prompt, indicating that that R is ready for you to type something. In other words, this is equivalent to the $ Shell prompt you‚Äôve seen in the week 3 lab.\nWhen you are not seeing the prompt, R is either busy (because you asked it to do a longer-running computation) or waiting for you to complete an incomplete command. If you notice that your prompt turned into a +, you typed an incomplete command ‚Äì for example:\n\n10 /\n\n+\nYou can either try to finish the command or abort it by pressing Ctrl+C or Esc ‚Äì go ahead and practice the latter now to get your prompt back after the above command.\n\n\n\n\n\n\nAdding comments to your code\n\n\n\nComments in R are also just like in the Unix shell: you can use # signs to comment your code, both inline and on separate lines:\n\n# This line is entirely ignored by R\n10 / 5  # This line contains code but everything after the '#' is ignored\n\n[1] 2\n\n\n\n\n\n\n5.3 Comparing things\nIn R, you can use comparison operators to compare numbers. When you do this, R will return either FALSE or TRUE (the so-called logical data type). For example:\n\nGreater than and less than:\n\n8 &gt; 3\n\n[1] TRUE\n\n2 &lt; 1\n\n[1] FALSE\n\n\nEqual to or not equal to ‚Äì note that you need to use two equals signs == for the former:\n\n7 == 7\n\n[1] TRUE\n\n# The exclamation mark in general is a \"negator\"\n10 != 5\n\n[1] TRUE\n\n\n\nYou will commonly use these types of comparisons to check and subset/filter your data."
  },
  {
    "objectID": "pages/r_homework.html#functions-in-r",
    "href": "pages/r_homework.html#functions-in-r",
    "title": "Homework for the week 4 lab: R basics",
    "section": "6 Functions in R",
    "text": "6 Functions in R\nTo do almost anything in R, you will use ‚Äúfunctions‚Äù, which are the equivalent of Unix commands. R has over 3,000 functions that serve many different purposes.\n\n6.1 Basics of functions\nYou can recognize function calls by the parentheses. For example:\n\nThe equivalent to the Shell‚Äôs pwd is getwd() for ‚Äúget working dir‚Äù:\n\n# You will see a different output depending on your working directory\ngetwd()\n\n/users/PAS2880/jelmer\nInside those parentheses, you can provide arguments to a function1. For example, using setwd(), the equivalent to the Shell‚Äôs cd, to set your working dir, the argument is the file path to set as working dir:\n\nsetwd(\"/fs/scratch/PAS2880/ENT6703\")\n\n\n\n\n\n\n\nNote that unlike in the Shell, you need to quote (\"..\") the file path! This is because in R, anything non-numeric that is not quoted is supposed to be a pre-existing ‚Äúobject‚Äù ‚Äì more on those in a bit.\n\n\n\n\n\n\n6.2 Function arguments\nConsider the example below, where you pass the argument 6.53 to the function round():\n\nround(6.53)\n\n[1] 7\n\n\nIn most functions, including round(), arguments have names that can be used. The argument to round(), which represents the number to be rounded, has the name x, so you can also use:\n\n# This is equivalent to the above:\nround(x = 6.53)\n\n[1] 7\n\n\nNaming arguments is helpful in particular to avoid confusion when you pass multiple arguments to a function. For example, round() accepts a second argument, which is the number of digits to round to:\n\nround(x = 6.53, digits = 1)\n\n[1] 6.5\n\n\nYou could choose not to name these arguments, but that is not as easy to understand for someone reading your code ‚Äì such as yourself two months later! 2\n\n\n\n\n\n\nYou can usually see which arguments a function takes by pausing after your type the function and its parenthesis, e.g.¬†round():\n\n\n\n\n\nBelow, you‚Äôll also learn about ways to get more extensive help information about a function."
  },
  {
    "objectID": "pages/r_homework.html#r-help-help-and",
    "href": "pages/r_homework.html#r-help-help-and",
    "title": "Homework for the week 4 lab: R basics",
    "section": "7 R Help: help() and ?",
    "text": "7 R Help: help() and ?\nSo how can you know what a function does, and which arguments it takes? The help() function and ? help operator in R offer access to documentation pages for R functions ‚Äì as well as built-in data sets and other objects. For example:\n?getwd\nThe output should appear in the Help tab of the bottom-left panel in RStudio and look something like this:\n\n\n\nThe R help output for the getwd() function\n\n\nYou can also search for Help pages in that same RStudio Help tab."
  },
  {
    "objectID": "pages/r_homework.html#r-packages",
    "href": "pages/r_homework.html#r-packages",
    "title": "Homework for the week 4 lab: R basics",
    "section": "8 R packages",
    "text": "8 R packages\nR packages are basically add-ons or extensions to the functionality of the R language. These need to installed and loaded:\n\nThe function install.packages() installs an R package. This is a one-time operation ‚Äì you won‚Äôt need to reinstall a package when you start a new R session later3.\nThe function library() will load an R package in your current R session. Every time you want to use a package in R, you need to load it ‚Äì just like everytime you want to use MS Word on your computer, you need to open it.\n\nTo practice with this, you will now install several packages you‚Äôll need in next week‚Äôs lab. Note that:\n\nUnfortunately, on OSC, packages installation can take a while. Especially for large packages like these, so please be patient4.\nA lot of messages may be printed to the console when installation is ongoing. Installation of a package is done when you get your prompt back. Unless you see clear messages that include words like ‚ÄúError‚Äù and ‚ÄúFailed‚Äù, it should have succeeded (‚ÄúWarning‚Äùs are typically okay).\nBesides install.packages(), you‚Äôll also use the BiocManager::install() function from to install some packages from Bioconductor, a separate repository that hosts many bioinformatics/omics-related R packages.\n\n\n# Run these lines one-by-one to install the needed packages --\n# First, the tidyverse, which is discussed at the end of this homework\ninstall.packages(\"tidyverse\")\n\n# [... lots of output ...]\n# [The last lines should look something like this:]\n** testing if installed package can be loaded from temporary location\n** testing if installed package can be loaded from final location\n** testing if installed package keeps a record of temporary installation path\n* DONE (tidyverse)\n\nThe downloaded source packages are in\n    ‚Äò/tmp/RtmpS4n222/downloaded_packages‚Äô\n\n# This is needed to in turn install the next two packages:\n# (Should take &lt;1 minute to install)\ninstall.packages(\"BiocManager\")\n\n\n# We will use this for differential expression analysis:\n# (May take 5-10 minutes to install)\nBiocManager::install(\"DESeq2\")\n\n\n# We will use this to create a data visualization called a volcano plot:\n# (Should take &lt;1 minute to install)\nBiocManager::install(\"EnhancedVolcano\")\n\nTest that you can load the packages ‚Äì see the expected output below:\n\nlibrary(EnhancedVolcano)\n\nLoading required package: ggplot2\n\n\nLoading required package: ggrepel\n\n\n\nlibrary(DESeq2)\n\n\n\nClick here to see the expected output when loading the ‚ÄòDESeq2‚Äô package\n\n\nlibrary(DESeq2)\n\nLoading required package: S4Vectors\n\n\nLoading required package: stats4\n\n\nLoading required package: BiocGenerics\n\n\nLoading required package: generics\n\n\n\nAttaching package: 'generics'\n\n\nThe following objects are masked from 'package:base':\n\n    as.difftime, as.factor, as.ordered, intersect, is.element, setdiff,\n    setequal, union\n\n\n\nAttaching package: 'BiocGenerics'\n\n\nThe following objects are masked from 'package:stats':\n\n    IQR, mad, sd, var, xtabs\n\n\nThe following objects are masked from 'package:base':\n\n    anyDuplicated, aperm, append, as.data.frame, basename, cbind,\n    colnames, dirname, do.call, duplicated, eval, evalq, Filter, Find,\n    get, grep, grepl, is.unsorted, lapply, Map, mapply, match, mget,\n    order, paste, pmax, pmax.int, pmin, pmin.int, Position, rank,\n    rbind, Reduce, rownames, sapply, saveRDS, table, tapply, unique,\n    unsplit, which.max, which.min\n\n\n\nAttaching package: 'S4Vectors'\n\n\nThe following object is masked from 'package:utils':\n\n    findMatches\n\n\nThe following objects are masked from 'package:base':\n\n    expand.grid, I, unname\n\n\nLoading required package: IRanges\n\n\nLoading required package: GenomicRanges\n\n\nLoading required package: GenomeInfoDb\n\n\nLoading required package: SummarizedExperiment\n\n\nLoading required package: MatrixGenerics\n\n\nLoading required package: matrixStats\n\n\n\nAttaching package: 'MatrixGenerics'\n\n\nThe following objects are masked from 'package:matrixStats':\n\n    colAlls, colAnyNAs, colAnys, colAvgsPerRowSet, colCollapse,\n    colCounts, colCummaxs, colCummins, colCumprods, colCumsums,\n    colDiffs, colIQRDiffs, colIQRs, colLogSumExps, colMadDiffs,\n    colMads, colMaxs, colMeans2, colMedians, colMins, colOrderStats,\n    colProds, colQuantiles, colRanges, colRanks, colSdDiffs, colSds,\n    colSums2, colTabulates, colVarDiffs, colVars, colWeightedMads,\n    colWeightedMeans, colWeightedMedians, colWeightedSds,\n    colWeightedVars, rowAlls, rowAnyNAs, rowAnys, rowAvgsPerColSet,\n    rowCollapse, rowCounts, rowCummaxs, rowCummins, rowCumprods,\n    rowCumsums, rowDiffs, rowIQRDiffs, rowIQRs, rowLogSumExps,\n    rowMadDiffs, rowMads, rowMaxs, rowMeans2, rowMedians, rowMins,\n    rowOrderStats, rowProds, rowQuantiles, rowRanges, rowRanks,\n    rowSdDiffs, rowSds, rowSums2, rowTabulates, rowVarDiffs, rowVars,\n    rowWeightedMads, rowWeightedMeans, rowWeightedMedians,\n    rowWeightedSds, rowWeightedVars\n\n\nLoading required package: Biobase\n\n\nWelcome to Bioconductor\n\n    Vignettes contain introductory material; view with\n    'browseVignettes()'. To cite Bioconductor, see\n    'citation(\"Biobase\")', and for packages 'citation(\"pkgname\")'.\n\n\n\nAttaching package: 'Biobase'\n\n\nThe following object is masked from 'package:MatrixGenerics':\n\n    rowMedians\n\n\nThe following objects are masked from 'package:matrixStats':\n\n    anyMissing, rowMedians\n\n\n\n\nlibrary(tidyverse)\n\n‚îÄ‚îÄ Attaching core tidyverse packages ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ tidyverse 2.0.0 ‚îÄ‚îÄ\n‚úî dplyr     1.1.4     ‚úî readr     2.1.5\n‚úî forcats   1.0.1     ‚úî stringr   1.5.2\n‚úî lubridate 1.9.4     ‚úî tibble    3.3.0\n‚úî purrr     1.1.0     ‚úî tidyr     1.3.1\n‚îÄ‚îÄ Conflicts ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ tidyverse_conflicts() ‚îÄ‚îÄ\n‚úñ lubridate::%within%()    masks IRanges::%within%()\n‚úñ dplyr::collapse()        masks IRanges::collapse()\n‚úñ dplyr::combine()         masks Biobase::combine(), BiocGenerics::combine()\n‚úñ dplyr::count()           masks matrixStats::count()\n‚úñ dplyr::desc()            masks IRanges::desc()\n‚úñ tidyr::expand()          masks S4Vectors::expand()\n‚úñ dplyr::filter()          masks stats::filter()\n‚úñ dplyr::first()           masks S4Vectors::first()\n‚úñ dplyr::lag()             masks stats::lag()\n‚úñ BiocGenerics::Position() masks ggplot2::Position(), base::Position()\n‚úñ purrr::reduce()          masks GenomicRanges::reduce(), IRanges::reduce()\n‚úñ dplyr::rename()          masks S4Vectors::rename()\n‚úñ lubridate::second()      masks S4Vectors::second()\n‚úñ lubridate::second&lt;-()    masks S4Vectors::second&lt;-()\n‚úñ dplyr::slice()           masks IRanges::slice()\n‚Ñπ Use the conflicted package (&lt;http://conflicted.r-lib.org/&gt;) to force all conflicts to become errors\n\n\n\n\n\n\n\n\nFor now, don‚Äôt worry about the ‚Äúconflict‚Äù warnings shown above."
  },
  {
    "objectID": "pages/r_homework.html#r-scripts",
    "href": "pages/r_homework.html#r-scripts",
    "title": "Homework for the week 4 lab: R basics",
    "section": "9 R scripts",
    "text": "9 R scripts\nYou should mostly write and save your R code in so-called ‚ÄúR scripts‚Äù, which are text files with R code. This helps keep track of what you‚Äôve been doing and makes it easier to modify and rerun things.\n\nCreate and open a new R script by clicking File (top menu bar) &gt; New File &gt; R Script.\nSave this new script right away by clicking File &gt; Save As. In the dialog box, you can save it right in the suggested folder, or you can make a new folder for this course. Regardless, save the script as homework.R (the extension for R scripts is .R).\n\nBut isn‚Äôt a hassle to have to copy-paste code from a script to the console? Well, RStudio makes this pretty easy: to execute code from the script in the the console, press Ctrl + Enter on Windows, or Cmd + Return on a Mac. Practice that after typing the following in the script:\n\n# Type this in the script, then run it with Ctrl + Enter (or Cmd + Return)\n5 + 5\n\n[1] 10"
  },
  {
    "objectID": "pages/r_homework.html#r-objects",
    "href": "pages/r_homework.html#r-objects",
    "title": "Homework for the week 4 lab: R basics",
    "section": "10 R objects",
    "text": "10 R objects\nObjects are a key concept in R and other programming languages. They can store data and values that you can manipulate and analyze. It takes some time to get used to working with -and conceptualizing- objects, but you will get the hang of it with some practice.\n\n10.1 Assigning stuff to objects\nYou can assign one or more values to a so-called ‚Äúobject‚Äù with the assignment operator &lt;-:\n\n# Assign the value 250 the object 'length_cm':\nlength_cm &lt;- 250\n\n# Now print the value of this object to screen simply by typing its name:\nlength_cm\n\n[1] 250\n\n\nAnother example:\n\nconversion &lt;- 2.54\nconversion\n\n[1] 2.54\n\n\nImportantly, you can use objects as if you had typed their values directly:\n\nlength_cm / conversion\n\n[1] 98.4252\n\n\n\n\n10.2 Object names\nSome pointers on object names:\n\nBecause R is case sensitive, length_inch is different from Length_Inch!\nAn object name cannot contain spaces ‚Äî so for readability, you can for example separate words e.g.¬†using underscores, as in length_cm.\nObject names can contain but cannot start with a number: x2 is valid but 2x is not.\nMake object names descriptive yet not too long ‚Äî this is not always easy!\n\n\n Exercise: Assigning objects in R\n\nAssign the value 20 to the object num_1, and the value 15 to num_2\n\n\nClick to see the solution\n\n\nnum_1 &lt;- 20\nnum_2 &lt;- 15\n\n\nCompute the sum of num_1 and num_2\n\n\nClick to see the solution\n\n\nnum_1 + num_2\n\n[1] 35\n\n\n\nAssign the result of num_1 minus num_2 to a new object called difference. What is the value of difference?\n\n\nClick to see a solution\n\n\ndifference &lt;- num_1 - num_2\ndifference\n\n[1] 5\n\n\n\nWhich of the following are valid object names in R?\n\n2nd_value\n\nvalue_2\n\ntotal value\nTotalValue\n\n\n\nClick to see a solution\n\nThe valid object names are:\n\nvalue_2\nTotalValue\n\nObject names cannot start with a number and cannot contain spaces (so a and c options are invalid)."
  },
  {
    "objectID": "pages/r_homework.html#vectors",
    "href": "pages/r_homework.html#vectors",
    "title": "Homework for the week 4 lab: R basics",
    "section": "11 Vectors",
    "text": "11 Vectors\nR has several so-called ‚Äúdata structures‚Äù, distinct object types to store different kinds of data. The most basic of these is the vector, which is simply a collections of one or more items.\n\n11.1 Creating vectors\nYou‚Äôve already created a few vectors, as the single-item num_1 etc. objects above were vectors! So let‚Äôs see something new here: a common way to make vectors with multiple elements is with the c (combine) function:\n\n# longer_vector will contain 3 items:\nlonger_vector &lt;- c(10, 20, 30)\nlonger_vector\n\n[1] 10 20 30\n\n\nFor ranges of integers (whole numbers), you can also use the colon operator :\n\n# longer_vector will contain 10 items:\nsequence_vector &lt;- 1:10\nsequence_vector\n\n [1]  1  2  3  4  5  6  7  8  9 10\n\n\n\n\n11.2 Exploring vectors\nR has many functions that provide information about vectors and other types of objects, such as to get the number of items, or the mean or sum of the values of these items5:\n\n# Get the number of items:\nlength(longer_vector)\n\n[1] 3\n\n# Get the the mean (average) across all elements:\nmean(longer_vector)\n\n[1] 20\n\n# Get the sum of all elements:\nsum(longer_vector)\n\n[1] 60\n\n\n\n\n11.3 Extracting elements from vectors\nYou can extract items from objects like vectors using ‚Äúbracket notation‚Äù ‚Äì get the second item with [2]:\n\nlonger_vector[2]\n\n[1] 20\n\n\nOr get the first and third items with [c(1, 3)]:\n\nlonger_vector[c(1, 3)]\n\n[1] 10 30"
  },
  {
    "objectID": "pages/r_homework.html#data-frames",
    "href": "pages/r_homework.html#data-frames",
    "title": "Homework for the week 4 lab: R basics",
    "section": "12 Data frames",
    "text": "12 Data frames\nData frames are a key R data structure that contain tabular data ‚Äì data organized in rows and columns, similar to spreadsheets. An example is the iris data frame that comes shipped with R, which contains measurements for three different species of iris.\nYou can take a look at the first few rows of this data frame using the head() function:\n\n# Note that each row represents one individual iris flower:\nhead(iris)\n\n  Sepal.Length Sepal.Width Petal.Length Petal.Width Species\n1          5.1         3.5          1.4         0.2  setosa\n2          4.9         3.0          1.4         0.2  setosa\n3          4.7         3.2          1.3         0.2  setosa\n4          4.6         3.1          1.5         0.2  setosa\n5          5.0         3.6          1.4         0.2  setosa\n6          5.4         3.9          1.7         0.4  setosa\n\n\n\n\nHow many columns does this data frame have?(Click for the solution)\n\nThis data frame has 5 columns: Sepal.Length, Sepal.Width, Petal.Length, Petal.Width, and Species. The 1 to 6 on the left are the row names, in this case a simple numbering of the rows.\n\nFor data frames, the View() function is also neat, as it opens the data frame in a spreadsheet-like viewer ‚Äì try it!\n\nView(iris)\n\nYou can extract individual columns from a data frame using the $ operator:\n\n# Extract the 'Sepal.Width' column from the 'iris' data frame:\niris$Sepal.Width\n\n  [1] 3.5 3.0 3.2 3.1 3.6 3.9 3.4 3.4 2.9 3.1 3.7 3.4 3.0 3.0 4.0 4.4 3.9 3.5\n [19] 3.8 3.8 3.4 3.7 3.6 3.3 3.4 3.0 3.4 3.5 3.4 3.2 3.1 3.4 4.1 4.2 3.1 3.2\n [37] 3.5 3.6 3.0 3.4 3.5 2.3 3.2 3.5 3.8 3.0 3.8 3.2 3.7 3.3 3.2 3.2 3.1 2.3\n [55] 2.8 2.8 3.3 2.4 2.9 2.7 2.0 3.0 2.2 2.9 2.9 3.1 3.0 2.7 2.2 2.5 3.2 2.8\n [73] 2.5 2.8 2.9 3.0 2.8 3.0 2.9 2.6 2.4 2.4 2.7 2.7 3.0 3.4 3.1 2.3 3.0 2.5\n [91] 2.6 3.0 2.6 2.3 2.7 3.0 2.9 2.9 2.5 2.8 3.3 2.7 3.0 2.9 3.0 3.0 2.5 2.9\n[109] 2.5 3.6 3.2 2.7 3.0 2.5 2.8 3.2 3.0 3.8 2.6 2.2 3.2 2.8 2.8 2.7 3.3 3.2\n[127] 2.8 3.0 2.8 3.0 2.8 3.8 2.8 2.8 2.6 3.0 3.4 3.1 3.0 3.1 3.1 3.1 2.7 3.2\n[145] 3.3 3.0 2.5 3.0 3.4 3.0\n\n\nThis kind of operation will return a vector ‚Äì which can be subsetted as well:\n\n# Extract the 2nd to 5th items from the 'Sepal.Width' column:\niris$Sepal.Width[2:5]\n\n[1] 3.0 3.2 3.1 3.6"
  },
  {
    "objectID": "pages/r_homework.html#a-brief-introduction-to-the-tidyverse-and-pipes",
    "href": "pages/r_homework.html#a-brief-introduction-to-the-tidyverse-and-pipes",
    "title": "Homework for the week 4 lab: R basics",
    "section": "13 A brief introduction to the tidyverse and pipes",
    "text": "13 A brief introduction to the tidyverse and pipes\nFinally, you‚Äôll learn a little about a versatile family of R packages designed for data science called the ‚Äútidyverse‚Äù. The tidyverse is quite large and includes the famous ggplot2 package for data visualization ‚Äì we‚Äôll barely scratch the surface here, but this should already give you some useful tools.\n\n13.1 read_tsv() to read tabular data\nThe read_tsv() function reads a TSV (Tab-Separated Values) file into a dataframe, taking the path to the file as its main argument ‚Äì here, read the sample metadata file used in next week‚Äôs lab:\n\nmeta &lt;- read_tsv(\"/fs/scratch/PAS2880/ENT6703/data/meta/metadata.tsv\")\n\n\n\nRows: 22 Columns: 3\n‚îÄ‚îÄ Column specification ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ\nDelimiter: \"\\t\"\nchr (2): sample_id, treatment\ndbl (1): dpi\n\n‚Ñπ Use `spec()` to retrieve the full column specification for this data.\n‚Ñπ Specify the column types or set `show_col_types = FALSE` to quiet this message.\n\n\nSome info about how it interpreted the data is printed, especially about the data types of different columns (see the box below). Take a look at the resulting data frame meta:\n\nmeta\n\n# A tibble: 22 √ó 3\n   sample_id     dpi treatment  \n   &lt;chr&gt;       &lt;dbl&gt; &lt;chr&gt;      \n 1 ERR10802864     1 cathemerium\n 2 ERR10802867     1 cathemerium\n 3 ERR10802870     1 cathemerium\n 4 ERR10802866     1 control    \n 5 ERR10802869     1 control    \n 6 ERR10802863     1 control    \n 7 ERR10802871     1 relictum   \n 8 ERR10802874     1 relictum   \n 9 ERR10802865     1 relictum   \n10 ERR10802868     1 relictum   \n# ‚Ñπ 12 more rows\n\n\n\n\n\n\n\n\nTibble??\n\n\n\nThe data frame is a so-called ‚Äútibble‚Äù, as the top of the output above says. This is a modern take on data frames provided by the tidyverse. Tibbles behave mostly like data frames, but have some nice features mostly in the way they are printed to screen.\nFor example, the ‚Äúdata types‚Äù of columns are shown at the top of the output above, where chr means character (text data) and dbl means double (numeric data; other data types exist as well).\n\n\n\n\n13.2 select() to pick columns\nThe select() function subsets a data frame by including/excluding certain columns. By default, it only includes the columns you specify:\n\nselect(.data = meta, sample_id, treatment)\n\n# A tibble: 22 √ó 2\n   sample_id   treatment  \n   &lt;chr&gt;       &lt;chr&gt;      \n 1 ERR10802864 cathemerium\n 2 ERR10802867 cathemerium\n 3 ERR10802870 cathemerium\n 4 ERR10802866 control    \n 5 ERR10802869 control    \n 6 ERR10802863 control    \n 7 ERR10802871 relictum   \n 8 ERR10802874 relictum   \n 9 ERR10802865 relictum   \n10 ERR10802868 relictum   \n# ‚Ñπ 12 more rows\n\n\nAbove, the first argument was the data frame, whereas the other arguments were the (unquoted!) names of columns to be kept. The output is a new, modified dataframe. In the example above, this data frame was simply printed to the screen ‚Äì but as you‚Äôll see later, it can be stored too.\n\n\n13.3 filter() to pick rows (observations)\nThe filter() function outputs only those rows that satisfy one or more conditions, similar to Filter functionality in Excel. For example, to only keep rows for the 1 timepoint:\n\nfilter(.data = meta, dpi == 1)\n\n# A tibble: 10 √ó 3\n   sample_id     dpi treatment  \n   &lt;chr&gt;       &lt;dbl&gt; &lt;chr&gt;      \n 1 ERR10802864     1 cathemerium\n 2 ERR10802867     1 cathemerium\n 3 ERR10802870     1 cathemerium\n 4 ERR10802866     1 control    \n 5 ERR10802869     1 control    \n 6 ERR10802863     1 control    \n 7 ERR10802871     1 relictum   \n 8 ERR10802874     1 relictum   \n 9 ERR10802865     1 relictum   \n10 ERR10802868     1 relictum   \n\n\n\n\n13.4 The pipe (|&gt;)\nIt‚Äôs common to want to use several consecutive functions to wrangle a dataframe into the format you want. For example, you may want to first select() one or more columns, then filter() the resulting dataframe. You could do that as follows:\n\nmeta_sel &lt;- select(.data = meta, sample_id, dpi)\nfilter(.data = meta_sel, dpi == 1)\n\n# A tibble: 10 √ó 2\n   sample_id     dpi\n   &lt;chr&gt;       &lt;dbl&gt;\n 1 ERR10802864     1\n 2 ERR10802867     1\n 3 ERR10802870     1\n 4 ERR10802866     1\n 5 ERR10802869     1\n 6 ERR10802863     1\n 7 ERR10802871     1\n 8 ERR10802874     1\n 9 ERR10802865     1\n10 ERR10802868     1\n\n\nYou could go on along these lines, successively creating new objects that you then use for the next step. But there is a more elegant way of dong this, directly sending (‚Äúpiping‚Äù) output from one function into the next function with the pipe operator |&gt; (a vertical bar | followed by a greater-than sign &gt;).\nLet‚Äôs start by seeing a reformulation of the code above with pipes:\n\nmeta |&gt;\n  select(sample_id, dpi) |&gt;\n  filter(dpi == 1)\n\n# A tibble: 10 √ó 2\n   sample_id     dpi\n   &lt;chr&gt;       &lt;dbl&gt;\n 1 ERR10802864     1\n 2 ERR10802867     1\n 3 ERR10802870     1\n 4 ERR10802866     1\n 5 ERR10802869     1\n 6 ERR10802863     1\n 7 ERR10802871     1\n 8 ERR10802874     1\n 9 ERR10802865     1\n10 ERR10802868     1\n\n\nWhat happened here? You took the meta data frame, sent (‚Äúpiped‚Äù) it into the select() function, whose output in turn was piped into the filter() function. You can think of the pipe as ‚Äúthen‚Äù: take meta, then select, then rename.\nWhen using the pipe, you no longer specify the input with the .data argument, because the function now gets its input data via the pipe. Using pipes involves less typing and is more readable than successive assignments.\n\n\n\n\n\n\nFor code readability, start a new line after every pipe |&gt; and indent subsequent lines, as seen above.\n\n\n\n\n Exercise: Tidyverse functions and pipes\nUse a ‚Äúpipeline‚Äù like above to output a data frame with two columns (sample_id and treatment) only for the cathemerium treatment. How many rows does your output data frame have?\n\n\nClick for the solution\n\n\nmeta |&gt;\n  select(sample_id, treatment) |&gt;\n  filter(treatment == \"cathemerium\")\n\n# A tibble: 7 √ó 2\n  sample_id   treatment  \n  &lt;chr&gt;       &lt;chr&gt;      \n1 ERR10802864 cathemerium\n2 ERR10802867 cathemerium\n3 ERR10802870 cathemerium\n4 ERR10802882 cathemerium\n5 ERR10802875 cathemerium\n6 ERR10802879 cathemerium\n7 ERR10802883 cathemerium\n\n\nThe output data frame has 7 rows and 2 columns: note that ‚Äú7 x 2‚Äù is helpfully shown at the top of the output in the console.\n\n\n\n\n\n\n\n\nOptional: Using the pipe keyboard shortcut (Click to expand)\n\n\n\n\n\nThe following RStudio keyboard shortcut will insert a pipe symbol: Ctrl/Cmd + Shift + M.\nHowever, by default this (still) inserts an older pipe symbol, %&gt;%. To make RStudio insert the |&gt; pipe symbol with this keyboard shortcut:\n\nClick Tools &gt; Global Options &gt; Code tab on the right\nCheck the box ‚ÄúUse native pipe operator‚Äù as shown below\nClick OK at the bottom of the options dialog box to apply the change and close the box."
  },
  {
    "objectID": "pages/r_homework.html#footnotes",
    "href": "pages/r_homework.html#footnotes",
    "title": "Homework for the week 4 lab: R basics",
    "section": "Footnotes",
    "text": "Footnotes\n\n\n In R, there is no distinction between options and arguments like with Shell commands.‚Ü©Ô∏é\n And unlike unnamed arguments, named arguments can be presented in any order you like.‚Ü©Ô∏é\nThis also applies at OSC‚Ü©Ô∏é\n This should be much faster on your own computer.‚Ü©Ô∏é\nThe latter two only with numeric vectors - as vectors can also contain text.‚Ü©Ô∏é"
  },
  {
    "objectID": "pages/sequencing.html#what-do-we-mean-by-sequencing",
    "href": "pages/sequencing.html#what-do-we-mean-by-sequencing",
    "title": "High-throughput sequencing and genomes",
    "section": "What do we mean by sequencing?",
    "text": "What do we mean by sequencing?\n\n\nWhat does the term sequencing, like in ‚Äúhigh-throughput sequencing‚Äù, generally refer to? ¬† \n\nDetermining the sequence of DNA, RNA, or protein fragments.\nMost commonly, especially in ‚Äúhigh-throughput‚Äù sequencing, it refers to DNA sequencing specifically.\n\n\n\nThis week and next, we will focus on DNA sequencing, keeping in mind that:\n\nProtein sequencing involves completely different technologies\n\n\n\n\nRNA can be, and usually is, sequenced as DNA as well\n\n\nHow is that done and why? ¬† \n\nRNA is usually reverse transcribed to DNA (cDNA) prior to sequencing.\nWhile it is becoming more feasible to directly sequence RNA molecules, RNA is an unstable molecule that is easily degraded and harder to sequence."
  },
  {
    "objectID": "pages/sequencing.html#overview-of-sequencing-technologies",
    "href": "pages/sequencing.html#overview-of-sequencing-technologies",
    "title": "High-throughput sequencing and genomes",
    "section": "Overview of sequencing technologies",
    "text": "Overview of sequencing technologies\n\n\nSanger sequencing (since ~1985)\nSequences a single, typically PCR-amplified, short-ish (‚â§900 bp) DNA fragment at a time\n\n\n\nHigh-throughput sequencing (HTS)\nSequences 105-109, usually randomly selected, DNA fragments at a time ‚Äî two types:\n\nShort-read HTS: More accurate, shorter reads (since 2005)\nLong-read HTS: Less accurate, longer reads (since 2011)\n\n\n\n\n\n\n\n\n\n\n\nThese sequenced fragments of DNA are usually called reads"
  },
  {
    "objectID": "pages/sequencing.html#sanger-sequencing",
    "href": "pages/sequencing.html#sanger-sequencing",
    "title": "High-throughput sequencing and genomes",
    "section": "Sanger sequencing",
    "text": "Sanger sequencing\n\nSanger sequencing almost always starts with PCR amplification of the target DNA region ‚Äî\nas illustrated by Dr.¬†Popp last week:\n\n\n\n\n\n\n\nTherefore, to design primers, you must know something about the target sequence in advance ‚Äî this can be highly limiting"
  },
  {
    "objectID": "pages/sequencing.html#sanger-sequencing-1",
    "href": "pages/sequencing.html#sanger-sequencing-1",
    "title": "High-throughput sequencing and genomes",
    "section": "Sanger sequencing",
    "text": "Sanger sequencing\n\nSequencing itself is performed by synthesizing a new DNA strand with fluorescently-labeled nucleotides, using a different color for each base (A, C, G, T)\n\n\n\n\nThe final result is a chromatogram that can be ‚Äúbase-called‚Äù:\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nThe entire human genome was sequenced with Sanger technology!\n\n\nHow many basepairs is that? Want to guess how much it cost to do this?"
  },
  {
    "objectID": "pages/sequencing.html#sequencing-cost-through-time",
    "href": "pages/sequencing.html#sequencing-cost-through-time",
    "title": "High-throughput sequencing and genomes",
    "section": "Sequencing cost through time",
    "text": "Sequencing cost through time\n\n\n\n\n\n\nhttps://www.genome.gov/about-genomics/fact-sheets/Sequencing-Human-Genome-cost"
  },
  {
    "objectID": "pages/sequencing.html#present-day-sanger-applications",
    "href": "pages/sequencing.html#present-day-sanger-applications",
    "title": "High-throughput sequencing and genomes",
    "section": "Present-day Sanger applications",
    "text": "Present-day Sanger applications\n\nBecause HTS has much higher throughput and is much cheaper per base, Sanger sequencing has become less widely used\nBut it is not obsolete, in part because high throughput isn‚Äôt always needed or even wanted"
  },
  {
    "objectID": "pages/sequencing.html#section",
    "href": "pages/sequencing.html#section",
    "title": "High-throughput sequencing and genomes",
    "section": "",
    "text": "Image generated by Adobe Firefly"
  },
  {
    "objectID": "pages/sequencing.html#present-day-sanger-applications-1",
    "href": "pages/sequencing.html#present-day-sanger-applications-1",
    "title": "High-throughput sequencing and genomes",
    "section": "Present-day Sanger applications",
    "text": "Present-day Sanger applications\nSome present-day uses of Sanger sequencing include‚Ä¶\n\nTaxonomic identification of samples\nExamining genetic variation among individuals/populations\n\n‚Ä¶where using one or few marker or candidate genes can be sufficient"
  },
  {
    "objectID": "pages/sequencing.html#omics",
    "href": "pages/sequencing.html#omics",
    "title": "High-throughput sequencing and genomes",
    "section": "Omics",
    "text": "Omics\nLet‚Äôs start with the big picture ‚Äì HTS data underlies several of these main ‚Äúomics‚Äù approaches:\n\n\n\n\n\n\nCopyright ThermoFisher"
  },
  {
    "objectID": "pages/sequencing.html#the-main-omics-data-types",
    "href": "pages/sequencing.html#the-main-omics-data-types",
    "title": "High-throughput sequencing and genomes",
    "section": "The main omics data types",
    "text": "The main omics data types\n\n\n\n\n\n\n\n\nOmics type\nMolecule type\n\n\n\n\n\nGenomics\nDNA\n\n\n\nEpigenomics\nDNA modifications\nHigh-throughput sequencing (HTS)\n\n\nTranscriptomics\nRNA\n\n\n\nProteomics\nProteins\n\n\n\nMetabolomics\nMetabolites\n\n\n\n\n\n\n\n\nWhat does the -omics suffix mean? ¬† \n\nThe ‚Äúomics‚Äù suffix indicates the involvement of large-scale datasets ‚Äî\nfor example, ‚Äúgenomics‚Äù data typically spans much or all of the genome"
  },
  {
    "objectID": "pages/sequencing.html#the-main-omics-data-types-1",
    "href": "pages/sequencing.html#the-main-omics-data-types-1",
    "title": "High-throughput sequencing and genomes",
    "section": "The main omics data types",
    "text": "The main omics data types\n\n\n\n\n\n\n\n\nOmics type\nMolecule type\nData mainly produced by\n\n\n\n\nGenomics\nDNA\nHigh-throughput sequencing (HTS)\n\n\nEpigenomics\nDNA modifications\nHigh-throughput sequencing (HTS)\n\n\nTranscriptomics\nRNA\nHigh-throughput sequencing (HTS)\n\n\nProteomics\nProteins\nMass Spectrometry\n\n\nMetabolomics\nMetabolites\nMass Spectrometry"
  },
  {
    "objectID": "pages/sequencing.html#examples-of-hts-applications",
    "href": "pages/sequencing.html#examples-of-hts-applications",
    "title": "High-throughput sequencing and genomes",
    "section": "Examples of HTS applications",
    "text": "Examples of HTS applications\n\nWhole-genome assembly ‚Äî for producing reference genomes\n\n\n\nTyping of SNPs and other sequence variants ‚Äî for population genetics, GWAS, etc.\n\n\n\n\nMetabarcoding ‚Äì for microbial community characterization\n\n\n\n\nRNA-Seq ‚Äî for large-scale gene expression analysis\n\n\n\n\n\n\nDoes any of you work on, or is planning to work on, projects like these?"
  },
  {
    "objectID": "pages/sequencing.html#examples-of-hts-applications-1",
    "href": "pages/sequencing.html#examples-of-hts-applications-1",
    "title": "High-throughput sequencing and genomes",
    "section": "Examples of HTS applications",
    "text": "Examples of HTS applications\n\nIn each of of these applications:\n\nWhat part(s) of the genome are you sequencing?\nWho are you sequencing (how many individuals/species)?\nHow are the sequences used?"
  },
  {
    "objectID": "pages/sequencing.html#examples-of-hts-applications-2",
    "href": "pages/sequencing.html#examples-of-hts-applications-2",
    "title": "High-throughput sequencing and genomes",
    "section": "Examples of HTS applications",
    "text": "Examples of HTS applications\n\n\n\n\n\n\n\n\n\n\nAppl.\nWhat\nWho\nHow\n\n\n\n\nWhole-genome assembly\nThe whole genome! üòÉ\nA single individual\n‚ÄúOverlap‚Äù reads into larger fragments\n\n\nVariants\n\n\n\n\n\n16S Metabarcoding\n\n\n\n\n\nRNA-Seq"
  },
  {
    "objectID": "pages/sequencing.html#examples-of-hts-applications-3",
    "href": "pages/sequencing.html#examples-of-hts-applications-3",
    "title": "High-throughput sequencing and genomes",
    "section": "Examples of HTS applications",
    "text": "Examples of HTS applications\n\n\n\n\n\n\n\n\n\n\nAppl.\nWhat\nWho\nHow\n\n\n\n\nWhole-genome assembly\nThe whole genome! üòÉ\nA single individual\n‚ÄúOverlap‚Äù reads into larger fragments\n\n\nVariants\nWhole genome or specific (e.g.¬†exome) or random (GBS/RAD) regions\nMultiple individuals\nFor each site & individual, determine the variant state (allele)\n\n\n16S Metabarcoding\n\n\n\n\n\nRNA-Seq"
  },
  {
    "objectID": "pages/sequencing.html#examples-of-hts-applications-4",
    "href": "pages/sequencing.html#examples-of-hts-applications-4",
    "title": "High-throughput sequencing and genomes",
    "section": "Examples of HTS applications",
    "text": "Examples of HTS applications\n\n\n\n\n\n\n\n\n\n\nAppl.\nWhat\nWho\nHow\n\n\n\n\nWhole-genome assembly\nThe whole genome! üòÉ\nA single individual\n‚ÄúOverlap‚Äù reads into larger fragments\n\n\nVariants\nWhole genome or specific (e.g.¬†exome) or random (GBS/RAD) regions\nMultiple individuals\nFor each site & individual, determine the variant state (allele)\n\n\n16S Metabarcoding\nA specific locus (e.g.¬†16S)\nMultiple samples ‚Äîcan be soil, gut contents, etc.\nAssign reads a taxonomic identity and count\n\n\nRNA-Seq"
  },
  {
    "objectID": "pages/sequencing.html#examples-of-hts-applications-5",
    "href": "pages/sequencing.html#examples-of-hts-applications-5",
    "title": "High-throughput sequencing and genomes",
    "section": "Examples of HTS applications",
    "text": "Examples of HTS applications\n\n\n\n\n\n\n\n\n\n\nAppl.\nWhat\nWho\nHow\n\n\n\n\nWhole-genome assembly\nThe whole genome! üòÉ\nA single individual\n‚ÄúOverlap‚Äù reads into larger fragments\n\n\nVariants\nWhole genome or specific (e.g.¬†exome) or random (GBS/RAD) regions\nMultiple individuals\nFor each site & individual, determine the variant state (allele)\n\n\n16S Metabarcoding\nA specific locus (e.g.¬†16S)\nMultiple samples ‚Äîcan be soil, gut contents, etc.\nAssign reads a taxonomic identity and count\n\n\nRNA-Seq\nTranscriptome\nMultiple samples across different conditions/treatments\nAssign reads a gene identity and counted"
  },
  {
    "objectID": "pages/sequencing.html#the-main-hts-technologies",
    "href": "pages/sequencing.html#the-main-hts-technologies",
    "title": "High-throughput sequencing and genomes",
    "section": "The main HTS technologies",
    "text": "The main HTS technologies\n\n\n\n\n\n\n\n\n\nShort-read HTS\nLong-read HTS\n\n\n\n\nMain companies\nIllumina\nOxford Nanopore Technologies (ONT) & Pacific Biosciences (PacBio)"
  },
  {
    "objectID": "pages/sequencing.html#the-main-hts-technologies-1",
    "href": "pages/sequencing.html#the-main-hts-technologies-1",
    "title": "High-throughput sequencing and genomes",
    "section": "The main HTS technologies",
    "text": "The main HTS technologies\n\n\n\n\n\n\n\n\n\nShort-read HTS\nLong-read HTS\n\n\n\n\nUsage\nMore\nLess (but increasing)\n\n\nMain companies\nIllumina\nOxford Nanopore Technologies (ONT) & Pacific Biosciences (PacBio)\n\n\nTimeline\nSince 2005 ‚Äî technology fairly stable\nSince 2011 ‚Äî still rapid development"
  },
  {
    "objectID": "pages/sequencing.html#the-main-hts-technologies-2",
    "href": "pages/sequencing.html#the-main-hts-technologies-2",
    "title": "High-throughput sequencing and genomes",
    "section": "The main HTS technologies",
    "text": "The main HTS technologies\n\n\n\n\n\n\n\n\n\nShort-read HTS\nLong-read HTS\n\n\n\n\nUsage\nMore\nLess (but increasing)\n\n\nMain companies\nIllumina\nOxford Nanopore Technologies (ONT) & Pacific Biosciences (PacBio)\n\n\nTimeline\nSince 2005 ‚Äî technology fairly stable\nSince 2011 ‚Äî still rapid development\n\n\nRead lengths\n50-300 bp\n10-100+ kbp\n\n\nError rates\nMostly &lt;0.1%\n1-10% (ONT) / &lt;0.1-10% (PacBio)"
  },
  {
    "objectID": "pages/sequencing.html#the-main-hts-technologies-3",
    "href": "pages/sequencing.html#the-main-hts-technologies-3",
    "title": "High-throughput sequencing and genomes",
    "section": "The main HTS technologies",
    "text": "The main HTS technologies\n\n\n\n\n\n\n\n\n\nShort-read HTS\nLong-read HTS\n\n\n\n\nUsage\nMore\nLess (but increasing)\n\n\nMain companies\nIllumina\nOxford Nanopore Technologies (ONT) & Pacific Biosciences (PacBio)\n\n\nTimeline\nSince 2005 ‚Äî technology fairly stable\nSince 2011 ‚Äî still rapid development\n\n\nRead lengths\n50-300 bp\n10-100+ kbp\n\n\nError rates\nMostly &lt;0.1%\n1-10% (ONT) / &lt;0.1-10% (PacBio)\n\n\nThroughput\nHigher\nLower\n\n\nCost per base\nLower\nHigher"
  },
  {
    "objectID": "pages/sequencing.html#read-lengths",
    "href": "pages/sequencing.html#read-lengths",
    "title": "High-throughput sequencing and genomes",
    "section": "Read lengths",
    "text": "Read lengths\n\n\nCan you think of applications where long reads are useful? ¬† \n\nFor example:\n\nGenome assembly\nRead-based taxonomic identification\n\n\n\n\n\n\nCan you think of applications where read length may not matter much? ¬† \n\nFor example:\n\n(SNP) variant analysis\nCounting applications such as RNA-Seq\n\nHere, genomic locations (variant analysis) or gene identities (RNA-Seq) can be reliably inferred from as little as 25 bp."
  },
  {
    "objectID": "pages/sequencing.html#error-rates",
    "href": "pages/sequencing.html#error-rates",
    "title": "High-throughput sequencing and genomes",
    "section": "Error rates",
    "text": "Error rates\nA read‚Äôs sequence may differ from the actual DNA sequence it originated from:\n\nThe read can have base-calling errors, missing bases, or extra bases\n\n\n\nWhen the base calling software is not confident, it can also return Ns (= undetermined)\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nWhen you receive HTS reads, base calls have typically been made already.\nEvery base call is accompanied by a quality score, representing the estimated error probability."
  },
  {
    "objectID": "pages/sequencing.html#correcting-sequencing-errors",
    "href": "pages/sequencing.html#correcting-sequencing-errors",
    "title": "High-throughput sequencing and genomes",
    "section": "Correcting sequencing errors",
    "text": "Correcting sequencing errors\nTo overcome sequencing errors, every base can be sequenced multiple times ‚Äì\ni.e., obtaining a ‚Äúdepth of coverage‚Äù greater than 1:\n\n\n\n\n\n\n\n\nWhich natural phenomenon might complicate this effort? ¬† \n\nGenetic variation among and (for diploid organisms) within individuals\n\n\n\n\n\n\n\n\n\n\nTypical depths of coverage are ~50-100x for genome assembly and 10-30x for ‚Äúresequencing‚Äù (!)"
  },
  {
    "objectID": "pages/sequencing.html#libraries-and-library-prep",
    "href": "pages/sequencing.html#libraries-and-library-prep",
    "title": "High-throughput sequencing and genomes",
    "section": "Libraries and library prep",
    "text": "Libraries and library prep\n\nIn a HTS context, a ‚Äúlibrary‚Äù is a collection of DNA fragments ready for sequencing\n\n\n\n\nThese fragments can number in the millions or billions and are often randomly generated from input like genomic DNA:\n\n\n\n\n\n\n\n\n\nAn overview of the library prep procedure. This is typically done for you by a sequencing facility or company."
  },
  {
    "objectID": "pages/sequencing.html#libraries-and-library-prep-1",
    "href": "pages/sequencing.html#libraries-and-library-prep-1",
    "title": "High-throughput sequencing and genomes",
    "section": "Libraries and library prep",
    "text": "Libraries and library prep\n\nAfter library prep, each DNA fragment is flanked by several types of short sequences that together make up the ‚Äúadapters‚Äù:\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nMultiplexing!\n\n\nAdapters can include ‚Äúindices‚Äù or ‚Äúbarcodes‚Äù to identify individual samples, so many samples can be combined (multiplexed) into a single library"
  },
  {
    "objectID": "pages/sequencing.html#paired-end-vs.-single-end-sequencing",
    "href": "pages/sequencing.html#paired-end-vs.-single-end-sequencing",
    "title": "High-throughput sequencing and genomes",
    "section": "Paired-end vs.¬†single-end sequencing",
    "text": "Paired-end vs.¬†single-end sequencing\n\nFragments can be sequenced from both ends as shown below ‚Äî\nthis is called ‚Äúpaired-end‚Äù (PE) sequencing:\n\n\n\n\n\n\n\n\n\nWhen sequencing is instead single-end (SE), no reverse read is produced:"
  },
  {
    "objectID": "pages/sequencing.html#fragment-size-variation",
    "href": "pages/sequencing.html#fragment-size-variation",
    "title": "High-throughput sequencing and genomes",
    "section": "Fragment size variation",
    "text": "Fragment size variation\n\nDNA fragment size varies ‚Äì by design and because of limited precision in size selection\n\n\n\n\n\n\n\n\nWhat happens when a fragment is shorter than the length of a single F or R read? ¬† \n\n‚ÄúAdapter read-through‚Äù: the final bases in the resulting reads will consist of adapter sequence, which should be removed before downstream analysis"
  },
  {
    "objectID": "pages/sequencing.html#fragment-size-variation-1",
    "href": "pages/sequencing.html#fragment-size-variation-1",
    "title": "High-throughput sequencing and genomes",
    "section": "Fragment size variation",
    "text": "Fragment size variation\n\nDNA fragment size varies ‚Äì by design and because of limited precision in size selection\n\n\n\n\n\n\n\n\nWhat happens when a fragment is shorter than the combined F + R read length? ¬† \n\nOverlapping reads (this can be useful!):"
  },
  {
    "objectID": "pages/sequencing.html#how-illumina-sequencing-works",
    "href": "pages/sequencing.html#how-illumina-sequencing-works",
    "title": "High-throughput sequencing and genomes",
    "section": "How Illumina sequencing works",
    "text": "How Illumina sequencing works\nSequencing is performed by synthesizing a new strand using fluorescently-labeled bases and taking a picture each time a new nucleotide is incorporated:"
  },
  {
    "objectID": "pages/sequencing.html#how-illumina-sequencing-works-1",
    "href": "pages/sequencing.html#how-illumina-sequencing-works-1",
    "title": "High-throughput sequencing and genomes",
    "section": "How Illumina sequencing works",
    "text": "How Illumina sequencing works\nSequencing is performed by synthesizing a new strand using fluorescently-labeled bases and taking a picture each time a new nucleotide is incorporated:"
  },
  {
    "objectID": "pages/sequencing.html#how-illumina-sequencing-works-2",
    "href": "pages/sequencing.html#how-illumina-sequencing-works-2",
    "title": "High-throughput sequencing and genomes",
    "section": "How Illumina sequencing works",
    "text": "How Illumina sequencing works\nSequencing is performed by synthesizing a new strand using fluorescently-labeled bases and taking a picture each time a new nucleotide is incorporated:"
  },
  {
    "objectID": "pages/sequencing.html#the-scale-of-illumina-sequencing",
    "href": "pages/sequencing.html#the-scale-of-illumina-sequencing",
    "title": "High-throughput sequencing and genomes",
    "section": "The scale of Illumina sequencing",
    "text": "The scale of Illumina sequencing"
  },
  {
    "objectID": "pages/sequencing.html#the-scale-of-illumina-sequencing-1",
    "href": "pages/sequencing.html#the-scale-of-illumina-sequencing-1",
    "title": "High-throughput sequencing and genomes",
    "section": "The scale of Illumina sequencing",
    "text": "The scale of Illumina sequencing"
  },
  {
    "objectID": "pages/sequencing.html#the-scale-of-illumina-sequencing-2",
    "href": "pages/sequencing.html#the-scale-of-illumina-sequencing-2",
    "title": "High-throughput sequencing and genomes",
    "section": "The scale of Illumina sequencing",
    "text": "The scale of Illumina sequencing"
  },
  {
    "objectID": "pages/sequencing.html#the-scale-of-illumina-sequencing-3",
    "href": "pages/sequencing.html#the-scale-of-illumina-sequencing-3",
    "title": "High-throughput sequencing and genomes",
    "section": "The scale of Illumina sequencing",
    "text": "The scale of Illumina sequencing"
  },
  {
    "objectID": "pages/sequencing.html#video-of-illumina-technology",
    "href": "pages/sequencing.html#video-of-illumina-technology",
    "title": "High-throughput sequencing and genomes",
    "section": "Video of Illumina technology",
    "text": "Video of Illumina technology"
  },
  {
    "objectID": "pages/sequencing.html#reference-genomes-1",
    "href": "pages/sequencing.html#reference-genomes-1",
    "title": "High-throughput sequencing and genomes",
    "section": "Reference genomes",
    "text": "Reference genomes\nMany HTS applications either require a ‚Äúreference genome‚Äù or involve its production.\nWhat exactly does reference genome refer to? It usually includes:\n\n\nAn assembly\nA representation of most or all of the genome DNA sequence: the genome assembly\nAn annotation\nProvides e.g.¬†locations of genes and other genomic ‚Äúfeatures‚Äù in the corresponding genome assembly, and functional information for these features\n\n\n\n\n\n\n\n\n\n\nTaxonomic identity\n\n\nReference genomes are typically applicable at the species level. For example, if you work with maize, you want a Zea mays reference genome. But:\n\nIf needed, it‚Äôs often possible to work with genomes of closely related species\nConversely, different subspecies/lines may have their own reference genomes"
  },
  {
    "objectID": "pages/sequencing.html#there-is-enormous-variation-in-genome-size",
    "href": "pages/sequencing.html#there-is-enormous-variation-in-genome-size",
    "title": "High-throughput sequencing and genomes",
    "section": "There is enormous variation in genome size",
    "text": "There is enormous variation in genome size\n\n\n\n\n\n\nhttps://en.wikipedia.org/wiki/Genome_size"
  },
  {
    "objectID": "pages/sequencing.html#and-enormous-growth-of-genomes-in-databases",
    "href": "pages/sequencing.html#and-enormous-growth-of-genomes-in-databases",
    "title": "High-throughput sequencing and genomes",
    "section": "And enormous growth of genomes in databases",
    "text": "And enormous growth of genomes in databases\n\n\n\n\n\n\n Konkel and Slot (2023)"
  },
  {
    "objectID": "pages/sequencing.html#genome-assemblies",
    "href": "pages/sequencing.html#genome-assemblies",
    "title": "High-throughput sequencing and genomes",
    "section": "Genome assemblies",
    "text": "Genome assemblies\n\n\nWith increasing usage & quality of long-read HTS, assemblies are getting better and better\nStill, many assemblies instead consist of ‚Äìoften 1000s of‚Äì fragments (contigs and scaffolds)\n\n\n\n\n\n\n\n\n\n\nHow is this data stored?\n\n\nBoth genome assemblies and annotations are typically saved in a single text file each ‚Äî we‚Äôll explore some of these files in tomorrow‚Äôs lab."
  },
  {
    "objectID": "pages/sequencing.html#recap",
    "href": "pages/sequencing.html#recap",
    "title": "High-throughput sequencing and genomes",
    "section": "Recap",
    "text": "Recap\nYou‚Äôve learned:\n\nThat high-throughput sequencing (HTS) enables DNA sequencing at much larger scales than was previously possible\nHow short-read and long-read HTS have different strengths and weaknesses\nAbout libraries and the technology underlying short-read sequencing\n\n\n\nThat reference genomes are essential for many HTS applications"
  },
  {
    "objectID": "pages/sequencing.html#the-garrig√≥s-et-al.-2025-dataset",
    "href": "pages/sequencing.html#the-garrig√≥s-et-al.-2025-dataset",
    "title": "High-throughput sequencing and genomes",
    "section": "The Garrig√≥s et al.¬†2025 dataset",
    "text": "The Garrig√≥s et al.¬†2025 dataset\nThe labs this and next week are organized around the data set from Garrig√≥s et al. (2025):\n\n\n\n\n\nThis paper uses paired-end Illumina RNA-Seq data to study gene expression in Culex pipiens mosquitos infected with two different malaria-causing Plasmodium protozoans."
  },
  {
    "objectID": "pages/sequencing.html#tomorrows-lab",
    "href": "pages/sequencing.html#tomorrows-lab",
    "title": "High-throughput sequencing and genomes",
    "section": "Tomorrow‚Äôs lab",
    "text": "Tomorrow‚Äôs lab\n\nYou will first learn about what kind of computing environment is commonly used for analyzing high-throughput sequencing (HTS) data\n\n\n\nThen, you‚Äôll work in this environment to explore an HTS dataset, checking out HTS read and reference genome files, and performing read quality control"
  },
  {
    "objectID": "pages/sequencing.html#next-weeks-content",
    "href": "pages/sequencing.html#next-weeks-content",
    "title": "High-throughput sequencing and genomes",
    "section": "Next week‚Äôs content",
    "text": "Next week‚Äôs content\n\nIn the lecture, you will learn how RNA-Seq is used to study gene expression at scale\n\n\n\nIn the lab, you will perform differential gene expression analysis on the Culex pipiens RNA-Seq dataset"
  },
  {
    "objectID": "pages/sequencing.html#references",
    "href": "pages/sequencing.html#references",
    "title": "High-throughput sequencing and genomes",
    "section": "References",
    "text": "References\n\n\n\n\nGarrig√≥s, Marta, Guillem Ylla, Josu√© Mart√≠nez-de la Puente, Jordi Figuerola, and Mar√≠a Jos√© Ruiz-L√≥pez. 2025. ‚ÄúTwo Avian Plasmodium Species Trigger Different Transcriptional Responses on Their Vector Culex pipiens.‚Äù Molecular Ecology 34 (15): e17240. https://doi.org/10.1111/mec.17240.\n\n\nKonkel, Zachary, and Jason C. Slot. 2023. ‚ÄúMycotools: An Automated and Scalable Platform for Comparative Genomics.‚Äù BioRxiv. https://doi.org/10.1101/2023.09.08.556886."
  },
  {
    "objectID": "index.html",
    "href": "index.html",
    "title": "Jelmer‚Äôs guest lectures in ENTMLGY 6703 - SP26",
    "section": "",
    "text": "Schedule\n\n\n\nWeek\nDate\nModule\nType\nTopic & link\n\n\n\n\n3\nJan 29th\nHigh-throughput sequencing (HTS)\nLecture\nHigh-throughput sequencing & genomes\n\n\n3\nJan 30th\nHigh-throughput sequencing (HTS)\nLab\n- Part 1: Computing environment- Part 2: Working with genome and HTS data\n\n\n4\n\nRNA-Seq\nHomework\nR basics\n\n\n4\nFeb 5th\nRNA-Seq\nLecture\nRNA-Seq\n\n\n4\nFeb 6th\nRNA-Seq\nLab\nDifferential expression analysis\n\n\n\n\n\n\n\n Back to top"
  },
  {
    "objectID": "about.html",
    "href": "about.html",
    "title": "About this website",
    "section": "",
    "text": "This website contains the lecture slides and lab material for the guest lectures by Jelmer Poelstra (CFAES Bioinformatics Core, Ohio State University) in the graduate-level ENTMLGY 6703 Spring 2026 course ‚ÄúMolecular Techniques & Data Analysis Syllabus‚Äù taught by Peter Piermarini and Larry Phelan at OSU.\nThe source code for this website can be found at https://github.com/jelmerp/ENTMLGY6703-SP26.\n\n\n\n Back to top"
  },
  {
    "objectID": "pages/infrastructure.html#introduction",
    "href": "pages/infrastructure.html#introduction",
    "title": "Computing Environment for HTS Analysis",
    "section": "1 Introduction",
    "text": "1 Introduction\n\n1.1 Today‚Äôs lab\nIn today‚Äôs lab:\n\nYou will first learn about what kind of computing environment is commonly used for analyzing high-throughput sequencing (HTS) data ‚Äì this page, part I.\nThen, you‚Äôll work in this environment to explore an HTS dataset. You‚Äôll check out HTS read and reference genome files, and perform read quality control ‚Äì part II.\n\n\n\n1.2 Goals for this part\n\nLearn what computing environment is commonly used for genomics analyses\nUnderstand the basics of supercomputers\nLearn how to access Ohio Supercomputer Center (OSC) resources\nTake your first steps in the command-line interface of the Unix shell"
  },
  {
    "objectID": "pages/infrastructure.html#overview-of-the-computing-environment-for-hts-analysis",
    "href": "pages/infrastructure.html#overview-of-the-computing-environment-for-hts-analysis",
    "title": "Computing Environment for HTS Analysis",
    "section": "2 Overview of the computing environment for HTS analysis",
    "text": "2 Overview of the computing environment for HTS analysis\nDue in large part to the amount of data involved, a personal computer is often not sufficient to work with HTS data. Additionally, most of the specialized programs that help you analyze your data can only be run through a ‚Äúcommand-line interface‚Äù, in which you type commands rather than point-and-click.\nTherefore, a typical computing environment -the computer hardware and software- for HTS data analysis includes:\n\nA supercomputer ‚Äî here, the Ohio Supercomputer Center (OSC)\nThe Unix shell (terminal) and command-line programs that run in it\nR (or Python) for statistical analysis and visualization.\n\nToday, you will see the first two of these components in action. In today‚Äôs first part, you‚Äôll build some familiarity with them, and in the next part, you‚Äôll use them to explore reference genome and HTS read data. (In next week‚Äôs lab, we will cover the third item in the context of RNA-Seq differential expression analysis.)"
  },
  {
    "objectID": "pages/infrastructure.html#the-ohio-supercomputer-center-osc",
    "href": "pages/infrastructure.html#the-ohio-supercomputer-center-osc",
    "title": "Computing Environment for HTS Analysis",
    "section": "3 The Ohio Supercomputer Center (OSC)",
    "text": "3 The Ohio Supercomputer Center (OSC)\n\n3.1 Introduction to supercomputers\nA supercomputer (also known as a ‚Äúcluster‚Äù) consists of many computers that are connected by a high-speed network and can be accessed remotely by its users. You can think of it simply as a network of computers ‚Äî with individual computers called ‚Äúnodes‚Äù.\nSupercomputers provide two main types of resources:\n\nCompute: computing power to run your data processing and analysis\nFile storage: space for storage of your data and results\n\nWhy might you need a supercomputer?\n\nOften, your HTS dataset is too large to be handled efficiently, or at all, by a laptop/desktop computer\nTo speed up analyses by using more computing power and/or running them in parallel\nIt‚Äôs also a great place to store large amounts of data ‚Äî and HTS data is often very large\n\n\n\n3.2 Introduction to OSC\n\n\n\n\n\nThe Ohio Supercomputer Center (OSC) provides computing resources to researchers and others across Ohio1. It currently has three supercomputers ‚Äì this is what ‚ÄúCardinal‚Äù, one of those, physically looks like:\n\n\n\n\n\n\n\nThe Cardinal OSC cluster: it‚Äôs just some cabinets with many connected computers inside!\n\n\n\nThe structure of an OSC supercomputer\nYou can think of a supercomputer as having three main parts:\n\nLogin Nodes: The handful of computers that you end up on after logging in\nCompute Nodes: The many computers you can reserve to run your analyses\nFile Systems: Where files are stored2\n\n\n\n\n\n\n\n\nThe structure of a supercomputer with three main components: file systems, login nodes, and compute nodes"
  },
  {
    "objectID": "pages/infrastructure.html#the-osc-ondemand-web-portal",
    "href": "pages/infrastructure.html#the-osc-ondemand-web-portal",
    "title": "Computing Environment for HTS Analysis",
    "section": "4 The OSC OnDemand web portal",
    "text": "4 The OSC OnDemand web portal\n Go to https://ondemand.osc.edu. Use the username + password login option on the left-hand side to log in with your OSC (not OSU!) credentials. Once logged in, you should see a landing page similar to the one below:\n\n\n\n\n\n\n\nThe OSC OnDemand landing page\n\n\nLet‚Äôs go through some of the dropdown menus in the blue bar along the top.\n\n4.1 Files menu\nHovering over the Files dropdown menu gives a list of ‚Äútop-level‚Äù folders you have access to:\n\n\n\n\n\n\n\nThe Files dropdown menu. You will see different folders listed.\n\n\nIf your account is brand new, you should only see three folders listed, two of which are related to the OSC project we are using in these labs, which is called PAS2880:\n\nHome Directory ‚Äì for miscellaneous personal files\n/fs/scratch/PAS2880 ‚Äì The ‚Äúscratch‚Äù folder for temporary storage for project PAS2880\n/fs/ess/PAS2880 ‚Äì The ‚Äúproject‚Äù folder for permanent storage for project PAS2880\n\nClick on the PAS2880 scratch folder, /fs/scratch/PAS2880: you should see the folders and files present there, and be able to click on folders to explore their contents. Then, click on the ENT6703 folder, which we‚Äôll be using for these labs, and you should see something like the following:\n\n\n\n\n\n\n\nThe OnDemand file browser\n\n\nThis interface is much like the file browser on your own computer, so you can create, delete, move, copy files and folders. Additionally, you can upload (from your computer to OSC) and download (from OSC your computer) files ‚Äì see the buttons across the top.\n Create your own folder by clicking the New Directory button at the top. Give it the exact same name as your OSC username, including any capitalization. (I‚Äôll refer to this folder as your personal folder from now on.)\n\n\n\n\n\n\nIf in doubt, you can see what your username is by looking at the right side of the blue top bar:\n\n\n\n\n\n\n\n\n\n Exercise: Understanding file/folder locations\n\nClick on your personal folder to enter it.\nTake a look at the so-called ‚Äúpath‚Äù (file/folder location) shown at the top of the file browser, next to ‚ÄúChange directory‚Äù. How do you interpret this notation: what do the forward slashes / indicate, and what does each part in between represent? (It may help to click back-and-forth between folders to see how the path changes.) Does this seem fundamentally different from the file system on your own computer?\n\n\nClick for the solution\n\nThe forward slashes / separate folders in a path. Each part in between, then, represents a folder.\nThe path is hierarchical and you should read it from left (top-level folder) to right (subfolders): For example, in /fs/scratch/PAS2880/ENT6703:\n\n/fs is a top-level folder ‚Äì you can always distinguish a top-level folder because the path starts with a forward slash /\ninside that is the scratch folder\ninside that is the PAS2880 folder\ninside that is the ENT6703 folder\n\nFile systems on personal computers are structured very similarly. But on Windows, among some other differences, backslashes \\ are used instead of forward slashes / to separate folders.\n\n\n\nClick to see a diagram of the OSC file system\n\n\n\n\n\n\n\n\nIf someone made a folder miranda inside the ENT6703 folder, what would be the path to that folder?\n\n\nClick for the solution\n\nThe path would be /fs/scratch/PAS2880/ENT6703/miranda.\n\n\n\n\n\n4.2 Interactive Apps\nYou can access a bunch of software via the Interactive Apps dropdown menu. In next week‚Äôs lab, you will use RStudio (‚ÄúRStudio Server‚Äù) from this menu.\n\n\n\n\n\n\n\nSome of the options at the bottom of the Interactive Apps dropdown menu, such as RStudio.\n\n\n\n\n4.3 Clusters menu: Shell access\nWe‚Äôll now open a Unix shell, which you‚Äôll get introduced to in the next section. Under the Clusters dropdown menu, you can access a Unix shell on each of the three OSC supercomputers (clusters) ‚Äì Ascend, Cardinal, or Pitzer:\n\n\n\n\n\n\n\nThe Clusters dropdown menu\n\n\nClick on ‚ÄúCardinal Shell Access‚Äù, which will open a new browser tab with a black terminal window.\n\n\n\n\n\n\nSide note: System Status(click to expand)\n\n\n\n\n\nYou can also check out the System Status page from the Clusters menu. This page shows an overview of the live, current usage of the two clusters ‚Äì just to give you an idea of the scale of the supercomputer center and its usage.\n\n\n\n\n\n\n\nA screenshot of the ‚ÄúSystem Status‚Äù page showing live cluster usage."
  },
  {
    "objectID": "pages/infrastructure.html#the-unix-shell",
    "href": "pages/infrastructure.html#the-unix-shell",
    "title": "Computing Environment for HTS Analysis",
    "section": "5 The Unix shell",
    "text": "5 The Unix shell\n\n5.1 What is the Unix shell and why use it?\nA computer‚Äôs shell is an interface inside a Terminal window that allows you to interact with your computer by typing commands. More specifically, the Unix shell is the shell of Unix-based operating systems (Mac and Linux but not Windows). Supercomputers like OSC run on Linux, so the default shell here -and for scientific computing in general- is a Unix shell.\nUsing the Unix shell is often a necessity when working with HTS data, in order to run the specialized software needed for data processing. But there are other good reasons to use the shell, including:\n\nAutomation and efficiency\nThe shell allows you to repeat and automate tasks easily and without introducing errors.\nReproducibility\nWhen working in the shell, it‚Äôs straightforward to keep a detailed record of what you have done.\nViewing and processing large files\nShell commands are excellent at viewing and processing large, plain-text files, which are common in omics data.\n\n\n\n5.2 First steps in the Unix shell\n\nThe terminal interface\nThe terminal interface you see after opening the Cardinal Shell Access should look something like this:\n\n\n\n\n\nOSC is printing some welcome messages and information about your account. At the bottom is the prompt, where you can type commands. To start with:\n\nI will go ahead and clear the screen, so the prompt is at the top, and will continue to occasionally do that throughout this session. The screen can be cleared with Ctrl + L (both Windows and Mac).\nIn the top-right corner of the terminal window is a Themes: dropdown menu, where you can select a different color scheme for the terminal. I prefer light themes and will select GitHub; you may choose whatever you like.\n\nWith a light theme and a cleared screen, the terminal window should now look something like this:\n\n\n\n\n\n\n\nThe shell prompt\nInside your terminal, the ‚Äúprompt‚Äù indicates that the shell is ready for a command. Your prompt at OSC should show the following pieces of information:\n[&lt;username&gt;@&lt;node-name&gt; &lt;current-folder&gt;]$\nFor example, below, user jelmer is on node cardinal-login01 in folder ~ (the tilde ~ is shorthand for the user‚Äôs home folder):\n[jelmer@cardinal-login01 ~]$ \nTo use the shell, you type a command after the dollar sign $, and then press Enter to execute it. When it has finished running, you‚Äôll get your prompt back and can type a new command. Easy! üòÉ\n\n\n\n\n\n\nHow shell code is shown on this website\n\n\n\n\nThe pale gray boxes like the ones shown above are used to show the commands you should type\nFrom now on, the prompt itself ([...]$) won‚Äôt be shown, only the commands you type\nDarker gray boxes (with italic text, below the boxes with commands) show the output of commands\n\n\n\n\n\nA few simple commands: date, whoami, pwd\nThe Unix shell comes with hundreds of ‚Äúcommands‚Äù: small programs that perform specific actions (if you‚Äôve used R, a Unix command is like an R function). Let‚Äôs start with a few simple commands:\n\nThe date command prints the current date and time:\ndate\nFri Jan 30 14:31:51 EST 2026\nThe whoami (who-am-i) command prints your username:\nwhoami\njelmer\nThe pwd -Print Working Directory- command prints the path of the folder you are currently located in ‚Äì yours will be different than mine.\npwd\n/users/PAS0471/jelmer\n\nAll those commands provided us with some output. That output was printed to screen, which is the default behavior for most Unix commands.\n\n\n\n\n\n\nSome terminology\n\n\n\n\n‚ÄúDirectory‚Äù or ‚Äúdir‚Äù for short is just a synonym for ‚Äúfolder‚Äù ‚Äì we‚Äôll mostly use ‚Äúdir‚Äù from now on\nWhen working in a Unix shell, you are always ‚Äúin‚Äù a specific dir, which is called your working dir\nRecall from earlier that a ‚Äúpath‚Äù, such as that output by pwd, specifies the location of a file or dir in a computer‚Äôs file system\n\n\n\n\n\n\n5.3 cd and command actions & arguments\nIn the above three examples:\n\nYou merely typed a command and nothing else\nThe command provided some information, which was printed to screen\n\nBut many commands perform an action other than providing information. For example, you can use the command cd to Change Directory, i.e.¬†change your working dir.\nLet‚Äôs use cd to navigate to another dir by specifying the path to that directory after the cd command:\ncd /fs/scratch/PAS2880/ENT6703/data\nNote that cd had no output at all. But it did perform the desired action, which we can see by checking the working directory again with pwd:\npwd\n/fs/scratch/PAS2880/ENT6703/data\n\n\n\n\n\n\nI will demonstrate a neat feature called ‚Äútab completion‚Äù!\n\n\n\n\n\n\nIn more abstract terms, you provided cd with an argument above, namely the path of the dir to navigate to. Arguments generally tell commands what file or directory to operate on.\nSo, cd gives no output when it succesfully changed the working directory. But let‚Äôs also see what happens when it does not succeed ‚Äî an error appears:\ncd /fs/Scratch/PAS2880\nbash: cd: /fs/Scratch/PAS2880: No such file or directory\n\n\n What was the problem with the path we specified? Does that surprise you? (Click to see the answer)\n\nWe used a capital S in /Scratch/ ‚Äî this should have been /scratch/.\nThis hints at the fact that everything in the shell is case-sensitive, including commands and file names. So if a directory is called scratch, typing Scratch will not work!\n\n\n\n5.4 ls and command options\n\nThe default behavior of ls\nThe ls command, short for ‚Äúlist‚Äù, will list files and directories ‚Äì by default those present in your current working dir:\nls\nfastq  meta  README.md  ref\n\n\n\n\n\n\nSide note: ls output colors (click to expand)\n\n\n\n\n\nThe ls output shown above does not show the different colors you should see in your shell, where:\n\nEntries in blue are directories (like fastq and meta above)\nEntries in black are regular files (like README.md above)\nEntries in red are compressed files (you‚Äôll see an example soon)\n\n(Though note that some color schemes may show different colors for these.)\n\n\n\n\n\nOptions (to ls)\nThe way that ls shows the output can be changed using options. In general, while arguments tell a command what to operate on, options will modify its behavior. For example, we can call ls with the option -l (a dash followed by a lowercase L):\nls -l \ntotal 2\ndrwxr-x--- 2 jelmer PAS0471 4096 Jan 27 08:37 fastq\ndrwxr-x--- 2 jelmer PAS0471 4096 Jan 27 08:37 meta\n-rw-r----- 1 jelmer PAS0471 1539 Jan 27 08:37 README.md\ndrwxr-x--- 2 jelmer PAS0471 4096 Jan 27 08:37 ref\nNotice that it lists the same items as our first ls call above, but printed in a different format: one item per line, with additional information such as the last-modified date and time, and the file sizes in bytes (to the left of the date).\nLet‚Äôs add another option, -h:\nls -l -h\ntotal 2.0K\ndrwxr-x--- 2 jelmer PAS0471 4.0K Jan 27 08:37 fastq\ndrwxr-x--- 2 jelmer PAS0471 4.0K Jan 27 08:37 meta\n-rw-r----- 1 jelmer PAS0471 1.6K Jan 27 08:37 README.md\ndrwxr-x--- 2 jelmer PAS0471 4.0K Jan 27 08:37 ref\n\n\n What is different about the output, and what do you think that means? (Click to see the answer)\n\nThe only difference is in the format of the column reporting the sizes of the items listed.\nYou now have ‚ÄúHuman-readable filesizes‚Äù (hence -h), where sizes on the scale of kilobytes will be shown with Ks, of megabytes with Ms, and of gigabytes with Gs. Minor detail, but this can be quite useful especially for large files.\n\nConveniently, options can be ‚Äúpasted together‚Äù; ls -lh is equivalent to ls -l -h:\nls -lh\ntotal 17K\ntotal 2.0K\ndrwxr-x--- 2 jelmer PAS0471 4.0K Jan 27 08:37 fastq\ndrwxr-x--- 2 jelmer PAS0471 4.0K Jan 27 08:37 meta\n-rw-r----- 1 jelmer PAS0471 1.6K Jan 27 08:37 README.md\ndrwxr-x--- 2 jelmer PAS0471 4.0K Jan 27 08:37 ref\n\n\nCombining options and arguments\nArguments to ls should be dirs or files to operate on. For example, if you wanted to see what‚Äôs inside the fastq dir, instead of inside your working dir, we could type:\nls fastq\nERR10802863_R1.fastq.gz  ERR10802865_R2.fastq.gz  ERR10802868_R1.fastq.gz  ERR10802870_R2.fastq.gz  ERR10802875_R1.fastq.gz  ERR10802877_R2.fastq.gz  ERR10802880_R1.fastq.gz  ERR10802882_R2.fastq.gz  ERR10802885_R1.fastq.gz\nERR10802863_R2.fastq.gz  ERR10802866_R1.fastq.gz  ERR10802868_R2.fastq.gz  ERR10802871_R1.fastq.gz  ERR10802875_R2.fastq.gz  ERR10802878_R1.fastq.gz  ERR10802880_R2.fastq.gz  ERR10802883_R1.fastq.gz  ERR10802885_R2.fastq.gz\nERR10802864_R1.fastq.gz  ERR10802866_R2.fastq.gz  ERR10802869_R1.fastq.gz  ERR10802871_R2.fastq.gz  ERR10802876_R1.fastq.gz  ERR10802878_R2.fastq.gz  ERR10802881_R1.fastq.gz  ERR10802883_R2.fastq.gz  ERR10802886_R1.fastq.gz\nERR10802864_R2.fastq.gz  ERR10802867_R1.fastq.gz  ERR10802869_R2.fastq.gz  ERR10802874_R1.fastq.gz  ERR10802876_R2.fastq.gz  ERR10802879_R1.fastq.gz  ERR10802881_R2.fastq.gz  ERR10802884_R1.fastq.gz  ERR10802886_R2.fastq.gz\nERR10802865_R1.fastq.gz  ERR10802867_R2.fastq.gz  ERR10802870_R1.fastq.gz  ERR10802874_R2.fastq.gz  ERR10802877_R1.fastq.gz  ERR10802879_R2.fastq.gz  ERR10802882_R1.fastq.gz  ERR10802884_R2.fastq.gz\nAh, FASTQ files! These contain the HTS reads you‚Äôll work with, and you‚Äôll explore them in the second part of this lab.\nFinally, you can combine options and arguments, and let‚Äôs do so take a closer look at the dir with FASTQ files ‚Äî now, the -h option is especially useful and allows you see that the FASTQ files are 21-22 Mb in size:\nls -lh fastq\ntotal 941M\n-rw-r----- 1 jelmer PAS0471 21M Jan 27 08:37 ERR10802863_R1.fastq.gz\n-rw-r----- 1 jelmer PAS0471 22M Jan 27 08:37 ERR10802863_R2.fastq.gz\n-rw-r----- 1 jelmer PAS0471 21M Jan 27 08:37 ERR10802864_R1.fastq.gz\n-rw-r----- 1 jelmer PAS0471 22M Jan 27 08:37 ERR10802864_R2.fastq.gz\n-rw-r----- 1 jelmer PAS0471 22M Jan 27 08:37 ERR10802865_R1.fastq.gz\n-rw-r----- 1 jelmer PAS0471 22M Jan 27 08:37 ERR10802865_R2.fastq.gz\n-rw-r----- 1 jelmer PAS0471 21M Jan 27 08:37 ERR10802866_R1.fastq.gz\n-rw-r----- 1 jelmer PAS0471 22M Jan 27 08:37 ERR10802866_R2.fastq.gz\n[...output truncated...]\n\n\n Exercise: Practice with ls\nList the files in the ref dir. What are the file sizes?\n\n\nClick for the solution\n\nls -lh ref\ntotal 659M\n-rw-r----- 1 jelmer PAS0471 547M Jan 27 08:37 GCF_016801865.2.fna\n-rw-r----- 1 jelmer PAS0471 123M Jan 27 08:37 GCF_016801865.2.gtf\nThe .fna file (the genome assembly nucleotide FASTA file) is 547 Mb, and the .gtf file (the annotation GTF file) is 123 Mb.\n\n\n\n Bonus Exercise: Paths\nEarlier with cd, you used long paths like /fs/scratch/PAS2880/ENT6703/data. Here, you used short ones like data and fastq. What is the difference between these kinds of paths ‚Äì which of the following statements is correct (only one is correct)?\n\n\nWhen you use cd, you have to use long paths, but with ls you can use short ones.\ndata and fastq are just shorter because they are closer to the root of the filesystem, so there are fewer dirs to travel through.\nThe long paths start from the root of the file system, while the short paths start from your current working dir.\nThe long paths are for directories, while the short paths are for files.\n\n\n\n\nClick for the solution\n\nThe correct answer is C.\nThe long paths are called absolute paths, and start from the root of the file system (recognized by a leading slash like in /fs/ess). Making an analogy with geographic locations, you can think of these as GPS coordinates: they always point to the same location, no matter where you currently are.\nThe short paths are relative paths, starting from your current working dir. Continuing the geographic analogy, these are like giving directions starting from your current location such as ‚Äútake the second left‚Äù.\nSee the table below for two examples:\n\n\n\n\n\n\n\n\n\nWorking dir\nAbsolute path to another folder\nRelative path\n\n\n\n\n/fs/scratch/PAS2880/ENT6703/data\n/fs/scratch/PAS2880/ENT6703/data/fastq\nfastq\n\n\n/fs/scratch/PAS2880/ENT6703\n/fs/scratch/PAS2880/ENT6703/data/fastq\ndata/fastq\n\n\n\n\n\n\n\n\n5.5 A few more general shell tips\n\nCommand history: If you hit the ‚áß (up arrow) once, you‚Äôll retrieve your most recent command, and if you keep hitting it, you‚Äôll go further back. The‚á© (down arrow) will go the other way: towards the present.\nYour cursor can be anywhere on a line (not just at the end) when you press Enter to execute a command!\nAnything that comes after a # is considered a comment instead of code!\n# This entire line is a comment - you can run it and nothing will happen\npwd    # 'pwd' will be executed but everything after the '#' is ignored\n/fs/scratch/PAS2880/ENT6703/data\n\n\n\n Exercise: Shell navigation practice\n\nNavigate into your personal dir (the one you created a little while back), and then back into the data dir.\n\n\nClick for the solution\n\n\nNavigate to your personal folder (replace jelmer with your username):\ncd /fs/scratch/PAS2880/ENT6703/jelmer\nNavigate back to data:\ncd /fs/scratch/PAS2880/ENT6703/data\n\n\nUse command history (arrows) to repeat the previous exercise without typing commands.\n\n\n\n Bonus Exercise: Navigating up\nIn the first question, did you perhaps find yourself wondering how you can navigate up a level in the file system?\nWell: in a path, .. denotes one level up. And ../bla, for example, means one level up and then down into the bla directory.\nTry to make use of this construct to navigate into your personal dir and back to data again, instead of using the ‚Äúfull paths‚Äù like above. Hint: Tab completion after typing ../ can help you to orient yourself!\n\n\nClick for the solution\n\n\nInto your personal dir (replace jelmer with your own username):\ncd ../jelmer\nBack to data:\ncd ../data\n\n\n\n\nClick to see a diagram of using ..\n\n\n\n\n\n\n\n\n\n\n\nContinue to part II of this lab =&gt;"
  },
  {
    "objectID": "pages/infrastructure.html#footnotes",
    "href": "pages/infrastructure.html#footnotes",
    "title": "Computing Environment for HTS Analysis",
    "section": "Footnotes",
    "text": "Footnotes\n\n\n Research usage is charged at subsidized rates, and in our case at CFAES, these costs are absorbed at the college level.‚Ü©Ô∏é\n These are shared between the OSC supercomputers, so you can access the same files from each one.‚Ü©Ô∏é"
  },
  {
    "objectID": "pages/rnaseq.html#recap-central-dogma-omics",
    "href": "pages/rnaseq.html#recap-central-dogma-omics",
    "title": "Transcriptomics with RNA-Seq",
    "section": "Recap: central dogma & omics",
    "text": "Recap: central dogma & omics"
  },
  {
    "objectID": "pages/rnaseq.html#the-transcriptome",
    "href": "pages/rnaseq.html#the-transcriptome",
    "title": "Transcriptomics with RNA-Seq",
    "section": "The transcriptome",
    "text": "The transcriptome\nThe transcriptome is the full set of transcripts expressed by an organism, which:\n\n\nIs not at all stable across time & space in any given organism\n(unlike the genome but much like the proteome)\nVaries both qualitatively (which transcripts are expressed) but especially quantitatively (how much of each transcript is expressed)"
  },
  {
    "objectID": "pages/rnaseq.html#transcriptomics",
    "href": "pages/rnaseq.html#transcriptomics",
    "title": "Transcriptomics with RNA-Seq",
    "section": "Transcriptomics",
    "text": "Transcriptomics\nTranscriptomics is the study of the transcriptome,\ni.e.¬†the large-scale study of RNA transcripts expressed in an organism.\n\nMany approaches & applications ‚Äî but most commonly, transcriptomics focuses on:\n\n\nmRNA rather than on noncoding RNA types such as rRNA, tRNA, and miRNA\nQuantifying gene expression levels (& ignoring nucleotide-level variation)\nStatistically comparing expression between groups (treatments, populations, tissues)\n\n\n\n\n\n\nhttps://hbctraining.github.io"
  },
  {
    "objectID": "pages/rnaseq.html#why-do-transcriptomics",
    "href": "pages/rnaseq.html#why-do-transcriptomics",
    "title": "Transcriptomics with RNA-Seq",
    "section": "Why do transcriptomics?",
    "text": "Why do transcriptomics?\nConsidering‚Ä¶\n\nThat protein production gives clues about the activity of specific biological functions, and the molecular mechanisms underlying those functions;\nThat it is much easier to measure transcript expression than protein expression at scale;\nThe central dogma\n\n\n‚Ä¶ we can use gene expression levels as a proxy for protein expression levels and make functional inferences."
  },
  {
    "objectID": "pages/rnaseq.html#why-do-transcriptomics-cont.",
    "href": "pages/rnaseq.html#why-do-transcriptomics-cont.",
    "title": "Transcriptomics with RNA-Seq",
    "section": "Why do transcriptomics? (cont.)",
    "text": "Why do transcriptomics? (cont.)\nSpecifically, we can use transcriptomics to:\n\n\nCompare & contrast phenotypic vs.¬†molecular responses/differences\n\n\n\n\nFind the pathways and genes that:\n\nUnderlie phenotypic responses\nExplain differences between groups (treatments, genotypes, sexes, tissues, etc.)\nCan be targeted to enhance or reduce organismal responses to help control pathogens and pests"
  },
  {
    "objectID": "pages/rnaseq.html#what-is-rna-seq",
    "href": "pages/rnaseq.html#what-is-rna-seq",
    "title": "Transcriptomics with RNA-Seq",
    "section": "What is RNA-Seq?",
    "text": "What is RNA-Seq?\nRNA-Seq is the current state-of-the-art family of methods to study the transcriptome.\nIt involves the random sequencing of millions of transcript fragments per sample.\n\nWe will focus on the most common type of RNA-Seq, which:\n\n\nDoes not actually sequence the RNA, but first reverse transcribes RNA to cDNA\nAttempts to sequence only mRNA while avoiding noncoding RNAs (‚ÄúmRNA-Seq‚Äù)\nDoes not distinguish between RNA from different cell types (‚Äúbulk RNA-Seq‚Äù)\nUses short reads (‚â§150 bp) that do not cover full transcripts but do uniquely ID genes"
  },
  {
    "objectID": "pages/rnaseq.html#todo-relate-to-qpcr-covered-earlier",
    "href": "pages/rnaseq.html#todo-relate-to-qpcr-covered-earlier",
    "title": "Transcriptomics with RNA-Seq",
    "section": "TODO: Relate to qPCR covered earlier",
    "text": "TODO: Relate to qPCR covered earlier"
  },
  {
    "objectID": "pages/rnaseq.html#other-rna-seq-applications",
    "href": "pages/rnaseq.html#other-rna-seq-applications",
    "title": "Transcriptomics with RNA-Seq",
    "section": "Other RNA-Seq applications",
    "text": "Other RNA-Seq applications\nRNA-Seq data can also be used for applications other than expression quantification:\n\nSNP identification & analysis (for popgen, molecular evolution, functional associations)\n\n\n\nFor organisms without a reference genome: identify genes present in the organism\nFor organisms with a reference genome: discover new genes & transcripts,\nand improve genome annotation\n\n\n\n\nAll in all, RNA-Seq is a very widely used technique ‚Äî\nit constitutes the most common usage of high-throughput sequencing!"
  },
  {
    "objectID": "pages/rnaseq.html#rna-seq-project-examples",
    "href": "pages/rnaseq.html#rna-seq-project-examples",
    "title": "Transcriptomics with RNA-Seq",
    "section": "RNA-Seq project examples",
    "text": "RNA-Seq project examples\nRNA-Seq is also the most common data type I assist with as an MCIC bioinformatician. Some projects I‚Äôve worked on used it to identify genes & pathways that differ between:\n\nMultiple soybean cultivars in response to Phytophtora sojae inoculation; soybean in response to different Phytophtora species and strains (Dorrance lab, PlantPath)\nWheat vs.¬†Xanthomonas with a gene knock-out vs.¬†knock-in (Jacobs lab, PlantPath)\n\n\n\nMated and unmated mosquitos (Sirot lab, College of Wooster)\nTissues of the ambrosia beetle and its symbiotic fungus (Ranger lab, USDA Wooster)\nDiapause-inducing conditions for two pest stink bug species (Michel lab, Entomology)\n\n\n\n\nHuman carcinoma cell lines with vs.¬†without a manipulated gene (Cruz lab, CCC)\nPig coronaviruses with vs.¬†without an experimental insertion (Wang lab, CFAH)\n\n\n\nAnd to improve the annotation of a nematode genome (Taylor lab, PlantPath)"
  },
  {
    "objectID": "pages/rnaseq.html#experimental-design-groups-replicates",
    "href": "pages/rnaseq.html#experimental-design-groups-replicates",
    "title": "Transcriptomics with RNA-Seq",
    "section": "Experimental design: groups & replicates",
    "text": "Experimental design: groups & replicates\nRNA-Seq typically compares groups of samples defined by differences in:\n\nTreatments (e.g.¬†different host plant, temperature, diet, mated/unmated) and/or\nOrganismal variants: ages/developmental stages, sexes, or genotypes (lines/biotypes/subspecies/morphs) and/or\nTissues"
  },
  {
    "objectID": "pages/rnaseq.html#experimental-design-groups-replicates-1",
    "href": "pages/rnaseq.html#experimental-design-groups-replicates-1",
    "title": "Transcriptomics with RNA-Seq",
    "section": "Experimental design: groups & replicates",
    "text": "Experimental design: groups & replicates\n\nhttps://github.com/ScienceParkStudyGroup/rnaseq-lesson"
  },
  {
    "objectID": "pages/rnaseq.html#experimental-design-groups-replicates-2",
    "href": "pages/rnaseq.html#experimental-design-groups-replicates-2",
    "title": "Transcriptomics with RNA-Seq",
    "section": "Experimental design: groups & replicates",
    "text": "Experimental design: groups & replicates\nTo be able to make statistically supported conclusions about expression differences between such groups of samples, we must have biological replication.\nWhen designing an RNA-Seq experiment, keep the following in mind:\n\nNumbers of replicates\nThese are typically quite low: 3 replicates per treatment (x tissue x biotype, etc.) is the most common. Not advisable to go lower ‚Äî if possible, use 4 or 5 replicates.\n\n\n\nStatistical comparison design\nPreferably, keep your design relatively simple with 1-2 independent variables and 2-3 levels for each of them. Specifically, pairwise comparisons are easiest to interpret.\n\n\n\n\n\n\n\n\n\nTechnical replicates?\n\n\nYou won‚Äôt need technical replicates that only replicate library prep and/or sequencing, but depending on your experimental design, may want to technically replicate something else."
  },
  {
    "objectID": "pages/rnaseq.html#the-garrig√≥s-et-al.-2025-dataset",
    "href": "pages/rnaseq.html#the-garrig√≥s-et-al.-2025-dataset",
    "title": "Transcriptomics with RNA-Seq",
    "section": "The Garrig√≥s et al.¬†2025 dataset",
    "text": "The Garrig√≥s et al.¬†2025 dataset\n\n\n\n\n\nThis paper uses RNA-seq data to study gene expression in Culex pipiens mosquitos infected with malaria-causing Plasmodium protozoans ‚Äî specifically, it compares mosquitos according to:\n\nInfection status: Plasmodium cathemerium vs.¬†P. relictum vs.¬†control\nTime after infection: 24 h vs.¬†10 days vs.¬†21 days"
  },
  {
    "objectID": "pages/rnaseq.html#from-samples-to-reads-overview-of-steps",
    "href": "pages/rnaseq.html#from-samples-to-reads-overview-of-steps",
    "title": "Transcriptomics with RNA-Seq",
    "section": "From samples to reads: overview of steps",
    "text": "From samples to reads: overview of steps\n\nhttps://sydney-informatics-hub.github.io/training-RNAseq-slides"
  },
  {
    "objectID": "pages/rnaseq.html#rna-extraction-library-prep",
    "href": "pages/rnaseq.html#rna-extraction-library-prep",
    "title": "Transcriptomics with RNA-Seq",
    "section": "RNA extraction & library prep",
    "text": "RNA extraction & library prep\n\n\n\n\n\n\n\n\n\n\n\n\nLibrary preparation is typically done by sequencing facilities\n\n\n\nThere are two main ways to select for mRNAs, which make up only a few % of RNAs: poly-A selection and ribo-depletion.\n\n\n\nMany samples can be ‚Äúmultiplexed‚Äù into a single RNA-Seq library\n\n\n\n\n\n\nFig. from Kukurba & Montgomery 2015"
  },
  {
    "objectID": "pages/rnaseq.html#sequencing-considerations",
    "href": "pages/rnaseq.html#sequencing-considerations",
    "title": "Transcriptomics with RNA-Seq",
    "section": "Sequencing considerations",
    "text": "Sequencing considerations\n\nSequencing technology\n\nIllumina short reads: by far the most common\nPacBio or ONT long reads: consider if sequencing full transcripts (isoforms) is key\n\n\n\n\n\nSingle-end vs.¬†paired-end reads (for Illumina)\n\nPaired-end has limited added value for reference-based, gene-level workflows (but can be key in other scenarios) ‚Äî but it is still common as prices are often similar\n\n\n\n\n\n\nSequencing ‚Äúdepth‚Äù / amount ‚Äî how many reads per sample\n\nGuidelines highly approximate (cf.¬†in genomics) ‚Äî depends not just on transcriptome size; also on expression level distribution, expression levels of genes of interest, etc.\nTypical recommendations are 20-50 million reads per sample (more for e.g.¬†transcript-level inferences)"
  },
  {
    "objectID": "pages/rnaseq.html#sequencing-depth-vs.-replicates",
    "href": "pages/rnaseq.html#sequencing-depth-vs.-replicates",
    "title": "Transcriptomics with RNA-Seq",
    "section": "Sequencing depth vs.¬†replicates",
    "text": "Sequencing depth vs.¬†replicates\nFor statistical power, more replicates are better than a higher sequencing depth:\n\n\nFig. from Liu et al.¬†2014"
  },
  {
    "objectID": "pages/rnaseq.html#overview-of-steps",
    "href": "pages/rnaseq.html#overview-of-steps",
    "title": "Transcriptomics with RNA-Seq",
    "section": "Overview of steps",
    "text": "Overview of steps\n\nModified after Kukurba & Montgomery 2015"
  },
  {
    "objectID": "pages/rnaseq.html#from-reads-to-counts-overview",
    "href": "pages/rnaseq.html#from-reads-to-counts-overview",
    "title": "Transcriptomics with RNA-Seq",
    "section": "From reads to counts: overview",
    "text": "From reads to counts: overview\nYou will typically receive a ‚Äúdemultiplexed‚Äù (split-by-sample) set of FASTQ files.\nOnce you receive your data, the first series of analysis steps involves going from the raw reads to a count table (which will have a read count for each gene in each sample).\n\n\nThis part is bioinformatics-heavy with large files, a need for lots of computing power such as with a supercomputer, command-line (Unix shell) programs ‚Äî it specifically involves:\n\n\n\nRead preprocessing\nAligning reads to a reference genome (+ alignment QC)\nQuantifying expression levels\n\n\n\n\n\n\n\nThis can be run using standardized, one-size-fits-all workflows, and is therefore (relatively) suitable to be outsourced to a company, facility, or collaborator."
  },
  {
    "objectID": "pages/rnaseq.html#reads-to-counts-read-pre-processing",
    "href": "pages/rnaseq.html#reads-to-counts-read-pre-processing",
    "title": "Transcriptomics with RNA-Seq",
    "section": "Reads to counts: Read pre-processing",
    "text": "Reads to counts: Read pre-processing\nRead pre-processing includes the following steps:\n\n\nChecking the quantity and quality of your reads\n\nDoes not change your data, but helps decide next steps / sample exclusion\nAlso useful to check for contamination, library complexity, and adapter content\n\n\n\n\n\nRemoving unwanted sequences\n\nAdapters, low-quality bases, and very short reads\nrRNA-derived reads (optional)\nContaminant sequences (optional)"
  },
  {
    "objectID": "pages/rnaseq.html#reads-to-counts-alignment-to-a-reference-genome",
    "href": "pages/rnaseq.html#reads-to-counts-alignment-to-a-reference-genome",
    "title": "Transcriptomics with RNA-Seq",
    "section": "Reads to counts: alignment to a reference genome",
    "text": "Reads to counts: alignment to a reference genome\nThe alignment of reads to a reference genome needs to be ‚Äúsplice-aware‚Äù.\n\n\nBerge et al.¬†2019"
  },
  {
    "objectID": "pages/rnaseq.html#reads-to-counts-alignment-to-a-reference-genome-1",
    "href": "pages/rnaseq.html#reads-to-counts-alignment-to-a-reference-genome-1",
    "title": "Transcriptomics with RNA-Seq",
    "section": "Reads to counts: alignment to a reference genome",
    "text": "Reads to counts: alignment to a reference genome\nAlternatively, you can align to the transcriptome (i.e., all mature transcripts):\n\nBerge et al.¬†2019"
  },
  {
    "objectID": "pages/rnaseq.html#reads-to-counts-alignment-qc",
    "href": "pages/rnaseq.html#reads-to-counts-alignment-qc",
    "title": "Transcriptomics with RNA-Seq",
    "section": "Reads to counts: alignment QC",
    "text": "Reads to counts: alignment QC\n\nAlignment rates\nWhat percentage of reads was successfully aligned? (Should be &gt;80%)\n\n\n\n\nAlignment targets\nWhat percentages of aligned reads mapped to exons vs.¬†introns vs.¬†intergenic regions?\n\n\n\n\n\nWhat might cause high intronic mapping rates?\n\nAn abundance of pre-mRNA versus mature-mRNA.\n\n\n\n\n\nWhat might cause high intergenic mapping rates?\n\nDNA contamination or poor genome assembly/annotation quality"
  },
  {
    "objectID": "pages/rnaseq.html#reads-to-counts-quantification",
    "href": "pages/rnaseq.html#reads-to-counts-quantification",
    "title": "Transcriptomics with RNA-Seq",
    "section": "Reads to counts: quantification",
    "text": "Reads to counts: quantification\nAt heart, a simple counting exercise once you have the alignments in hand.\nBut made more complicated by sequencing biases and multi-mapping reads.\n\n\nCurrent best-performing tools (e.g.¬†Salmon) do transcript-level quantification ‚Äî even though this is typically followed by gene-level aggregation prior to downstream analysis.\n\n\n\n\n\n\n\n\n\nFast-moving field\n\n\nSeveral very commonly used tools like FeatureCounts (&gt;15k citations) and HTSeq (&lt;18k citations) have become disfavored in the past couple of years, as they e.g.¬†don‚Äôt count multi-mapping reads at all."
  },
  {
    "objectID": "pages/rnaseq.html#a-best-practice-workflow-to-produce-counts",
    "href": "pages/rnaseq.html#a-best-practice-workflow-to-produce-counts",
    "title": "Transcriptomics with RNA-Seq",
    "section": "A best-practice workflow to produce counts",
    "text": "A best-practice workflow to produce counts\nThe ‚Äúnf-core‚Äù initiative (https://nf-co.re) attempts to produce best-practice and automated workflows/pipelines, like for RNA-Seq (https://nf-co.re/rnaseq):"
  },
  {
    "objectID": "pages/rnaseq.html#count-table-analysis-overview",
    "href": "pages/rnaseq.html#count-table-analysis-overview",
    "title": "Transcriptomics with RNA-Seq",
    "section": "Count table analysis: overview",
    "text": "Count table analysis: overview\nThe second part of RNA-Seq data analysis involves analyzing the count table.\nIn contrast to the first part, this can be done on a laptop and instead is heavier on statistics, data visualization and biological interpretation.\n\n\nIt is typically done with the R languange, and common steps include:\n\nPrincipal Component Analysis (PCA)\nAssessing overall sample clustering patterns\nDifferential Expression (DE) analysis\nFinding genes that differ in expression level between sample groups (DEGs)\nFunctional enrichment analysis\nSee whether certain gene function groupings are overrepresented among DEGs"
  },
  {
    "objectID": "pages/rnaseq.html#pca",
    "href": "pages/rnaseq.html#pca",
    "title": "Transcriptomics with RNA-Seq",
    "section": "PCA",
    "text": "PCA\nA PCA analysis will help to visualize overall patterns of similarity among samples,\nfor example whether our groups of interest cluster:\n\n\nFig. 1 from Garrigos et al.¬†2023"
  },
  {
    "objectID": "pages/rnaseq.html#differential-expression-de-analysis",
    "href": "pages/rnaseq.html#differential-expression-de-analysis",
    "title": "Transcriptomics with RNA-Seq",
    "section": "Differential expression (DE) analysis",
    "text": "Differential expression (DE) analysis\nA Differential Expression (DE) analysis allows you to test, for every single expressed gene in your dataset, whether it significantly differs in expression level between groups.\n\nTypically, this is done with pairwise comparisons between groups:"
  },
  {
    "objectID": "pages/rnaseq.html#differential-expression-de-analysis-1",
    "href": "pages/rnaseq.html#differential-expression-de-analysis-1",
    "title": "Transcriptomics with RNA-Seq",
    "section": "Differential expression (DE) analysis",
    "text": "Differential expression (DE) analysis\nA Differential Expression (DE) analysis allows you to test, for every single expressed gene in your dataset, whether it significantly differs in expression level between groups.\nTypically, this is done with pairwise comparisons between groups:"
  },
  {
    "objectID": "pages/rnaseq.html#de-analysis-general-statistical-considerations",
    "href": "pages/rnaseq.html#de-analysis-general-statistical-considerations",
    "title": "Transcriptomics with RNA-Seq",
    "section": "DE analysis: general statistical considerations",
    "text": "DE analysis: general statistical considerations\n\nGene count normalization\nTo be able to fairly compare samples, raw gene counts need to be adjusted:\n\nBy library size, which is the total number of gene counts per sample\nBy library composition, e.g.¬†to correct for sample-specific extremely abundant genes that ‚Äústeal‚Äù most of that sample‚Äôs counts\n\n\n\n\n\nProbability distribution of the count data\n\nGene counts have higher variance than a Poisson distribution: negative binomial distribution is typically used.\nVariance (‚Äúdispersion‚Äù) estimates are gene-specific but ‚Äúborrow‚Äù information from other genes (details beyond the scope of this lecture)."
  },
  {
    "objectID": "pages/rnaseq.html#de-analysis-general-statistical-considerations-cont.",
    "href": "pages/rnaseq.html#de-analysis-general-statistical-considerations-cont.",
    "title": "Transcriptomics with RNA-Seq",
    "section": "DE analysis: general statistical considerations (cont.)",
    "text": "DE analysis: general statistical considerations (cont.)\n\nMultiple-testing correction\n\n10,000+ genes are independently tested during a DE analysis, so there is a dire need for multiple testing correction.\nThe standard method is the Benjamini-Hochberg (BH) method.\n\n\n\n\n\nLog2-fold changes (LFC) as a measure of expression difference\n\nWe‚Äôll discuss this in the lab.\n\n\n\n\n\n\n\n\n\n\n\nR packages to the rescue\n\n\nSpecialized R/Bioconductor packages like DESeq2 and EdgeR make differential expression analysis relatively straightforward and automatically take care of the abovementioned considerations (we will use DESeq2 in the lab)."
  },
  {
    "objectID": "pages/rnaseq.html#functional-enrichment-introduction",
    "href": "pages/rnaseq.html#functional-enrichment-introduction",
    "title": "Transcriptomics with RNA-Seq",
    "section": "Functional enrichment: introduction",
    "text": "Functional enrichment: introduction\nLists of DEGs can be quite long, and it is not always easy to make biological sense of them. Functional enrichment analyses help with this.\nFunctional enrichment analyses check whether certain functional categories of genes are statistically overrepresented among up- and/or downregulated genes.\n\n\nThere are a number of databases that group genes into functional categories, but the two main ones used for enrichment analysis are:\n\nGene Ontology (GO)\nKyoto Encyclopedia of Genes and Genomes (KEGG)"
  },
  {
    "objectID": "pages/rnaseq.html#functional-enrichment-go",
    "href": "pages/rnaseq.html#functional-enrichment-go",
    "title": "Transcriptomics with RNA-Seq",
    "section": "Functional enrichment: GO",
    "text": "Functional enrichment: GO\n\n\n\nGenes are assigned zero, one or more GO ‚Äúterms‚Äù\nHierarchical structure with more specific terms grouping into more general terms\nHighest-level grouping are the three ‚Äúontologies‚Äù: Biological Process, Molecular Function, Cellular Component\n\n\n\nFig. 4 from Garrigos et al.¬†2023"
  },
  {
    "objectID": "pages/rnaseq.html#functional-enrichment-kegg",
    "href": "pages/rnaseq.html#functional-enrichment-kegg",
    "title": "Transcriptomics with RNA-Seq",
    "section": "Functional enrichment: KEGG",
    "text": "Functional enrichment: KEGG\nKEGG focuses on pathways for cellular and organismal functions whose genes can be drawn and connected in maps.\n\n\n\n\n\n\n\nRodriguez et al.¬†2020: ‚ÄúKEGG representation of up-regulated genes related to jasmonic acid (JA) signal transduction pathways (ko04075) in banana cv. Calcutta 4 after inoculation with Pseudocercospora fijiensis. Genes or chemicals up-regulated at any time point were highlighted in green.‚Äù"
  },
  {
    "objectID": "pages/rnaseq.html#functional-enrichment-kegg-1",
    "href": "pages/rnaseq.html#functional-enrichment-kegg-1",
    "title": "Transcriptomics with RNA-Seq",
    "section": "Functional enrichment: KEGG",
    "text": "Functional enrichment: KEGG\n\nRodriguez et al.¬†2020"
  },
  {
    "objectID": "pages/DE.html#introduction",
    "href": "pages/DE.html#introduction",
    "title": "RNA-Seq differential expression analysis",
    "section": "1 Introduction",
    "text": "1 Introduction\n\n1.1 Recap\nLast week, you explored the RNA-Seq reads from Garrig√≥s et al. (2025) and the Culex pipiens reference genome files.\nIn yesterday‚Äôs lecture, you learned about the steps to generate a gene count table from this input data:\n\nRead preprocessing: QC, trimming, and optionally rRNA removal\nAlignment of reads to a reference genome (+ alignment QC)\nQuantification of expression levels\n\n\n\n1.2 Today‚Äôs goals\nI have performed the above steps for you already, and you will start with the output of step 3: a gene count table. With that gene count table, you will:\n\nCreate an R object that also incorporates the meta (sample) data\nPerform exploratory data analysis including a PCA\nRun a Differential Expression (DE) analysis\nExtract and visualize the DE results"
  },
  {
    "objectID": "pages/DE.html#getting-set-up",
    "href": "pages/DE.html#getting-set-up",
    "title": "RNA-Seq differential expression analysis",
    "section": "2 Getting set up",
    "text": "2 Getting set up\n\n2.1 Start an RStudio session at OSC\nStart an RStudio session at OSC like we did last week and like you did for this week‚Äôs homework:\n\nLog in to OSC at https://ondemand.osc.edu\nClick on Interactive Apps (top bar) and then RStudio Server (all the way at the bottom)\nFill out the form as follows:\n\nCluster: Pitzer\nR version: 4.4.0\nProject: PAS2880\nNumber of hours: 4\nNode type: any\nNumber of cores: 2\n\nClick the big blue Launch button at the bottom\nNow, you should be sent to a new page with a box at the top for your RStudio Server ‚Äújob‚Äù, which should initially be ‚ÄúQueued‚Äù (waiting to start).\nYour job should start running very soon, with the top bar of the box turning green and saying ‚ÄúRunning‚Äù.\nClick Connect to RStudio Server at the bottom of the box, and an RStudio Server instance will open in a new browser tab. You‚Äôre ready to go!\n\n\n\n2.2 Create an R script\nToday, you‚Äôre going to write most of your code in an R script instead of typing it directly in the R console, as explained in the R homework:\n\nCreate and open a new R script by clicking File (top menu bar) &gt; New File &gt; R Script.\nSave this new script right away by clicking File &gt; Save As. In the dialog box, you can save it right in the suggested folder (which is your OSC Home folder), or you can make a new folder for this course by clicking ‚ÄúNew Folder‚Äù in the bottom left. Regardless, save the script as lab4_DE.R (the extension for R scripts is .R).\n\n\n\n2.3 Load the R packages you will use\nAs part of your homework, you installed a few R packages with functionality you‚Äôll need in today‚Äôs lab.\nRecall that R packages behave equivalently to other software/apps, in that installation is a one-time thing, but you need to lead them in any given session to use them. Let‚Äôs start with that:\n\n\n\n\n\n\nHere, and with all the code in this lab, type or copy it in your script, and send it to the console from there. Recall that you can send code to the console by pressing Ctrl + Enter on Windows, or Cmd + Return on a Mac.\n\n\n\n\n# Then, load the R packages:\nlibrary(DESeq2)          # Differential expression analysis\nlibrary(EnhancedVolcano) # Volcano plot\nlibrary(tidyverse)       # Misc. data manipulation and plotting\n\nRunning the code above will produce output in the R console, and some of it in orange, but all should be good unless you see explicit errors at the bottom.\n\n\nClick to see expected output\n\n\n\nlibrary(tidyverse)\n\n‚îÄ‚îÄ Attaching core tidyverse packages ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ tidyverse 2.0.0 ‚îÄ‚îÄ\n‚úî dplyr     1.1.4     ‚úî readr     2.1.5\n‚úî forcats   1.0.1     ‚úî stringr   1.5.2\n‚úî ggplot2   4.0.0     ‚úî tibble    3.3.0\n‚úî lubridate 1.9.4     ‚úî tidyr     1.3.1\n‚úî purrr     1.1.0     \n‚îÄ‚îÄ Conflicts ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ tidyverse_conflicts() ‚îÄ‚îÄ\n‚úñ dplyr::filter() masks stats::filter()\n‚úñ dplyr::lag()    masks stats::lag()\n‚Ñπ Use the conflicted package (&lt;http://conflicted.r-lib.org/&gt;) to force all conflicts to become errors\n\nlibrary(DESeq2)\n\nLoading required package: S4Vectors\nLoading required package: stats4\nLoading required package: BiocGenerics\nLoading required package: generics\n\nAttaching package: 'generics'\n\nThe following object is masked from 'package:lubridate':\n\n    as.difftime\n\nThe following object is masked from 'package:dplyr':\n\n    explain\n\nThe following objects are masked from 'package:base':\n\n    as.difftime, as.factor, as.ordered, intersect, is.element, setdiff,\n    setequal, union\n\n\nAttaching package: 'BiocGenerics'\n\nThe following object is masked from 'package:dplyr':\n\n    combine\n\nThe following objects are masked from 'package:stats':\n\n    IQR, mad, sd, var, xtabs\n\nThe following objects are masked from 'package:base':\n\n    anyDuplicated, aperm, append, as.data.frame, basename, cbind,\n    colnames, dirname, do.call, duplicated, eval, evalq, Filter, Find,\n    get, grep, grepl, is.unsorted, lapply, Map, mapply, match, mget,\n    order, paste, pmax, pmax.int, pmin, pmin.int, Position, rank,\n    rbind, Reduce, rownames, sapply, saveRDS, table, tapply, unique,\n    unsplit, which.max, which.min\n\n\nAttaching package: 'S4Vectors'\n\nThe following objects are masked from 'package:lubridate':\n\n    second, second&lt;-\n\nThe following objects are masked from 'package:dplyr':\n\n    first, rename\n\nThe following object is masked from 'package:tidyr':\n\n    expand\n\nThe following object is masked from 'package:utils':\n\n    findMatches\n\nThe following objects are masked from 'package:base':\n\n    expand.grid, I, unname\n\nLoading required package: IRanges\n\nAttaching package: 'IRanges'\n\nThe following object is masked from 'package:lubridate':\n\n    %within%\n\nThe following objects are masked from 'package:dplyr':\n\n    collapse, desc, slice\n\nThe following object is masked from 'package:purrr':\n\n    reduce\n\nLoading required package: GenomicRanges\nLoading required package: GenomeInfoDb\nLoading required package: SummarizedExperiment\nLoading required package: MatrixGenerics\nLoading required package: matrixStats\n\nAttaching package: 'matrixStats'\n\nThe following object is masked from 'package:dplyr':\n\n    count\n\n\nAttaching package: 'MatrixGenerics'\n\nThe following objects are masked from 'package:matrixStats':\n\n    colAlls, colAnyNAs, colAnys, colAvgsPerRowSet, colCollapse,\n    colCounts, colCummaxs, colCummins, colCumprods, colCumsums,\n    colDiffs, colIQRDiffs, colIQRs, colLogSumExps, colMadDiffs,\n    colMads, colMaxs, colMeans2, colMedians, colMins, colOrderStats,\n    colProds, colQuantiles, colRanges, colRanks, colSdDiffs, colSds,\n    colSums2, colTabulates, colVarDiffs, colVars, colWeightedMads,\n    colWeightedMeans, colWeightedMedians, colWeightedSds,\n    colWeightedVars, rowAlls, rowAnyNAs, rowAnys, rowAvgsPerColSet,\n    rowCollapse, rowCounts, rowCummaxs, rowCummins, rowCumprods,\n    rowCumsums, rowDiffs, rowIQRDiffs, rowIQRs, rowLogSumExps,\n    rowMadDiffs, rowMads, rowMaxs, rowMeans2, rowMedians, rowMins,\n    rowOrderStats, rowProds, rowQuantiles, rowRanges, rowRanks,\n    rowSdDiffs, rowSds, rowSums2, rowTabulates, rowVarDiffs, rowVars,\n    rowWeightedMads, rowWeightedMeans, rowWeightedMedians,\n    rowWeightedSds, rowWeightedVars\n\nLoading required package: Biobase\nWelcome to Bioconductor\n\n    Vignettes contain introductory material; view with\n    'browseVignettes()'. To cite Bioconductor, see\n    'citation(\"Biobase\")', and for packages 'citation(\"pkgname\")'.\n\n\nAttaching package: 'Biobase'\n\nThe following object is masked from 'package:MatrixGenerics':\n\n    rowMedians\n\nThe following objects are masked from 'package:matrixStats':\n\n    anyMissing, rowMedians\n\nlibrary(EnhancedVolcano)\n\nLoading required package: ggrepel"
  },
  {
    "objectID": "pages/DE.html#create-a-deseq2-object",
    "href": "pages/DE.html#create-a-deseq2-object",
    "title": "RNA-Seq differential expression analysis",
    "section": "3 Create a DESeq2 object",
    "text": "3 Create a DESeq2 object\nLike in Garrig√≥s et al. (2025), you‚Äôll perform a Principal Component Analysis (PCA) and a Differential Expression (DE) analysis. To do so, you‚Äôll use the DESeq2 R package (Love, Huber, and Anders (2014), website).\nDESeq2 has its own ‚Äúobject type‚Äù (a specific R format type) and before you can do anything else, you need to create a DESeq2 object from three components:\n\nSample metadata\nThis table should contain information on which samples belong to which groups that should be compared (i.e., the experiment‚Äôs ‚Äúindependent variables‚Äù).\nCount table\nA table with one row per gene, and one column per sample.\nA statistical design\nA statistical design formula to tell DESEq2 which groups to compare\n\n\n3.1 Sample metadata\nFirst, you‚Äôll load the sample metadata from the same file you saw last week. To do so, use the read_tsv() function you also saw in the homework ‚Äì this reads a TSV (Tab-Separated Values) file into a dataframe:\n\nmeta_raw &lt;- read_tsv(\"/fs/scratch/PAS2880/ENT6703/data/meta/metadata.tsv\")\n\nLet‚Äôs take a look at the resulting dataframe with the View() function:\n\n# View() will open the dataframe in a spreadsheet like view\nView(meta_raw)\n\n\n\n# A tibble: 22 √ó 3\n   sample_id     dpi treatment  \n   &lt;chr&gt;       &lt;dbl&gt; &lt;chr&gt;      \n 1 ERR10802864     1 cathemerium\n 2 ERR10802867     1 cathemerium\n 3 ERR10802870     1 cathemerium\n 4 ERR10802866     1 control    \n 5 ERR10802869     1 control    \n 6 ERR10802863     1 control    \n 7 ERR10802871     1 relictum   \n 8 ERR10802874     1 relictum   \n 9 ERR10802865     1 relictum   \n10 ERR10802868     1 relictum   \n11 ERR10802882    10 cathemerium\n12 ERR10802875    10 cathemerium\n13 ERR10802879    10 cathemerium\n14 ERR10802883    10 cathemerium\n15 ERR10802878    10 control    \n16 ERR10802884    10 control    \n17 ERR10802877    10 control    \n18 ERR10802881    10 control    \n19 ERR10802876    10 relictum   \n20 ERR10802880    10 relictum   \n21 ERR10802885    10 relictum   \n22 ERR10802886    10 relictum   \n\n\n\n Exercise: Interpret the metadata\nBased on the information in the table, try to understand the experimental design. How many timepoints and treatments are there? How many biological replicates?\n\n\nClick to see the solution\n\n\nThe dpi column has the number of Days Post Infection (i.e., timepoints): either 1 or 10 days.\nThe treatment column contains the treatment: which Plasmodium species, or ‚Äúcontrol‚Äù (not infected).\nAll in all, there are 3 treatments across each of 2 timepoints, with 3-4 replicates per treatment-timepoint combination.\n\n\n\n\nYou‚Äôll now have to make some modifications to the metadata table so that it can be used in DESeq2:\n\nThe table should be sorted by sample ID: you can use the arrange() function to do so\nThe sample IDs should be row names, not a separate column: we can use the column_to_rownames() function for this\n\n\n# The input is the raw metadata dataframe ('meta_raw'),\n# and we'll store the output in a new, processed dataframe ('meta'):\nmeta &lt;- meta_raw |&gt;\n  # By converting 'treatment' columns into a \"factor\",\n  # you can provide a custom order that will be respected in the plot -\n  # this, way 24h comes before 10d, and control before the two infections.\n  mutate(\n    dpi = factor(dpi, levels = c(1, 10)),\n    treatment = factor(treatment, levels = c(\"control\", \"cathemerium\", \"relictum\"))\n  ) |&gt;\n  # 1. Sort the table by 'sample_id' column:\n  arrange(sample_id) |&gt;\n  # 2. Turn the 'sample_id' column into row names:\n  column_to_rownames(\"sample_id\")\n\n\n# Take a look at the first 6 rows\nhead(meta)\n\n            dpi   treatment\nERR10802863   1     control\nERR10802864   1 cathemerium\nERR10802865   1    relictum\nERR10802866   1     control\nERR10802867   1 cathemerium\nERR10802868   1    relictum\n\n\nIn the two outputs above, note the difference between having the sample IDs as a separate column versus as row names. This is a minor and uninteresting technical difference, but DESeq2 simply expects the sample IDs to be row names.\n\n\n\n\n\n\nWhen analyzing data sets, such modifications (‚Äúdata wrangling‚Äù) are quite common and can take up more time and space than the actual analysis itself. Which is one reason we‚Äôre including these steps in the lab.\n\n\n\n\n\n3.2 Count table\nI produced a gene count table for you by running the nf-core rnaseq pipeline on the input data you saw last week (FASTQ reads and reference genome files).\nLoad this count table into R:\n\ncount_df &lt;- read_tsv(\"/fs/scratch/PAS2880/ENT6703/results/counts.tsv\")\n\nTake a look at the first 6 rows:\n\nhead(count_df)\n\n# A tibble: 6 √ó 24\n  gene_id gene_name ERR10802863 ERR10802864 ERR10802865 ERR10802866 ERR10802867\n  &lt;chr&gt;   &lt;chr&gt;           &lt;dbl&gt;       &lt;dbl&gt;       &lt;dbl&gt;       &lt;dbl&gt;       &lt;dbl&gt;\n1 ATP6    ATP6         10275.       8255.       4103.      18615.      11625.  \n2 ATP8    ATP8             3.85        2.92        2.33        7.76        7.01\n3 COX1    COX1         88041.      83394.      36975.     136054.     130863.  \n4 COX2    COX2          8749.       7925.       2901.      16802.      10026.  \n5 COX3    COX3         55772.      50312.      35074.      80510.      69850.  \n6 CYTB    CYTB         38543.      36352.      22185.      62147.      57461.  \n# ‚Ñπ 17 more variables: ERR10802868 &lt;dbl&gt;, ERR10802869 &lt;dbl&gt;, ERR10802870 &lt;dbl&gt;,\n#   ERR10802871 &lt;dbl&gt;, ERR10802874 &lt;dbl&gt;, ERR10802875 &lt;dbl&gt;, ERR10802876 &lt;dbl&gt;,\n#   ERR10802877 &lt;dbl&gt;, ERR10802878 &lt;dbl&gt;, ERR10802879 &lt;dbl&gt;, ERR10802880 &lt;dbl&gt;,\n#   ERR10802881 &lt;dbl&gt;, ERR10802882 &lt;dbl&gt;, ERR10802883 &lt;dbl&gt;, ERR10802884 &lt;dbl&gt;,\n#   ERR10802885 &lt;dbl&gt;, ERR10802886 &lt;dbl&gt;\n\n\nHere, too, we have to make several modifications ‚Äì DESeq2 expects that the count table:\n\nHas gene IDs as row names\nDoes not contain any non-numeric columns\nContains integer (whole-number, rounded) values\nIs a ‚Äúmatrix‚Äù, a slighly different object type from a dataframe\n\n\ncount_mat &lt;- count_df |&gt;\n  # 1. Turn the 'gene_id' column into row names:\n  column_to_rownames(\"gene_id\") |&gt;\n  # 2. Remove a remaining non-numeric column (which has gene names):\n  select(-gene_name) |&gt;\n  # 3. Round everything to whole numbers:\n  round() |&gt;\n  # 4. Convert it to a formal 'matrix' format:\n  as.matrix()\n\nLet‚Äôs once again take a look at the first 6 rows:\n\nhead(count_mat)\n\n     ERR10802863 ERR10802864 ERR10802865 ERR10802866 ERR10802867 ERR10802868\nATP6       10275        8255        4103       18615       11625        7967\nATP8           4           3           2           8           7           2\nCOX1       88041       83394       36975      136054      130863       62279\nCOX2        8749        7925        2901       16802       10026        6701\nCOX3       55772       50312       35074       80510       69850       42478\nCYTB       38543       36352       22185       62147       57461       28159\n     ERR10802869 ERR10802870 ERR10802871 ERR10802874 ERR10802875 ERR10802876\nATP6       12788        4408       13648       13834        1346       10032\nATP8           2           0           2           1           3           2\nCOX1      109596      106402      104394       77682       38276       78290\nCOX2       11494        6603       11151        9893        1473       13146\nCOX3       68228       71945       66900       52368       14665       37275\nCYTB       46219       52035       46090       35247       17449       38762\n     ERR10802877 ERR10802878 ERR10802879 ERR10802880 ERR10802881 ERR10802882\nATP6         987        1834        3337        5036        1983       11586\nATP8           0           0           0           3           0          27\nCOX1       17785       32099       64490       63960       50965       76113\nCOX2        1141        1907        3439        8334        2063       12752\nCOX3        8797       15948       26278       29997       17802       35419\nCYTB       11177       22262       34368       33401       25854       43912\n     ERR10802883 ERR10802884 ERR10802885 ERR10802886\nATP6       18821        2792       11749        6682\nATP8          40           0           8           1\nCOX1      108343       65829      107741       94682\nCOX2       19148        2713       17947       10656\nCOX3       51441       24915       50029       47750\nCYTB       57844       34616       50587       51198\n\n\n\n\n\n\n\n\nBonus: Check that the sample IDs match (Click to expand)\n\n\n\n\n\nWhen creating the DESeq2 object, DESeq2 assumes that sample IDs in the metadata and count tables completely match (no extra/missing samples in either table), and are provided in the same order. Let‚Äôs make sure this is indeed the case:\n\nall(rownames(meta) == colnames(count_mat))\n\n[1] TRUE\n\n\n\n\n\n\n\n3.3 Create the DESeq2 object\nYou will create the DESeq2 object using the function DESeqDataSetFromMatrix(), which requires three arguments corresponding to the components discussed above:\n\nThe metadata with argument colData.\nThe count data with argument countData.\nThe statistical design for the DE analysis with argument design. For now, you will specify ~1, which effectively means ‚Äúno design‚Äù ‚Äî you will change this before the actual DE analysis.\n\n\n# (`dds` is a name commonly used for DESeq2 objects, short for \"DESeq Data Set\")\ndds &lt;- DESeqDataSetFromMatrix(\n  colData = meta,\n  countData = count_mat,\n  design = ~ 1\n  )\n\nconverting counts to integer mode\n\n\nBefore running the differential expression analysis, though, let‚Äôs do a bit of exploratory data analysis."
  },
  {
    "objectID": "pages/DE.html#exploratory-data-analysis",
    "href": "pages/DE.html#exploratory-data-analysis",
    "title": "RNA-Seq differential expression analysis",
    "section": "4 Exploratory Data Analysis",
    "text": "4 Exploratory Data Analysis\n\n4.1 The count table\nWhat are the number of rows (=number of genes) and columns (=number of samples) of your gene expression count matrix?\n\ndim(count_mat)\n\n[1] 18855    22\n\n\nSo, we have 18855 genes and 22 samples.\nHow do the ‚Äúlibrary sizes‚Äù, i.e.¬†the summed per-sample gene counts, compare across samples? To see this, you can compute column sums (recall: columns are samples) using the colSums() function:\n\ncolSums(count_mat)\n\nERR10802863 ERR10802864 ERR10802865 ERR10802866 ERR10802867 ERR10802868 \n   24297245    17177436    22745445    26849403    21471477    17506262 \nERR10802869 ERR10802870 ERR10802871 ERR10802874 ERR10802875 ERR10802876 \n   24299398    25490128    26534405    22194841    18927885    28804150 \nERR10802877 ERR10802878 ERR10802879 ERR10802880 ERR10802881 ERR10802882 \n    9498249    14807513    20667093    23107463    17545375    19088206 \nERR10802883 ERR10802884 ERR10802885 ERR10802886 \n   21418234    19420046    24367372    25452228 \n\n\nOK, that looks like a lot, but is not so easy to read / interpret. Let‚Äôs convert these numbers:\n\nTo whole millions: divide by 1,000,000 and round (round()) the result\nSorted from low to high (sort())\n\n\nsort(round(colSums(count_mat) / 1000000))\n\nERR10802877 ERR10802878 ERR10802864 ERR10802868 ERR10802881 ERR10802875 \n          9          15          17          18          18          19 \nERR10802882 ERR10802884 ERR10802867 ERR10802879 ERR10802883 ERR10802874 \n         19          19          21          21          21          22 \nERR10802865 ERR10802880 ERR10802863 ERR10802869 ERR10802885 ERR10802870 \n         23          23          24          24          24          25 \nERR10802886 ERR10802866 ERR10802871 ERR10802876 \n         25          27          27          29 \n\n\n\n\n\n\n\n\nBonus: How many genes have non-zero counts? (Click to expand)\n\n\n\n\n\nHow many genes have total (= across all samples) counts that are non-zero?\nTo compute this, you can:\n\nUse rowSums() to compute total counts per gene (rows are genes)\nSubset the count matrix with [ ] to only those genes with total counts &gt; 0\nCount the number of rows in that subsetted matrix with nrow()\n\nAll in one line:\n\nnrow(count_mat[rowSums(count_mat) &gt; 0, ])\n\n[1] 17788\n\n\n\n\n\nYour turn: How many genes have total counts of at least 10? (Click to see the solution)\n\n\nnrow(count_mat[rowSums(count_mat) &gt;= 10, ])\n\n[1] 16682\n\n\n\n\n\nYour turn: How many genes have mean counts of at least 10? (Click to see the solution)\n\nNow you need to divide by the number of samples. This is the number of columns, which you can get with ncol()\n\nnrow(count_mat[rowSums(count_mat) / ncol(count_mat) &gt;= 10, ])\n\n[1] 12529\n\n\n\n\n\n\n\n\n4.2 Principal Component Analysis (PCA)\nYou will now run a PCA to look for overall patterns of (dis)similarity among samples. This will help answer questions like:\n\nDo the samples cluster by treatment (infection status) and/or time point?\nWhich of these two variables has a greater effect on overall patterns of gene expression?\nIs there an overall interaction between these two variables?\n\nFirst, you have to normalize the count data to account for differences in library size among samples and to ‚Äústabilize‚Äù the variance among genes1:\n\ndds_vst &lt;- varianceStabilizingTransformation(dds)\n\nThe authors of the study did this as well:\n\nWe carried out a Variance Stabilizing Transformation (VST) of the counts to represent the samples on a PCA plot.\n\nNext, you can run and plot the PCA with a single function call, plotPCA from DESeq2:\n\n# With 'intgroup', you specify the variables (columns) to color samples by\nplotPCA(dds_vst, intgroup = c(\"dpi\", \"treatment\"))\n\nusing ntop=500 top features by variance\n\n\nWarning: `aes_string()` was deprecated in ggplot2 3.0.0.\n‚Ñπ Please use tidy evaluation idioms with `aes()`.\n‚Ñπ See also `vignette(\"ggplot2-in-packages\")` for more information.\n‚Ñπ The deprecated feature was likely used in the DESeq2 package.\n  Please report the issue to the authors.\n\n\n\n\n\n\n\n\n\n\n Exercise: Interpret the PCA result\n\nBased on the above PCA plot, try to answer the three questions asked at the beginning of this PCA section.\nHow does your plot compare to the PCA plot in the paper (Figure 1), in terms of the conclusions you drew in the previous question?\n\n\nClick to see the paper‚Äôs Figure 1\n\n\n\n\n\n\n\n\n\n\n\n\n Bonus exercise 1: Number of genes in the PCA\nBy default, the PCA run by plotPCA() does not summarize the variation in all genes, but only in the top 500 most variable genes. This tends to be a good representation of overall patterns, but it can be a good idea to check how robust the results are to this choice.\nThe plotPCA() function has an argument to change the number of included genes.\n\nFigure out what the name of this argument is by check the help for the function.\n(Hint: run ?plotPCA in the R console)\nPlay around with different numbers of included genes (e.g., 100, 1000, all genes), and see how this affects the PCA plot.\n\nTODO - ADD SOLUTION\n\n\n Bonus exercise 2: Make a better PCA plot\nCustomize the PCA plot to make it better-looking and clearer.\nFor example, in the plot we made above, each combination of time point and treatment has a distinct color. But it would be better to use point color only to distinguish one of the variables, and point shape to distinguish the other variable, as was done in the paper‚Äôs Fig. 1.\nFirst, you‚Äôll need to get the data in a format that you can use to build the plot from scratch. You can do this by using the returnData = TRUE argument of the plotPCA() function (check the first solution below for more details if needed).\nThen, the plot customization will require some knowledge of ggplot2. If you don‚Äôt know how to do this yet, you can also try to use generative AI (Microsoft Copilot, ChatGPT, etc.) to help you write the code.\n\n\nPartial solution: getting the dataframe\n\nTo be able to customize the plot properly, it‚Äôs best to build it from scratch ourselves, rather than using the plotPCA function. But then how do we get the input data in the right shape?\nA nice trick is that we can use returnData = TRUE in the plotPCA function, to get plot-ready formatted data instead of an actual plot:\n\npca_df &lt;- plotPCA(\n  dds_vst,\n  ntop = 500,\n  intgroup = c(\"dpi\", \"treatment\"),\n  returnData = TRUE\n  )\n\nusing ntop=500 top features by variance\n\n\n\n\n\nClick to see a possible solution\n\n\npca_df |&gt;\n  ggplot(aes(x = PC1, y = PC2, color = treatment, shape = dpi)) +\n  geom_point(size = 5) +\n  scale_color_brewer(palette = \"Dark2\", name = \"Infection status\") +\n  scale_shape(name = \"Time points\") +\n  theme_bw() +\n  theme(panel.grid.minor = element_blank())\n\n\n\n\n\n\n\n\nLet‚Äôs improve this plot in two ways:\n\nAdding the percentage of variance explained by each principal component to the axes labels.\n\n\n# First extract and store the percentage of variance explained by different\n# principal components, so you can later add this information to the plot:\npct_var &lt;- round(100 * attr(pca_df, \"percentVar\"), 1)\npct_var\n\n[1] 85.3  3.1\n\npca_df |&gt; \n  ggplot(aes(x = PC1, y = PC2, color = treatment, shape = dpi)) +\n  geom_point(size = 5) +\n  labs(\n    x = paste0(\"PC1 (\", pct_var[1], \"%)\"),\n    y = paste0(\"PC2 (\", pct_var[2], \"%)\")\n    ) +\n  scale_color_brewer(palette = \"Dark2\", name = \"Infection status\") +\n  scale_shape(name = \"Time points\") +\n  theme_bw() +\n  theme(panel.grid.minor = element_blank())\n\n\n\n\n\n\n\n\n\nImproving the order of the legend items: 24 hours should come before 10 days, and the control treatment is best presented first.\n\n\n# First, modify the factor levels in the PCA dataframe:\npca_df |&gt;\n  ggplot(aes(x = PC1, y = PC2, color = treatment, shape = dpi)) +\n  geom_point(size = 5) +\n  labs(\n    x = paste0(\"PC1 (\", pct_var[1], \"%)\"),\n    y = paste0(\"PC2 (\", pct_var[2], \"%)\")\n    ) +\n  scale_color_brewer(palette = \"Dark2\", name = \"Infection status\") +\n  scale_shape(name = \"Time points\") +\n  theme_bw() +\n  theme(panel.grid.minor = element_blank())"
  },
  {
    "objectID": "pages/DE.html#differential-expression-de-analysis",
    "href": "pages/DE.html#differential-expression-de-analysis",
    "title": "RNA-Seq differential expression analysis",
    "section": "5 Differential Expression (DE) analysis",
    "text": "5 Differential Expression (DE) analysis\n\n5.1 Figuring out how to do the analysis\nFirst, let‚Äôs see how the DE analysis was done in the paper:\n\nThen, we used the DESeq2 package (Love et al., 2014) to perform the differential gene expression analysis comparing: (i) P. relictum-infected mosquitoes vs.¬†controls, (ii) P. cathemerium-infected mosquitoes vs.¬†controls, and (iii) P. relictum-infected mosquitoes vs.¬†P. cathemerium-infected mosquitoes.\n\nThis is not terribly detailed and could be interpreted in a couple of different ways. For example, they may have compared infection statuses by ignoring time points or by controlling for time points in various ways.\nIgnoring time would mean analyzing the full dataset (all time points) while only using the infection status as an independent variable, i.e.¬†using the design ~treatment.\n\n Your Turn\nGiven the PCA results, do you think we can ignore the dpi variable?\n\n\nClick to see the answer\n\nTODO ADD SOLUTION\n\n\nControlling for time can be done in two ways:\n\nAn analysis with two independent variables (factors): ~ dpi + treatment\nPairwise comparisons between each combination of dpi and treatment\n\nIf you take a look at Table 1 with the DE results, it should become clearer how they did their analysis:\n\n\n\n\n\n\n Your Turn\nHow do you interpret this: did they run pairwise comparisons or a two-factor model?\n\n\nClick to see the answer\n\nIt looks like they performed pairwise comparisons between each combination of dpi and treatment.\n\n\nThat brings us a step closer, but pairwise comparisons with more than independent variable can (also!) be done in two ways (and it‚Äôs not clear from the paper which they used):\n\nAfter subsetting the dataset to each combination of dpi and treatment.\nAfter creating a single, combined independent variable that is a combination of time and treatment.\n\nThe latter method is the more common one, and is what we will use below.\n\n\n5.2 Setting the statistical design\nYou will now create a new variable that is a combination of treatment and dpi, and call it group:\n\n# Create a combined variable called 'group':\ngroup &lt;- paste(dds$treatment, dds$dpi, sep = \"_\")\n\n# Turn this into a 'factor' and add it to the DESeq2 object:\n# (Factors are a common R data type for categorical variables, and required by DESeq2)\ndds$group &lt;- factor(group)\n\nTake a look at the variable you created:\n\ndds$group\n\n [1] control_1      cathemerium_1  relictum_1     control_1      cathemerium_1 \n [6] relictum_1     control_1      cathemerium_1  relictum_1     relictum_1    \n[11] cathemerium_10 relictum_10    control_10     control_10     cathemerium_10\n[16] relictum_10    control_10     cathemerium_10 cathemerium_10 control_10    \n[21] relictum_10    relictum_10   \n6 Levels: cathemerium_1 cathemerium_10 control_1 control_10 ... relictum_10\n\n\nWhich unique values does group have, and how many samples are in each? We can use the table() function for this:\n\ntable(dds$group)\n\n\n cathemerium_1 cathemerium_10      control_1     control_10     relictum_1 \n             3              4              3              4              4 \n   relictum_10 \n             4 \n\n\nNext, set the analysis design:\n\n# Note: the symbol before 'group' is a tilde, ~ \ndesign(dds) &lt;- ~ group\n\nPhew, now you‚Äôre finally ready to run the DE analysis!\n\n\n5.3 Running the DE analysis\nWhile you had to do a lot of prep to get here, actually running the DE analysis is very simple. It can be done with the function DESeq(), and we only need to give it the DESeq2 object, since the analysis options are already specified in the object itself:\n\n# (Note that the output is assigned back to the same `dds` object -\n#  the DE results are added to it)\ndds &lt;- DESeq(dds)\n\nestimating size factors\n\n\nestimating dispersions\n\n\ngene-wise dispersion estimates\n\n\nmean-dispersion relationship\n\n\nfinal dispersion estimates\n\n\nfitting model and testing\n\n\nThe DESeq() function performs three steps consecutively:\n\n‚ÄúNormalization‚Äù by library size and composition\nEstimation of gene-wise variance in counts (‚Äúdispersion‚Äù)\nFitting the statistical model (a negative binomial GLM) and calculating the test statistics\n\nA key thing to understand is that above, DESeq2 automatically performed pairwise comparisons between each of the (6) levels of the group variable. This means that for any individual gene, it tested whether the gene is differentially expressed separately for each of these pairwise comparisons.\nTODO - VISUALIZE THIS?"
  },
  {
    "objectID": "pages/DE.html#extracting-the-de-results",
    "href": "pages/DE.html#extracting-the-de-results",
    "title": "RNA-Seq differential expression analysis",
    "section": "6 Extracting the DE results",
    "text": "6 Extracting the DE results\nDESeq2 stores the results as a separate table for each pairwise comparison. Now, you‚Äôll extract one of these tables.\n\n6.1 The results table\nYou can extract the results for one pairwise comparison (which DESeq2 refers to as a contrast) at a time, by specifying it with the contrast argument as a vector of length 3:\n\nThe focal independent variable (here, group)\nThe first (reference) level of the independent variable (in the example below, relictum_1)\nThe second level of the independent variable (in the example below, control_1)\n\n\nfocal_contrast &lt;- c(\"group\", \"relictum_1\", \"control_1\")\nres_rc1 &lt;- results(dds, contrast = focal_contrast)\n\nhead(res_rc1)\n\nlog2 fold change (MLE): group relictum_1 vs control_1 \nWald test p-value: group relictum_1 vs control_1 \nDataFrame with 6 rows and 6 columns\n       baseMean log2FoldChange     lfcSE      stat    pvalue      padj\n      &lt;numeric&gt;      &lt;numeric&gt; &lt;numeric&gt; &lt;numeric&gt; &lt;numeric&gt; &lt;numeric&gt;\nATP6  7658.0445      -0.416305  0.609133 -0.683438 0.4943300  0.776172\nATP8     4.9196      -1.311116  1.388811 -0.944057 0.3451408        NA\nCOX1 75166.8670      -0.590935  0.282075 -2.094958 0.0361747  0.208045\nCOX2  7807.1848      -0.610152  0.578401 -1.054893 0.2914743  0.615249\nCOX3 41037.7359      -0.400173  0.251760 -1.589498 0.1119479  0.388880\nCYTB 36916.6130      -0.501653  0.261927 -1.915242 0.0554617  0.266528\n\n\nWhat do the columns in this table contain?\n\nbaseMean: Mean expression level across all samples.\nlog2FoldChange: The ‚Äúlog2-fold change‚Äù of gene counts between the compared levels.\nlfcSE: The uncertainty in terms of the standard error (SE) of the log2-fold change estimate.\nstat: The value for the Wald test‚Äôs test statistic.\npvalue: The uncorrected p-value from the Wald test.\npadj: The multiple-testing corrected p-value (i.e., adjusted p-value).\n\n\n\n\n\n\n\nMultiple testing correction\n\n\n\nBecause you are testing significance for many genes, you need to correct for multiple testing. This can be done in multiple ways, but DESeq2 uses the Benjamini-Hochberg False Discovery Rate (FDR) correction. For more info, see this StatQuest video.\n\n\n\n\n6.2 Log2-fold changes (LFCs)\nIn RNA-Seq analysis, log2-fold changes (LFCs) are the standard way of representing the magnitude (effect size) of expression level differences between two groups of interest. With A and B being the compared sample groups, the LFC is calculated as:\nlog2(mean of A / mean of B)\nDue the log-transformation, the LFC also increase more slowly than a raw fold-change:\n\nAn LFC of 1 indicates a 2-fold difference\nAn LFC of 2 indicates a 4-fold difference\nAn LFC of 3 indicates a 8-fold difference\n\nA nice property of LFC is that decreases and increases in expression are expressed symmetrically:\n\nAn LFC of 1 means that group A has a two-fold higher expression that group B\nAn LFC of -1 means that group A has a two-fold lower expression that group B\n\n\n\n6.3 Numbers of differentially expressed genes (DEGs)\nHow many adjusted p-values were less than 0.05 ‚Äì i.e., significant?\n\n# (We need 'na.rm = TRUE' because some p-values are 'NA')\n# (If we don't remove NAs from the calculation, sum() will just return NA)\nsum(res_rc1$padj &lt; 0.05, na.rm = TRUE)\n\n[1] 801\n\n\nThis means that you found 801 Differentially Expressed Genes (DEGs) for this specific pairwise comparison.\n\n Exercise: DEG numbers\nThe paper‚Äôs Table 1 (which we saw above) reports the number of DEGs for a variety of comparisons.\n\nHow does the number of DEGs we just got compare to what they found in the paper for this comparison?\nThe table also reports numbers of up- and downregulated genes separately. Can you get those numbers for your DE results?\n\n\n\nClick to see the solution\n\n\n\nOption 1: Solution using tidyverse/dplyr:\n\n\n# First convert the results table into a regular data frame:\nas.data.frame(res_rc1) |&gt;\n  # Then, only select the rows/genes that are significant:\n  filter(padj &lt; 0.05) |&gt;\n  # If you run count() on a logical test, you get the nrs. that are FALSE v. TRUE\n  dplyr::count(log2FoldChange &gt; 0)\n\n  log2FoldChange &gt; 0   n\n1              FALSE 616\n2               TRUE 185\n\n\n\nOption 2: Solution using base R:\n\n\n# Down-regulated (relictum &lt; control):\nsum(res_rc1$log2FoldChange &lt; 0 & res_rc1$padj &lt; 0.05, na.rm = TRUE)\n\n[1] 616\n\n# Up-regulated (relictum &gt; control):\nsum(res_rc1$log2FoldChange &gt; 0 & res_rc1$padj &lt; 0.05, na.rm = TRUE)\n\n[1] 185\n\n\n\n\n\n Bonus exercise: more DEGs\n\nThe table also reports the number of DEGs with an absolute LFC &gt; 1. Can you get those numbers for your DE results?\n\n\n\nClick to see the solution\n\n\n\nOption 1: Solution using tidyverse/dplyr:\n\n\n# First we need to convert the results table into a regular data frame\nas.data.frame(res_rc1) |&gt;\n  # Then we only select the rows/genes that are significant\n  filter(padj &lt; 0.05, abs(log2FoldChange) &gt; 1) |&gt;\n  # If we run count() on a logical test, we get the nrs. that are FALSE v. TRUE\n  dplyr::count(log2FoldChange &gt; 0)\n\n  log2FoldChange &gt; 0   n\n1              FALSE 159\n2               TRUE  49\n\n\n\nOption 2: Solution using base R:\n\n\n# Down-regulated (relictum &lt; control):\nsum(res_rc1$log2FoldChange &lt; -1 & res_rc1$padj &lt; 0.05, na.rm = TRUE)\n\n[1] 159\n\n# Up-regulated (relictum &gt; control):\nsum(res_rc1$log2FoldChange &gt; 1 & res_rc1$padj &lt; 0.05, na.rm = TRUE)\n\n[1] 49\n\n\n\n\nExtract the results for one or more other contrasts in the table, and compare the results."
  },
  {
    "objectID": "pages/DE.html#de-result-visualizations",
    "href": "pages/DE.html#de-result-visualizations",
    "title": "RNA-Seq differential expression analysis",
    "section": "7 DE result visualizations",
    "text": "7 DE result visualizations\nYou will create a few plots for the relictum_24h vs. control_24h comparison results, which you extracted above.\n\n7.1 Volcano plot\nFor a nice overview of the results, you can create a so-called ‚Äúvolcano plot‚Äù using the EnhancedVolcano() function from the package of the same name (see here for a ‚Äúvignette‚Äù / tutorial):\n\nEnhancedVolcano(\n  toptable = res_rc1,      # DESeq2 results to plot   \n  title = \"relictum vs. control at 24 hpi\",\n  x = \"log2FoldChange\",     # Plot the log2-fold change along the x-axis\n  y = \"padj\",               # Plot the p-value along the y-axis\n  lab = rownames(res_rc1), # Use the rownames for the gene labels (though see below)\n  labSize = 0               # Omit gene labels for now\n  )\n\nWarning: Using `size` aesthetic for lines was deprecated in ggplot2 3.4.0.\n‚Ñπ Please use `linewidth` instead.\n‚Ñπ The deprecated feature was likely used in the EnhancedVolcano package.\n  Please report the issue to the authors.\n\n\nWarning: The `size` argument of `element_line()` is deprecated as of ggplot2 3.4.0.\n‚Ñπ Please use the `linewidth` argument instead.\n‚Ñπ The deprecated feature was likely used in the EnhancedVolcano package.\n  Please report the issue to the authors.\n\n\n\n\n\n\n\n\n\n\n Exercise: Interpret the volcano plot\nTODO\n\n\n Bonus Exercise: Improve the Volcano Plot\nThe EnhancedVolcano() function by default adds gene IDs to highly significant genes, but above, we turned off gene name labeling by setting labSize = 0. I did this because the default p-value cut-off for point labeling is 1e-5 and in this case, that would make the plot quite busy with gene labels. We might want to try a plot with a stricter p-value cut-off that does show the gene labels.\nPlay around with the p-value cut-off and the labeling to create a plot you like.\nCheck the vignette , or the help page (accessed by running ?EnhancedVolcano) to see how you can do this.\n\n\nClick for an example\n\n\nEnhancedVolcano(\n  toptable = res_rc1,      \n  title = \"relictum vs. control at 24 hpi\",\n  x = \"log2FoldChange\",     \n  y = \"padj\",             \n  lab = rownames(res_rc1), \n  labSize = 4,               # Now we will show the gene labels\n  pCutoff = 10e-10,          # Modify the p-value cut-off\n  subtitle = NULL,           # I'll also remove the silly subtitle\n  caption = NULL,            # ... and the caption\n  )\n\n\n\n\n\n\n\n\n\n\n\n Bonus Exercise: Which gene is my outlier?\nFigure out the identity of the abovementioned log2-fold change outlier.\n(You can do so either by labeling it in the plot, or by filtering the res_rc1 table.)\n\n\nClick for the solution on how to label it in the plot\n\n\n\nEnhancedVolcano(\n  toptable = res_rc1,      \n  title = \"relictum vs. control at 24 hpi\",\n  x = \"log2FoldChange\",     \n  y = \"padj\",             \n  lab = rownames(res_rc1), \n  labSize = 4,               \n  pCutoff = 0.05,            # Modify the p-value cut-off\n  FCcutoff = 20,             # Modify the LFC cut-off\n  )\n\nWarning: Removed 1 row containing missing values or values outside the scale range\n(`geom_vline()`).\n\n\n\n\n\n\n\n\n\n\n\n\nClick for the solution on how to find it in the results table\n\n\n\nas.data.frame(res_rc1) |&gt; filter(log2FoldChange &gt; 20)\n\n             baseMean log2FoldChange    lfcSE     stat       pvalue\nLOC120431476 39.72038       43.77762 5.301369 8.257795 1.483875e-16\n                     padj\nLOC120431476 3.434281e-13\n\n\n(Interestingly, there‚Äôs a second gene with a LFC &gt; 20 that we hadn‚Äôt seen in the plot, because it has NA as the pvalue and padj. See the section ‚ÄúExtra info: NA values in the results table‚Äù in the Appendix above for why p-values can be set to NA.)\n\n\n\n\n7.2 Plot specific genes\nIt can also be very informative to look at plots of expression levels for individual genes, especially for those with highly significant differential expression.\nLet‚Äôs plot the single most highly significant DEG. We can get the ID of this gene as follows:\n\n# Convert the results table into a regular dataframe and sort by adjusted p-value:\ntop_df &lt;- data.frame(res_rc1) |&gt; arrange(padj)\n\n# Gene IDs are the row names: extract the first row name to get the gene of interest\ntop1 &lt;- rownames(top_df)[1]\ntop1\n\n[1] \"LOC120423768\"\n\n\nLike it does for PCA, DESeq2 also has a gene plotting function. This will by default plot normalized gene counts.\n\nplotCounts(dds, gene = top1, intgroup = \"group\")\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nYou may have to drag the right-hand pane in RStudio way to the left in order to see all the x-axis labels‚Ä¶\n\n\n\nIn the above plot, we‚Äôre not just seeing the difference between relictum_24h and control_24h, but are seeing expression levels for all four treatment-time combinations. That may not always be what you want, but it is useful to see the expression patterns across all groups.\nHere, the pattern suggests ‚Ä¶ TODO\n\n Exercise: Plot additional DE genes\nPlot one or a few more of the top-DE genes. Do they have similar expression patterns across treatment and time points as the first one?\nTODO ADD SOLUTION\n\n\n Bonus exercise: Plot the outlier gene\nPlot the gene with the very high LFC value that you saw when making the volcano plot. How would you interpret this result?\n\n\nClick to get the ID of the outlier gene\n\nA previous bonus exercise showed you how to find the ID of the outlier gene. It is: LOC120431476.\n\n\n\nClick for the solution\n\n\nplotCounts(dds, gene = \"LOC120431476\", intgroup = \"group\")\n\n\n\n\n\n\n\n\nWow! It looks like in every single dpi + treatment combination, all but one (or in one case, two) of the samples have zero expression, but there are several extreme outliers.\nOur focal comparison is control_24h vs.¬†relictum_24h, and it looks like the difference between these two groups is solely due to the one outlier in relictum. Nevertheless, even the multiple-testing corrected p-value (padj) is significant for this gene:\n\nas.data.frame(res_rc1) |&gt;\n  rownames_to_column(\"gene\") |&gt;\n  filter(gene == \"LOC120431476\")\n\n          gene baseMean log2FoldChange    lfcSE     stat       pvalue\n1 LOC120431476 39.72038       43.77762 5.301369 8.257795 1.483875e-16\n          padj\n1 3.434281e-13\n\n\nSo, you have to be careful with talking these statistical results at face value, and need to visualize important genes!\n\n\n\n Bonus exercise: Make a better gene expression plot\nThe default plotCounts() function creates a rather basic plot. Customize the plot with ggplot2 to make it better-looking and clearer.\n\n\nSolution part 1: getting the dataframe\n\nBelow, you‚Äôll use that DESeq2 function, but only to extract the counts for our gene of interest in a format for plotting, by adding returnData = TRUE:\n\n# Use plotCounts with returnData = TRUE just to get a single-gene count table\n# that is suitable for plotting:\nfocal_gene_counts &lt;- plotCounts(\n  dds,\n  gene = top1,\n  intgroup = c(\"dpi\", \"treatment\"),\n  returnData = TRUE\n  )\n\n# Take a look at the resulting dataframe:\nhead(focal_gene_counts)\n\n                 count dpi   treatment\nERR10802863 1543.81532   1     control\nERR10802864 2279.03704   1 cathemerium\nERR10802865   25.42295   1    relictum\nERR10802866 1105.75009   1     control\nERR10802867 1199.28425   1 cathemerium\nERR10802868   32.14394   1    relictum\n\n\n\n\n\nSolution part 2: Making the plot\n\n\nfocal_gene_counts |&gt;\n  # Treatment along the x-axis, gene counts along the y, color by treatment:\n  ggplot(aes(x = treatment, y = count, fill = treatment)) +\n  # Plot separate \"facets\" with the different time points\n  facet_wrap(vars(dpi)) +\n  # Add a boxplot with a partly transparaent (alpha) color:\n  geom_boxplot(alpha = 0.5, outlier.shape = NA) +\n  # _And_ add individual points:\n  geom_point(\n    size = 4,\n    shape = 21,\n    position = position_jitter(width = 0.1, heigth = 0)\n    ) +\n  # Plot styling (e.g., we don't need a legend)\n  theme_bw() +\n  theme(legend.position = \"none\")"
  },
  {
    "objectID": "pages/DE.html#in-closing",
    "href": "pages/DE.html#in-closing",
    "title": "RNA-Seq differential expression analysis",
    "section": "8 In Closing",
    "text": "8 In Closing\nToday, you have performed several steps in the analysis of gene counts that result from a typical RNA-Seq workflow. Specifically, you have:\n\nCreated a DESEq2 object from the gene count data and the experiment‚Äôs metadata\nPerformed exploratory data analysis including a PCA\nRan a Differential Expression (DE) analysis with DESeq2\nExtracted, interpreted, and visualized the DE results\n\n\nWhat would be the next steps in such an analysis?\nTypical next steps in such an analysis include:\n\nExtracting, comparing, and synthesizing DE results across all pairwise comparisons (this would for example allow us to make the upset plot in Figure 2 of the paper)\nFunctional enrichment analysis with Gene Ontology (GO) terms, as done in the paper, and/or with KEGG pathways."
  },
  {
    "objectID": "pages/DE.html#appendix",
    "href": "pages/DE.html#appendix",
    "title": "RNA-Seq differential expression analysis",
    "section": "9 Appendix",
    "text": "9 Appendix\n\n9.1 Exporting the results\nYou may be wondering how you can save the DE results tables to files. You can do this with a writing counterpart to read_tsv() called, you guessed it, write_tsv(). This stores the table to a TSV text file, which can be opened in Excel.\n\n# Write the \nwrite_tsv(as.data.frame(res_rc1), \"DE-results_rc1.tsv\")\n\n\n\n9.2 Heatmaps\nRather than plotting expression levels for many individual genes, you can create ‚Äúheatmap‚Äù plots to plot dozens (possibly even hundreds) of genes at once.\nWe will create heatmaps with the pheatmap function, and let‚Äôs make a heatmap for the top-25 most highly significant DEGs for our focal contrast.\nFirst, let‚Äôs install and then load this package:\n\ninstall.packages(\"pheatmap\")\n\n\n# First load the pheatmap package:\nlibrary(pheatmap)\n\nUnlike with some of the functions we used before, we unfortunately can‚Äôt directly use our DESeq2 object, but we have to extract and subset the count matrix, and also pass the metadata to the heatmap function:\nTODO - FIX THE SAMPLE SORTING\n\n# You need a normalized count matrix, like for the PCA\n# You can simply extract the matrix from the normalized dds object we created for the PCA\nnorm_mat &lt;- assay(dds_vst)\n\n# In the normalized count matrix, select only the genes of interest\n# We'll create a vector with the top256 most significant DEGs\ntop25_DE &lt;- rownames(top_df)[1:25]\nnorm_mat_sel &lt;- norm_mat[match(top25_DE, rownames(norm_mat)), ]\n\n# Sort the metadata\nmeta_sort &lt;- meta |&gt;\n  arrange(treatment, dpi) |&gt;\n  select(treatment, dpi)\n\nNow you can create the plot:\n\npheatmap(\n  norm_mat_sel,\n  annotation_col = meta_sort,  # Add the metadata\n  cluster_cols = FALSE,        # Don't cluster samples (=columns, cols)\n  show_rownames = FALSE,       # Don't show gene names\n  scale = \"row\",               # Perform z-scaling for each gene\n  )\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nThe z-scaling with scale = will make sure we can compare genes with very different expression levels: after all, we‚Äôre interested in relative expression levels across samples/sample groups\npheatmap will by default perform hierarchical clustering both at the sample (col) and gene (row) level, such that more similar samples and genes will appear closer to each other. Above, we turned clustering off for samples to keep them in their groupwise order.\n\n\n\n\n\n Bonus Exercise\nMake a heatmap with the top-25 most-highly expressed genes (i.e., genes with the highest mean expression levels across all samples).\n\n\nClick for a hint: how to get that top-25\n\n\ntop25_hi &lt;- names(sort(rowMeans(norm_mat), decreasing = TRUE)[1:25])\n\n\n\n\nClick for the solution\n\n\n# In the normalized count matrix, select only the genes of interest\nnorm_mat_sel &lt;- norm_mat[match(top25_hi, rownames(norm_mat)), ]\n\n# Sort the metadata\nmeta_sort &lt;- meta |&gt;\n  arrange(treatment, dpi) |&gt;\n  select(treatment, dpi)\n\n# Create the heatmap\npheatmap(\n  norm_mat_sel,\n  annotation_col = meta_sort,\n  cluster_cols = FALSE,\n  show_rownames = FALSE,\n  scale = \"row\"\n  )"
  },
  {
    "objectID": "pages/DE.html#footnotes",
    "href": "pages/DE.html#footnotes",
    "title": "RNA-Seq differential expression analysis",
    "section": "Footnotes",
    "text": "Footnotes\n\n\nSpecifically, the point is to remove the correlation among genes between the mean expression level and the variance in expression.‚Ü©Ô∏é"
  }
]