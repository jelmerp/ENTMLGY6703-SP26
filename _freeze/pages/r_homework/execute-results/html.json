{
  "hash": "641ad97915a0b03679217945b12d6e63",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"R homework for the week 4 lab\"\ndate: 2026-01-29\nauthor:\n  - name: Jelmer Poelstra\n    orcid: 0000-0002-3514-7462\n    email: poelstra.1@osu.edu\n    affiliation: \n      - name: CFAES Bioinformatics Core, Ohio State University\n        url: https://mcic.osu.edu/bioinformatics\neditor_options: \n  chunk_output_type: console\n---\n\n\n\n\n-------\n\n<br>\n\n## Introduction\n\nThis homework is intended to get you familiar with R & RStudio.\nMost of the content is intended for those of you who have little to no experience with R,\nbut:\n\n- Everyone will need to install several R packages in RStudio at the\n  Ohio Supercomputer Center (OSC) -- section 8 of this page.\n  \n- If you have some familiarity with R already,\n  make sure to at least glance over all material to make sure you're familiar\n  with all of it.\n\nIf you run into any issues when going through this material,\nor have questions, don't hesitate to [email Jelmer](poelstra.1@osu.edu).\n\n### Learning objectives\n\nIn this session, you will learn:\n\n- The RStudio layout and the functions of the different panes and tabs\n- The basics of interacting with R by using R as a calculator\n- Defining a variables/objects in R, and assigning values/data to them\n- Calling functions\n- Getting help\n- Installing and loading R packages\n- Data structures like vectors and data frames\n- The basics of the tidyverse packages, including piping with `|>`\n\n## R and RStudio\n\n### Why use R?\n\nThe R language is probably the best environment for the \"downstream\" analysis^[\nI.e., after summarizing/processing data with command-line tools in the Unix shell]\nof genomics and other omics data.\n\nOn top of that, R is a great all-round tool for exploratory and statistical analysis\nand visualization of any kind of data.\nBecause it is free, open-source, cross-platform,\nand works with code rather than a graphical user interface (GUI),\nit is likely the best choice for reproducible data analysis all around.\n\n### R vs. RStudio\n\nTo run R, all you need is the R program.\nHowever, we will be running R inside a fancy editor\ncalled [RStudio](https://www.rstudio.com/products/rstudio),\nwhich makes working with R much more pleasant!\n\nSimilar to VS Code, you can run a version of RStudio within your\nbrowser by starting an Interactive App through OSC OnDemand.\n\n## Start an RStudio session at OSC\n\nWhile you can install and use R and RStudio on your own computer,\nfor this course, you will use RStudio at OSC:\n\n1. Log in to OSC’s OnDemand portal at <https://ondemand.osc.edu>\n2. In the blue top bar, select **`Interactive Apps`** at the bottom,\n   click **`RStudio Server`**\n3. Fill out the form as follows:\n   - Cluster: **`pitzer`**\n   - R version: **`4.4.0`**\n   - Project: **`PAS2880`**\n   - Number of hours: **`2`**\n   - Node type: **`any`**\n   - Number of cores: **`2`**\n4. Click **`Launch`**\n5. Click the **`Connect to RStudio Server`** button once it appears\n\n## Orienting to RStudio (basic layout)\n\nWhen you first open RStudio, you will be greeted by four panes,\neach of which have multiple tabs:\n\n- **Top left:** The editor/source pane, where you can open and edit documents like scripts\n  _(This may be missing if you don't have docemunts open -- if so, we'll make it appear later)_\n\n- **Bottom left:** the default and most useful tab in this pane is your R \n  \"Console\", where you can type and execute R code\n\n- **Top right:** the default and most useful tab in this pane this is your\n  \"Environment\",\n  which shows you what you have loaded in your R environment\n\n- **Bottom right:** the default tab in this pane is \"Files\",\n  which is a file explorer starting in your initial working directory\n  (more about that next).\n  The additional tabs are also commonly used, such as those to show plots and help.\n\n![](../img/R_studio_panes.png){width=\"90%\" fig-align=\"center\"}\n\n## R basics\n\n### R as calculator\n\nTo get some familiarity with working in R,\nyou will start by simply using R as calculator.\nType `5 + 5` in the console and press <kbd>Enter</kbd>:\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n5 + 5\n```\n\n::: {.cell-output .cell-output-stdout}\n\n``` regular-r-output\n[1] 10\n```\n\n\n:::\n:::\n\n\n\n\nR will print the result of the calculation, `10`.\nThe result is prefaced by `[1]`, which is simply an index/count of output items --\nthis can be helpful when many items are printed.\n\nA couple more examples:\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Multiplication\n6 * 8\n```\n\n::: {.cell-output .cell-output-stdout}\n\n``` regular-r-output\n[1] 48\n```\n\n\n:::\n\n```{.r .cell-code}\n# Division\n40 / 5\n```\n\n::: {.cell-output .cell-output-stdout}\n\n``` regular-r-output\n[1] 8\n```\n\n\n:::\n:::\n\n\n\n\n::: {.callout-tip appearance=\"simple\"}\nThis code will work with (like shown above) or without spaces between numbers\nand around operators like `+`.\nHowever, it is good practice to leave space between the number to\nimprove the readability of your code.\n:::\n\n### The R prompt\n\nThe `>` sign in your console is the R prompt,\nindicating that that R is ready for you to type something.\nIn other words, this is equivalent to the `$` Shell prompt you've seen in the week 3 lab.\n\nAlso just like in Unix shell, when you are not seeing the prompt,\nR is either **busy** (because you asked it to do a longer-running computation)\nor **waiting** for you to complete an incomplete command.\n\nIf you notice that your prompt turned into a `+`,\nyou typed an incomplete command -- for example:\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n10 /\n```\n:::\n\n\n\n```r-out\n+\n```\n\nYou can either try to finish the command or abort it by pressing\n<kbd>Ctrl</kbd>+<kbd>C</kbd> or <kbd>Esc</kbd> --\ngo ahead and practice the latter now to get your prompt back after the above command.\n\n::: callout-note\n#### Adding comments to your code\n\nComments in R are also just like in the Unix shell:\nyou can use `#` signs to comment your code, both inline and on separate lines:\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# This line is entirely ignored by R\n10 / 5  # This line contains code but everything after the '#' is ignored\n```\n\n::: {.cell-output .cell-output-stdout}\n\n``` regular-r-output\n[1] 2\n```\n\n\n:::\n:::\n\n\n\n\n:::\n\n### Comparing things\n\nIn R, you can use comparison operators to compare numbers.\nWhen you do this, R will return either `FALSE` or `TRUE`\n(the so-called `logical` data type). For example:\n\n- Greater than and less than:\n  \n\n\n\n  ::: {.cell}\n  \n  ```{.r .cell-code}\n  8 > 3\n  ```\n  \n  ::: {.cell-output .cell-output-stdout}\n  \n  ``` regular-r-output\n  [1] TRUE\n  ```\n  \n  \n  :::\n  \n  ```{.r .cell-code}\n  2 < 1\n  ```\n  \n  ::: {.cell-output .cell-output-stdout}\n  \n  ``` regular-r-output\n  [1] FALSE\n  ```\n  \n  \n  :::\n  :::\n\n\n\n\n- Equal to or not equal to --\n  note that you need to use **two** equals signs `==` for the former:\n\n\n\n\n  ::: {.cell}\n  \n  ```{.r .cell-code}\n  7 == 7\n  ```\n  \n  ::: {.cell-output .cell-output-stdout}\n  \n  ``` regular-r-output\n  [1] TRUE\n  ```\n  \n  \n  :::\n  \n  ```{.r .cell-code}\n  # The exclamation mark in general is a \"negator\"\n  10 != 5\n  ```\n  \n  ::: {.cell-output .cell-output-stdout}\n  \n  ``` regular-r-output\n  [1] TRUE\n  ```\n  \n  \n  :::\n  :::\n\n\n\n\n## Functions in R\n\nTo do almost anything in R, you will use \"**functions**\",\nwhich are the equivalent of Unix commands.\nR has over 3,000 functions that serve many different purposes.\n\n### Basics of functions\n\nYou can recognize function calls by the parentheses. For example:\n\n- The equivalent to the Shell's `pwd` is `getwd()` for \"get working dir\":\n\n\n\n\n  ::: {.cell}\n  \n  ```{.r .cell-code}\n  # You will see a different output depending on your working directory\n  getwd()\n  ```\n  :::\n\n\n\n  ```r-out\n  /users/PAS2880/jelmer\n  ```\n\n- Inside those parentheses, you can provide **arguments** to a function.\n  For example, using `setwd()`, the equivalent to the Shell's `cd`,\n  to set your working dir, the argument is the file path to set as working dir:\n\n\n\n\n  ::: {.cell}\n  \n  ```{.r .cell-code}\n  setwd(\"/fs/scratch/PAS2880/ENT6703\")\n  ```\n  :::\n\n\n\n  \n  ::: {.callout-warning appearance=\"simple\"}\n  Note that unlike in the Shell, you need to *quote (`\"..\"`) the file path*!\n  This is because in R,\n  anything non-numeric that is not quoted is supposed to be a pre-existing\n  \"object\" -- more on those in a bit.\n  :::\n\n### Function arguments\n\nConsider the example below,\nwhere you pass the argument `6.53` to the function `round()`:\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nround(6.53)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n``` regular-r-output\n[1] 7\n```\n\n\n:::\n:::\n\n\n\n\nIn most functions, including `round()`, arguments have **names** that can be used.\nFor example, the argument to `round()` represents the number to be rounded has\nthe name `x`, so you can also use:\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nround(x = 6.53)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n``` regular-r-output\n[1] 7\n```\n\n\n:::\n:::\n\n\n\n\nNaming arguments is helpful in particular to avoid confusion when you pass\nmultiple arguments to a function.\nFor example, `round()` accepts a second argument,\nwhich is the number of digits to round to:\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nround(x = 6.53, digits = 1)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n``` regular-r-output\n[1] 6.5\n```\n\n\n:::\n:::\n\n\n\n\nYou could choose not to name these arguments,\nbut that is not as easy to understand.\n\n::: {.callout-note appearance=\"simple\"}\nYou can usually see which arguments a function takes by pausing after your\ntype the function and its parenthesis, e.g. `round()`:\n\n![](../img/round_1.png){width=\"75%\" fig-align=\"center\"}\n\nBelow, you'll also learn about ways to get more extensive help information about a function.\n:::\n\n## R Help: `help()` and `?`\n\nThe `help()` function and `?` help operator in R offer access to documentation pages\nfor R functions, data sets, and other objects.\nThey provide access to both packages in the standard R distribution and contributed packages.\n\nFor example:\n\n```r\n?getwd\n```\n\nThe output should appear in the Help tab of the bottom-left panel in RStudio\nand should look something like this:\n\n![](../img/R_help_setwd){width=\"65%\" fig-align=\"center\"}\n\n## R packages\n\nR packages are basically add-ons or extensions to the functionality of the R language.\n\n- The function `install.packages()` **installs** an R package.\n  This is a one-time operation -- you won't need to reinstall a package\n  when you start a new R session later.\n  \n- The function `library()` will **load** an R package in your current R session.\n  Every time you want to use a package in R, you need to load it,\n  just like everytime you want to use MS Word on your computer, you need to open it.\n\nTo practice with this,\nyou will now install several packages you'll need in next week's lab.\nNote that:\n\n- Unfortunately, on OSC, packages installation can take a while, especially for\n  large packages like these, so please be patient^[\n  This should be _much_ faster on your own computer.].\n\n- A lot of messages may be printed to the console when installation is ongoing.\n  Installation of a package is done when you get your prompt back.\n  Unless you see clear messages that include words like \"Error\" and \"Failed\",\n  it should have succeeded.\n  \n- Besides `install.packages()`, you'll also use the `BiocManager::install()` function\n  from to install some packages from Bioconductor,\n  which hosts many bioinformatics/omics-related R packages.\n  \n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Run these lines one-by-one to install the needed packages:\ninstall.packages(\"tidyverse\")\ninstall.packages(\"BiocManager\")\nBiocManager::install(\"DESeq2\")\nBiocManager::install(\"EnhancedVolcano\")\n```\n:::\n\n\n\n\nTest that you can load the packages -- see the expected output below: \n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(EnhancedVolcano)\n```\n\n::: {.cell-output .cell-output-stderr}\n\n``` regular-r-output\nLoading required package: ggplot2\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n``` regular-r-output\nLoading required package: ggrepel\n```\n\n\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(DESeq2)\n```\n:::\n\n\n\n\n<details><summary>*Click here to see the expected output when loading the 'DESeq2' package*</summary>\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(DESeq2)\n```\n\n::: {.cell-output .cell-output-stderr}\n\n``` regular-r-output\nLoading required package: S4Vectors\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n``` regular-r-output\nLoading required package: stats4\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n``` regular-r-output\nLoading required package: BiocGenerics\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n``` regular-r-output\nLoading required package: generics\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n``` regular-r-output\n\nAttaching package: 'generics'\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n``` regular-r-output\nThe following objects are masked from 'package:base':\n\n    as.difftime, as.factor, as.ordered, intersect, is.element, setdiff,\n    setequal, union\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n``` regular-r-output\n\nAttaching package: 'BiocGenerics'\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n``` regular-r-output\nThe following objects are masked from 'package:stats':\n\n    IQR, mad, sd, var, xtabs\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n``` regular-r-output\nThe following objects are masked from 'package:base':\n\n    anyDuplicated, aperm, append, as.data.frame, basename, cbind,\n    colnames, dirname, do.call, duplicated, eval, evalq, Filter, Find,\n    get, grep, grepl, is.unsorted, lapply, Map, mapply, match, mget,\n    order, paste, pmax, pmax.int, pmin, pmin.int, Position, rank,\n    rbind, Reduce, rownames, sapply, saveRDS, table, tapply, unique,\n    unsplit, which.max, which.min\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n``` regular-r-output\n\nAttaching package: 'S4Vectors'\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n``` regular-r-output\nThe following object is masked from 'package:utils':\n\n    findMatches\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n``` regular-r-output\nThe following objects are masked from 'package:base':\n\n    expand.grid, I, unname\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n``` regular-r-output\nLoading required package: IRanges\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n``` regular-r-output\nLoading required package: GenomicRanges\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n``` regular-r-output\nLoading required package: GenomeInfoDb\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n``` regular-r-output\nLoading required package: SummarizedExperiment\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n``` regular-r-output\nLoading required package: MatrixGenerics\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n``` regular-r-output\nLoading required package: matrixStats\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n``` regular-r-output\n\nAttaching package: 'MatrixGenerics'\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n``` regular-r-output\nThe following objects are masked from 'package:matrixStats':\n\n    colAlls, colAnyNAs, colAnys, colAvgsPerRowSet, colCollapse,\n    colCounts, colCummaxs, colCummins, colCumprods, colCumsums,\n    colDiffs, colIQRDiffs, colIQRs, colLogSumExps, colMadDiffs,\n    colMads, colMaxs, colMeans2, colMedians, colMins, colOrderStats,\n    colProds, colQuantiles, colRanges, colRanks, colSdDiffs, colSds,\n    colSums2, colTabulates, colVarDiffs, colVars, colWeightedMads,\n    colWeightedMeans, colWeightedMedians, colWeightedSds,\n    colWeightedVars, rowAlls, rowAnyNAs, rowAnys, rowAvgsPerColSet,\n    rowCollapse, rowCounts, rowCummaxs, rowCummins, rowCumprods,\n    rowCumsums, rowDiffs, rowIQRDiffs, rowIQRs, rowLogSumExps,\n    rowMadDiffs, rowMads, rowMaxs, rowMeans2, rowMedians, rowMins,\n    rowOrderStats, rowProds, rowQuantiles, rowRanges, rowRanks,\n    rowSdDiffs, rowSds, rowSums2, rowTabulates, rowVarDiffs, rowVars,\n    rowWeightedMads, rowWeightedMeans, rowWeightedMedians,\n    rowWeightedSds, rowWeightedVars\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n``` regular-r-output\nLoading required package: Biobase\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n``` regular-r-output\nWelcome to Bioconductor\n\n    Vignettes contain introductory material; view with\n    'browseVignettes()'. To cite Bioconductor, see\n    'citation(\"Biobase\")', and for packages 'citation(\"pkgname\")'.\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n``` regular-r-output\n\nAttaching package: 'Biobase'\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n``` regular-r-output\nThe following object is masked from 'package:MatrixGenerics':\n\n    rowMedians\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n``` regular-r-output\nThe following objects are masked from 'package:matrixStats':\n\n    anyMissing, rowMedians\n```\n\n\n:::\n:::\n\n\n\n</details>\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(tidyverse)\n```\n\n::: {.cell-output .cell-output-stderr}\n\n``` regular-r-output\n── Attaching core tidyverse packages ──────────────────────── tidyverse 2.0.0 ──\n✔ dplyr     1.1.4     ✔ readr     2.1.5\n✔ forcats   1.0.1     ✔ stringr   1.5.2\n✔ lubridate 1.9.4     ✔ tibble    3.3.0\n✔ purrr     1.1.0     ✔ tidyr     1.3.1\n── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──\n✖ lubridate::%within%()    masks IRanges::%within%()\n✖ dplyr::collapse()        masks IRanges::collapse()\n✖ dplyr::combine()         masks Biobase::combine(), BiocGenerics::combine()\n✖ dplyr::count()           masks matrixStats::count()\n✖ dplyr::desc()            masks IRanges::desc()\n✖ tidyr::expand()          masks S4Vectors::expand()\n✖ dplyr::filter()          masks stats::filter()\n✖ dplyr::first()           masks S4Vectors::first()\n✖ dplyr::lag()             masks stats::lag()\n✖ BiocGenerics::Position() masks ggplot2::Position(), base::Position()\n✖ purrr::reduce()          masks GenomicRanges::reduce(), IRanges::reduce()\n✖ dplyr::rename()          masks S4Vectors::rename()\n✖ lubridate::second()      masks S4Vectors::second()\n✖ lubridate::second<-()    masks S4Vectors::second<-()\n✖ dplyr::slice()           masks IRanges::slice()\nℹ Use the conflicted package (<http://conflicted.r-lib.org/>) to force all conflicts to become errors\n```\n\n\n:::\n:::\n\n\n\n\n::: {.callout-note appearance=\"simple\"} \nDon't worry about the \"conflict\" warnings shown above.\n::::\n\n## R scripts\n\nMoving forward, you will mostly write and save your R code in so-called \"R scripts\",\nwhich are text files that contain R code.\n\nIt's a good idea to write and save most of your (important) code in scripts,\nto help *keep track of what you've been doing* and make it easier to modify and\nrerun things.\n\n1. Create and open a new R script by clicking\n   **`File`** (top menu bar) \\> **`New File`** \\> **`R Script`**.\n\n2. Save this new script right away by clicking **`File`** \\> **`Save As`**.\n   In the dialog box,\n   you can save it right in the suggested folder, \n   or you can make a new folder for this course.\n   Regardless, save the script as **`homework.R`**\n   (the extension for R scripts is `.R`).\n   \nTo send code from the script in the editor to the console,\nwhere it will be executed by R,\npress <kbd>Ctrl</kbd> + <kbd>Enter</kbd> on Windows,\nor <kbd>Cmd</kbd> + <kbd>Return</kbd> on a Mac.\nPractice that after typing the following in the script:\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Type this in the script, then run it with Ctrl + Enter (or Cmd + Return)\n5 + 5\n```\n\n::: {.cell-output .cell-output-stdout}\n\n``` regular-r-output\n[1] 10\n```\n\n\n:::\n:::\n\n\n\n\n## R objects\n\n### Assigning stuff to objects\n\nYou can assign one or more values to a so-called \"object\"\nwith the **assignment operator** `<-`.\nA few examples:\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Assign the value 250 the object 'length_cm'\nlength_cm <- 250\nlength_cm\n```\n\n::: {.cell-output .cell-output-stdout}\n\n``` regular-r-output\n[1] 250\n```\n\n\n:::\n\n```{.r .cell-code}\n# Assign the value 2.54 to the object 'conversion'\nconversion <- 2.54\nconversion\n```\n\n::: {.cell-output .cell-output-stdout}\n\n``` regular-r-output\n[1] 2.54\n```\n\n\n:::\n:::\n\n\n\n\nImportantly, you can use objects as if you had typed their values directly:\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlength_cm / conversion\n```\n\n::: {.cell-output .cell-output-stdout}\n\n``` regular-r-output\n[1] 98.4252\n```\n\n\n:::\n:::\n\n\n\n\n### Object names\n\nSome pointers on object names:\n\n- Because R is case sensitive, `length_inch` is different from `Length_Inch`!\n- An object name cannot contain spaces — so for readability, you can for example\n  separate words using underscores, as in `length_cm`.\n- Object names can contain but cannot start with a number:\n  `x2` is valid but `2x` is not.\n- Make object names descriptive yet not too long — this is not always easy!\n\n::: exercise\n#### {{< fa user-edit >}} Exercise: Assigning objects in R\n\n1. Assign the value 20 to the object `num_1`, and the value 15 to `num_2`\n\n   <details><summary>*Click to see the solution*</summary>\n     \n\n\n\n   ::: {.cell}\n   \n   ```{.r .cell-code}\n   num_1 <- 20\n   num_2 <- 15\n   ```\n   :::\n\n\n\n   </details>\n  \n2. Compute the sum of `num_1` and `num_2`\n\n   <details><summary>*Click to see the solution*</summary>\n     \n\n\n\n   ::: {.cell}\n   \n   ```{.r .cell-code}\n   num_1 + num_2\n   ```\n   \n   ::: {.cell-output .cell-output-stdout}\n   \n   ``` regular-r-output\n   [1] 35\n   ```\n   \n   \n   :::\n   :::\n\n\n\n   </details>\n  \n3. Assign the result of `num_1` minus `num_2` to a new object called `difference`.\n   What is the value of `difference`?\n\n   <details><summary>*Click to see a solution*</summary>\n     \n\n\n\n   ::: {.cell}\n   \n   ```{.r .cell-code}\n   difference <- num_1 - num_2\n   difference\n   ```\n   \n   ::: {.cell-output .cell-output-stdout}\n   \n   ``` regular-r-output\n   [1] 5\n   ```\n   \n   \n   :::\n   :::\n\n\n\n   </details>\n  \n4. Which of the following are valid object names in R?\n\n   a) `2nd_value`  \n   b) `value_2`  \n   c) `total value  `\n   d) `TotalValue`  \n\n   <details><summary>*Click to see a solution*</summary>\n     \n   The valid object names are:  \n   \n   b) `value_2`\n   d) `TotalValue ` \n   \n   Object names cannot start with a number and cannot contain spaces\n   (so a and c options are invalid).\n   \n  </details>\n:::\n\n## Vectors\n\nR has several so-called \"data structures\",\nwhich are different types of objects to store different types of data.\nVectors are the most basic data structure in R, and are\n**collections of one or more items**.\n\n### Creating vectors\n\nYou've already created a few vectors, as the single-item `num_1` etc. objects above\nwere vectors!\nBut let's see somethin new:\na common way to make vectors with **multiple elements** is with the\n`c` (combine) function:\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# longer_vector will contain 3 items:\nlonger_vector <- c(10, 20, 30)\nlonger_vector\n```\n\n::: {.cell-output .cell-output-stdout}\n\n``` regular-r-output\n[1] 10 20 30\n```\n\n\n:::\n:::\n\n\n\n\nFor ranges of integers (whole numbers), you can also use the colon operator `:`:\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# longer_vector will contain 10 items:\nsequence_vector <- 1:10\nsequence_vector\n```\n\n::: {.cell-output .cell-output-stdout}\n\n``` regular-r-output\n [1]  1  2  3  4  5  6  7  8  9 10\n```\n\n\n:::\n:::\n\n\n\n\n### Exploring vectors\n\nR has many functions that provide information about vectors and other\ntypes of objects, such as to get the number of items, or the mean or sum\nof the values of these items^[The latter two only with numeric vectors - as vectors\ncan also contain text.]:\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Get the number of items:\nlength(longer_vector)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n``` regular-r-output\n[1] 3\n```\n\n\n:::\n\n```{.r .cell-code}\n# Get the the mean (average) across all elements:\nmean(longer_vector)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n``` regular-r-output\n[1] 20\n```\n\n\n:::\n\n```{.r .cell-code}\n# Get the sum of all elements:\nsum(longer_vector)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n``` regular-r-output\n[1] 60\n```\n\n\n:::\n:::\n\n\n\n\n### Extracting elements from vectors\n\nYou can extract items from objects like vectors using \"bracket notation\" --\nget the second item with `[2]`:\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlonger_vector[2]\n```\n\n::: {.cell-output .cell-output-stdout}\n\n``` regular-r-output\n[1] 20\n```\n\n\n:::\n:::\n\n\n\n\nOr get the first and third items with `[c(1, 3)]`:\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlonger_vector[c(1, 3)]\n```\n\n::: {.cell-output .cell-output-stdout}\n\n``` regular-r-output\n[1] 10 30\n```\n\n\n:::\n:::\n\n\n\n\n## Data frames\n\nData frames are a key R data structure that contain **tabular data** --\ndata organized in rows and columns, similar to spreadsheets.\n\nAn example is the `iris` data frame, which is an dataset that comes shipped with R.\nYou can take a look at the first few rows of this data frame\nusing the `head()` function:\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nhead(iris)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n``` regular-r-output\n  Sepal.Length Sepal.Width Petal.Length Petal.Width Species\n1          5.1         3.5          1.4         0.2  setosa\n2          4.9         3.0          1.4         0.2  setosa\n3          4.7         3.2          1.3         0.2  setosa\n4          4.6         3.1          1.5         0.2  setosa\n5          5.0         3.6          1.4         0.2  setosa\n6          5.4         3.9          1.7         0.4  setosa\n```\n\n\n:::\n:::\n\n\n\n\nFor data frames, the `View()` function is also quite neat,\nas it will open the data frame in a spreadsheet-like viewer -- try it!:\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nView(iris)\n```\n:::\n\n\n\n\nYou can extract individual columns from a data frame using the `$` operator:\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\niris$Sepal.Width\n```\n\n::: {.cell-output .cell-output-stdout}\n\n``` regular-r-output\n  [1] 3.5 3.0 3.2 3.1 3.6 3.9 3.4 3.4 2.9 3.1 3.7 3.4 3.0 3.0 4.0 4.4 3.9 3.5\n [19] 3.8 3.8 3.4 3.7 3.6 3.3 3.4 3.0 3.4 3.5 3.4 3.2 3.1 3.4 4.1 4.2 3.1 3.2\n [37] 3.5 3.6 3.0 3.4 3.5 2.3 3.2 3.5 3.8 3.0 3.8 3.2 3.7 3.3 3.2 3.2 3.1 2.3\n [55] 2.8 2.8 3.3 2.4 2.9 2.7 2.0 3.0 2.2 2.9 2.9 3.1 3.0 2.7 2.2 2.5 3.2 2.8\n [73] 2.5 2.8 2.9 3.0 2.8 3.0 2.9 2.6 2.4 2.4 2.7 2.7 3.0 3.4 3.1 2.3 3.0 2.5\n [91] 2.6 3.0 2.6 2.3 2.7 3.0 2.9 2.9 2.5 2.8 3.3 2.7 3.0 2.9 3.0 3.0 2.5 2.9\n[109] 2.5 3.6 3.2 2.7 3.0 2.5 2.8 3.2 3.0 3.8 2.6 2.2 3.2 2.8 2.8 2.7 3.3 3.2\n[127] 2.8 3.0 2.8 3.0 2.8 3.8 2.8 2.8 2.6 3.0 3.4 3.1 3.0 3.1 3.1 3.1 2.7 3.2\n[145] 3.3 3.0 2.5 3.0 3.4 3.0\n```\n\n\n:::\n:::\n\n\n\n\nThis kind of operation will return a vector -- which can be subsetted as well:\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\niris$Sepal.Width[2:5]\n```\n\n::: {.cell-output .cell-output-stdout}\n\n``` regular-r-output\n[1] 3.0 3.2 3.1 3.6\n```\n\n\n:::\n:::\n\n\n\n\n## A brief intro to the tidyverse and pipes\n\nFinally, you'll learn a little about a versatily family of R packages designed for\ndata science called the [\"tidyverse\"](https://www.tidyverse.org).\nThe tidyverse is quite large and includes the famous _ggplot2_ package to create\nall sorts of data visualizations --\nwe'll barely scratch the surface here but this should already give you some useful tools.\n\n### `read_tsv()` to read tabular data\n\nThe `read_tsv()` function reads a TSV (Tab-Separated Values) file into a\ndataframe, taking the path to the file as its main argument --\nhere, read the sample metadata file used in next week's lab:\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nmeta <- read_tsv(\"/fs/scratch/PAS2880/ENT6703/data/meta/metadata.tsv\")\n```\n:::\n\n::: {.cell}\n::: {.cell-output .cell-output-stderr}\n\n``` regular-r-output\nRows: 22 Columns: 3\n── Column specification ────────────────────────────────────────────────────────\nDelimiter: \"\\t\"\nchr (3): sample_id, time, treatment\n\nℹ Use `spec()` to retrieve the full column specification for this data.\nℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.\n```\n\n\n:::\n:::\n\n\n\n\nTake a look at the resulting data frame `meta`:\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nmeta\n```\n\n::: {.cell-output .cell-output-stdout}\n\n``` regular-r-output\n# A tibble: 22 × 3\n   sample_id   time  treatment  \n   <chr>       <chr> <chr>      \n 1 ERR10802882 10d   cathemerium\n 2 ERR10802875 10d   cathemerium\n 3 ERR10802879 10d   cathemerium\n 4 ERR10802883 10d   cathemerium\n 5 ERR10802878 10d   control    \n 6 ERR10802884 10d   control    \n 7 ERR10802877 10d   control    \n 8 ERR10802881 10d   control    \n 9 ERR10802876 10d   relictum   \n10 ERR10802880 10d   relictum   \n# ℹ 12 more rows\n```\n\n\n:::\n:::\n\n\n\n\n::: callout-tip\n#### Tibble??\nThe output above is a so-called \"tibble\", as the top of the output above mentions.\nThis is a modern take on data frames provided by the tidyverse.\nTibbles behave mostly like data frames,\nbut have some nice features mostly in the way they are printed to screen.\n:::\n\n### `select()` to pick columns\n\n`select()` subsets a data frame by including/excluding certain columns.\nBy default, it only includes the columns you specify:\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nselect(.data = meta, sample_id, treatment)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n``` regular-r-output\n# A tibble: 22 × 2\n   sample_id   treatment  \n   <chr>       <chr>      \n 1 ERR10802882 cathemerium\n 2 ERR10802875 cathemerium\n 3 ERR10802879 cathemerium\n 4 ERR10802883 cathemerium\n 5 ERR10802878 control    \n 6 ERR10802884 control    \n 7 ERR10802877 control    \n 8 ERR10802881 control    \n 9 ERR10802876 relictum   \n10 ERR10802880 relictum   \n# ℹ 12 more rows\n```\n\n\n:::\n:::\n\n\n\n\nAbove, the first argument was the data frame,\nwhereas the other arguments were the (unquoted!) names of columns to be kept.\n\nThe output is a new, modified dataframe (same for the following functions),\nwhich in the example above, you simply printed to the screen --\nbut as you'll see later, you can store the output too.\n\n### `filter()` to pick rows (observations)\n\nThe `filter()` function outputs only those rows that satisfy one or more conditions.\nIt is similar to Filter functionality in Excel.\nFor example, to only keep rows for the `10d` timepoint:\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nfilter(.data = meta, time == \"10d\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n``` regular-r-output\n# A tibble: 12 × 3\n   sample_id   time  treatment  \n   <chr>       <chr> <chr>      \n 1 ERR10802882 10d   cathemerium\n 2 ERR10802875 10d   cathemerium\n 3 ERR10802879 10d   cathemerium\n 4 ERR10802883 10d   cathemerium\n 5 ERR10802878 10d   control    \n 6 ERR10802884 10d   control    \n 7 ERR10802877 10d   control    \n 8 ERR10802881 10d   control    \n 9 ERR10802876 10d   relictum   \n10 ERR10802880 10d   relictum   \n11 ERR10802885 10d   relictum   \n12 ERR10802886 10d   relictum   \n```\n\n\n:::\n:::\n\n\n\n\n### The pipe (`|>`)\n\nIt's common to want to use several consecutive functions to wrangle a dataframe\ninto the format you want.\nFor example, you may want to first `select()` one or more columns,\nthen `filter()` the resulting dataframe.\nYou could do that as follows:\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nmeta_sel <- select(.data = meta, sample_id, time)\nfilter(.data = meta_sel, time == \"10d\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n``` regular-r-output\n# A tibble: 12 × 2\n   sample_id   time \n   <chr>       <chr>\n 1 ERR10802882 10d  \n 2 ERR10802875 10d  \n 3 ERR10802879 10d  \n 4 ERR10802883 10d  \n 5 ERR10802878 10d  \n 6 ERR10802884 10d  \n 7 ERR10802877 10d  \n 8 ERR10802881 10d  \n 9 ERR10802876 10d  \n10 ERR10802880 10d  \n11 ERR10802885 10d  \n12 ERR10802886 10d  \n```\n\n\n:::\n:::\n\n\n\n\nYou could go on along these lines,\nsuccessively creating new objects that you then use for the next step.\nBut there is a more elegant way of dong this,\ndirectly sending (\"piping\") output from one function into the next function\nwith the **pipe operator** `|>`\n(a vertical bar <kbd>|</kbd> followed by a greater-than sign <kbd>></kbd>).\n\nLet's start by seeing a reformulation of the code above with pipes:\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nmeta |>\n  select(sample_id, time) |>\n  filter(time == \"10d\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n``` regular-r-output\n# A tibble: 12 × 2\n   sample_id   time \n   <chr>       <chr>\n 1 ERR10802882 10d  \n 2 ERR10802875 10d  \n 3 ERR10802879 10d  \n 4 ERR10802883 10d  \n 5 ERR10802878 10d  \n 6 ERR10802884 10d  \n 7 ERR10802877 10d  \n 8 ERR10802881 10d  \n 9 ERR10802876 10d  \n10 ERR10802880 10d  \n11 ERR10802885 10d  \n12 ERR10802886 10d  \n```\n\n\n:::\n:::\n\n\n\n\nWhat happened here? You took the `meta` data frame,\nsent (\"piped\") it into the `select()` function,\nwhose output in turn was piped into the `filter()` function.\n\nYou can think of the pipe as **\"then\"**:\ntake `meta`, _then_ select, _then_ rename.\n\nWhen using the pipe,\nyou no longer specify the input with the `.data` argument,\nbecause the function now gets its input data via the pipe.\nUsing pipes involves less typing and is more readable than successive assignments.\n\n::: {.callout-tip appearance='simple'}\nFor code readability, \nit is good practice to start a new line after a pipe `|>`,\nand to keep the subsequent line(s) _indented_ as RStudio will automatically do.\n:::\n\n::: {.callout-note collapse=\"true\"}\n### Optional: Using the pipe keyboard shortcut _(Click to expand)_\n\nThe following RStudio keyboard shortcut will insert a pipe symbol:\n<kbd>Ctrl/Cmd</kbd> + <kbd>Shift</kbd> + <kbd>M</kbd>.\n\nHowever, by default this (still) inserts an older pipe symbol, `%>%`.\nTo make RStudio insert the `|>` pipe symbol with this keyboard shortcut:\n\n1. Click `Tools` > `Global Options` > `Code` tab on the right\n2. Check the box \"Use native pipe operator\" as shown below\n3. Click `OK` at the bottom of the options dialog box to apply the change and\n   close the box.  \n\n![](../img/pipe-shortcut.png){fig-align=\"center\"}\n:::\n\n::: exercise\n#### {{< fa user-edit >}} Exercise: Tidyverse functions and pipes\n\nUse a \"pipeline\" like above to output a data frame with two\ncolumns (`sample_id` and `treatment`) only for the _cathemerium_ treatment.\nHow many rows does your output data frame have?\n\n<details><summary>Click for the solution</summary>\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nmeta |>\n  select(sample_id, treatment) |>\n  filter(treatment == \"cathemerium\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n``` regular-r-output\n# A tibble: 7 × 2\n  sample_id   treatment  \n  <chr>       <chr>      \n1 ERR10802882 cathemerium\n2 ERR10802875 cathemerium\n3 ERR10802879 cathemerium\n4 ERR10802883 cathemerium\n5 ERR10802864 cathemerium\n6 ERR10802867 cathemerium\n7 ERR10802870 cathemerium\n```\n\n\n:::\n:::\n\n\n\n\nThe output data frame has 7 rows and 2 columns:\nnote that \"7 x 2\" is helpfully shown at the top of the output in the console.\n\n</details>\n:::\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}